2024-09-15 00:30:04,443 - logger name:log/AIR/trafficstream-42/trafficstream.log
2024-09-15 00:30:04,444 - params : {'conf': 'new_conf/AIR/trafficstream.json', 'seed': 42, 'paral': 0, 'gpuid': 1, 'logname': 'trafficstream', 'method': 'TrafficStream', 'load_first_year': 0, 'first_year_model_path': 'log/PEMS/trafficstream-42/2011/16.6936.pkl', 'device': device(type='cuda', index=1), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>}, 'begin_year': 2016, 'end_year': 2019, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'raw_data_path': 'data/AIR/RawData/', 'save_data_path': 'data/AIR/FastData/', 'graph_path': 'data/AIR/graph/', 'model_path': 'log/AIR/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'init': True, 'train': 1, 'auto_test': 0, 'strategy': 'incremental', 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'inforeplay', 'path': 'log/AIR/trafficstream-42', 'logger': <Logger utils.initialize (INFO)>}
2024-09-15 00:30:04,465 - [*] Year 2016 load from data/AIR/FastData/2016.npz
2024-09-15 00:30:05,668 - [*] Year 2016 Dataset load!
2024-09-15 00:30:05,670 - [*] Year 2016 Training start
2024-09-15 00:30:06,816 - node number torch.Size([139136, 12])
2024-09-15 00:30:11,028 - epoch:0, training loss:4511.8111 validation loss:24.4753
2024-09-15 00:30:15,626 - epoch:1, training loss:1656.5558 validation loss:22.6413
2024-09-15 00:30:19,929 - epoch:2, training loss:1397.7803 validation loss:22.5260
2024-09-15 00:30:24,359 - epoch:3, training loss:1316.8503 validation loss:21.8119
2024-09-15 00:30:28,729 - epoch:4, training loss:1293.0586 validation loss:23.4629
2024-09-15 00:30:33,149 - epoch:5, training loss:1292.9157 validation loss:21.6243
2024-09-15 00:30:37,589 - epoch:6, training loss:1304.0941 validation loss:20.6702
2024-09-15 00:30:41,772 - epoch:7, training loss:1356.9946 validation loss:22.5975
2024-09-15 00:30:46,031 - epoch:8, training loss:1272.2851 validation loss:22.1155
2024-09-15 00:30:50,376 - epoch:9, training loss:1294.8657 validation loss:20.2579
2024-09-15 00:30:55,031 - epoch:10, training loss:1267.9357 validation loss:22.0811
2024-09-15 00:30:59,200 - epoch:11, training loss:1250.8469 validation loss:21.7947
2024-09-15 00:31:03,510 - epoch:12, training loss:1298.2026 validation loss:19.4853
2024-09-15 00:31:07,503 - epoch:13, training loss:1276.0023 validation loss:21.0637
2024-09-15 00:31:11,749 - epoch:14, training loss:1240.0744 validation loss:21.3440
2024-09-15 00:31:16,162 - epoch:15, training loss:1239.1595 validation loss:20.9345
2024-09-15 00:31:20,540 - epoch:16, training loss:1233.6169 validation loss:21.2138
2024-09-15 00:31:24,704 - epoch:17, training loss:1298.6987 validation loss:21.8104
2024-09-15 00:31:28,566 - epoch:18, training loss:1248.0248 validation loss:22.5477
2024-09-15 00:31:29,557 - [*] loss:2363.8047
2024-09-15 00:31:29,590 - [*] year 2016, testing
2024-09-15 00:31:29,999 - T:3	MAE	23.8795	RMSE	38.8519	MAPE	27.7777
2024-09-15 00:31:30,770 - T:6	MAE	26.8526	RMSE	43.5895	MAPE	31.3957
2024-09-15 00:31:33,097 - T:12	MAE	30.4127	RMSE	48.9815	MAPE	35.5672
2024-09-15 00:31:33,097 - T:Avg	MAE	26.7106	RMSE	43.2630	MAPE	31.1610
2024-09-15 00:31:33,098 - Finished optimization, total time:62.56 s, best model:log/AIR/trafficstream-42/2016/19.4853.pkl
2024-09-15 00:31:33,129 - [*] Year 2017 load from data/AIR/FastData/2017.npz
2024-09-15 00:31:33,143 - [*] load from log/AIR/trafficstream-42/2016/19.4853.pkl
2024-09-15 00:31:37,855 - number of increase nodes:165, nodes after 2 hop:torch.Size([415]), total nodes this year 1154
2024-09-15 00:31:39,145 - [*] Year 2017 Dataset load!
2024-09-15 00:31:39,145 - [*] load from log/AIR/trafficstream-42/2016/19.4853.pkl
2024-09-15 00:31:39,164 - [*] EWC! lambda 0.000100
2024-09-15 00:31:42,975 - [*] Year 2017 Training start
2024-09-15 00:31:43,949 - node number torch.Size([53120, 12])
2024-09-15 00:31:46,736 - epoch:0, training loss:1094.4976 validation loss:22.8851
2024-09-15 00:31:49,983 - epoch:1, training loss:1078.4724 validation loss:24.7943
2024-09-15 00:31:53,215 - epoch:2, training loss:1063.8264 validation loss:24.0633
2024-09-15 00:31:56,199 - epoch:3, training loss:1072.6977 validation loss:25.9682
2024-09-15 00:31:59,403 - epoch:4, training loss:1064.9615 validation loss:25.7863
2024-09-15 00:32:02,403 - epoch:5, training loss:1066.7733 validation loss:23.9035
2024-09-15 00:32:05,731 - epoch:6, training loss:1055.3417 validation loss:23.2446
2024-09-15 00:32:06,950 - [*] loss:1597.9008
2024-09-15 00:32:06,993 - [*] year 2017, testing
2024-09-15 00:32:07,380 - T:3	MAE	19.2076	RMSE	28.7573	MAPE	22.1495
2024-09-15 00:32:08,178 - T:6	MAE	22.6680	RMSE	34.4866	MAPE	26.1568
2024-09-15 00:32:10,517 - T:12	MAE	26.4611	RMSE	40.2895	MAPE	30.7952
2024-09-15 00:32:10,518 - T:Avg	MAE	22.3951	RMSE	33.8401	MAPE	25.9235
2024-09-15 00:32:10,520 - Finished optimization, total time:15.26 s, best model:log/AIR/trafficstream-42/2017/22.8851.pkl
2024-09-15 00:32:10,552 - [*] Year 2018 load from data/AIR/FastData/2018.npz
2024-09-15 00:32:10,569 - [*] load from log/AIR/trafficstream-42/2017/22.8851.pkl
2024-09-15 00:32:15,716 - number of increase nodes:145, nodes after 2 hop:torch.Size([305]), total nodes this year 1193
2024-09-15 00:32:16,988 - [*] Year 2018 Dataset load!
2024-09-15 00:32:16,988 - [*] load from log/AIR/trafficstream-42/2017/22.8851.pkl
2024-09-15 00:32:16,991 - [*] EWC! lambda 0.000100
2024-09-15 00:32:20,758 - [*] Year 2018 Training start
2024-09-15 00:32:21,838 - node number torch.Size([39040, 12])
2024-09-15 00:32:23,818 - epoch:0, training loss:1362.7461 validation loss:26.6150
2024-09-15 00:32:27,003 - epoch:1, training loss:1343.0244 validation loss:25.4072
2024-09-15 00:32:30,003 - epoch:2, training loss:1331.4614 validation loss:28.2816
2024-09-15 00:32:32,978 - epoch:3, training loss:1322.2544 validation loss:28.3434
2024-09-15 00:32:36,145 - epoch:4, training loss:1311.4284 validation loss:24.1695
2024-09-15 00:32:39,342 - epoch:5, training loss:1327.1555 validation loss:28.7078
2024-09-15 00:32:42,239 - epoch:6, training loss:1306.0423 validation loss:26.5220
2024-09-15 00:32:45,325 - epoch:7, training loss:1305.2954 validation loss:28.1633
2024-09-15 00:32:48,261 - epoch:8, training loss:1314.2798 validation loss:27.1505
2024-09-15 00:32:51,405 - epoch:9, training loss:1297.1671 validation loss:30.2427
2024-09-15 00:32:54,451 - epoch:10, training loss:1310.5717 validation loss:28.9160
2024-09-15 00:32:55,816 - [*] loss:1243.2933
2024-09-15 00:32:55,852 - [*] year 2018, testing
2024-09-15 00:32:56,238 - T:3	MAE	14.1399	RMSE	24.3540	MAPE	22.8355
2024-09-15 00:32:57,024 - T:6	MAE	17.4529	RMSE	29.7920	MAPE	28.9511
2024-09-15 00:32:59,274 - T:12	MAE	21.0095	RMSE	35.3223	MAPE	36.1301
2024-09-15 00:32:59,275 - T:Avg	MAE	17.1380	RMSE	29.1264	MAPE	28.6080
2024-09-15 00:32:59,276 - Finished optimization, total time:21.21 s, best model:log/AIR/trafficstream-42/2018/24.1695.pkl
2024-09-15 00:32:59,306 - [*] Year 2019 load from data/AIR/FastData/2019.npz
2024-09-15 00:32:59,321 - [*] load from log/AIR/trafficstream-42/2018/24.1695.pkl
2024-09-15 00:33:04,589 - number of increase nodes:120, nodes after 2 hop:torch.Size([233]), total nodes this year 1202
2024-09-15 00:33:05,810 - [*] Year 2019 Dataset load!
2024-09-15 00:33:05,810 - [*] load from log/AIR/trafficstream-42/2018/24.1695.pkl
2024-09-15 00:33:05,818 - [*] EWC! lambda 0.000100
2024-09-15 00:33:09,867 - [*] Year 2019 Training start
2024-09-15 00:33:11,037 - node number torch.Size([29824, 12])
2024-09-15 00:33:13,128 - epoch:0, training loss:935.6910 validation loss:19.4988
2024-09-15 00:33:16,020 - epoch:1, training loss:928.2463 validation loss:20.0586
2024-09-15 00:33:19,096 - epoch:2, training loss:926.0895 validation loss:19.0400
2024-09-15 00:33:21,989 - epoch:3, training loss:925.7494 validation loss:18.9967
2024-09-15 00:33:24,917 - epoch:4, training loss:927.4559 validation loss:18.8727
2024-09-15 00:33:27,884 - epoch:5, training loss:923.9574 validation loss:20.5196
2024-09-15 00:33:30,708 - epoch:6, training loss:927.9051 validation loss:19.2141
2024-09-15 00:33:33,852 - epoch:7, training loss:926.1211 validation loss:20.1053
2024-09-15 00:33:36,782 - epoch:8, training loss:925.9956 validation loss:18.8764
2024-09-15 00:33:39,685 - epoch:9, training loss:923.2464 validation loss:18.6450
2024-09-15 00:33:42,630 - epoch:10, training loss:923.8029 validation loss:18.7878
2024-09-15 00:33:45,572 - epoch:11, training loss:925.4397 validation loss:21.4680
2024-09-15 00:33:48,703 - epoch:12, training loss:924.1741 validation loss:20.2943
2024-09-15 00:33:51,835 - epoch:13, training loss:936.9062 validation loss:18.8205
2024-09-15 00:33:54,924 - epoch:14, training loss:928.8558 validation loss:19.9872
2024-09-15 00:33:57,983 - epoch:15, training loss:925.8646 validation loss:19.4634
2024-09-15 00:33:59,367 - [*] loss:1087.1747
2024-09-15 00:33:59,395 - [*] year 2019, testing
2024-09-15 00:33:59,780 - T:3	MAE	15.0202	RMSE	22.6167	MAPE	21.2038
2024-09-15 00:34:00,562 - T:6	MAE	17.9093	RMSE	27.8512	MAPE	25.2273
2024-09-15 00:34:02,868 - T:12	MAE	21.2655	RMSE	33.1750	MAPE	30.3841
2024-09-15 00:34:02,869 - T:Avg	MAE	17.7342	RMSE	27.2197	MAPE	25.2011
2024-09-15 00:34:02,870 - Finished optimization, total time:29.09 s, best model:log/AIR/trafficstream-42/2019/18.645.pkl
2024-09-15 00:34:02,880 - 


2024-09-15 00:34:02,881 - 3   	 MAE	     23.88	     19.21	     14.14	     15.02		   18.06
2024-09-15 00:34:02,881 - 3   	RMSE	     38.85	     28.76	     24.35	     22.62		   28.64
2024-09-15 00:34:02,881 - 3   	MAPE	     27.78	     22.15	     22.84	     21.20		   23.49
2024-09-15 00:34:02,881 - 6   	 MAE	     26.85	     22.67	     17.45	     17.91		   21.22
2024-09-15 00:34:02,881 - 6   	RMSE	     43.59	     34.49	     29.79	     27.85		   33.93
2024-09-15 00:34:02,881 - 6   	MAPE	     31.40	     26.16	     28.95	     25.23		   27.93
2024-09-15 00:34:02,881 - 12  	 MAE	     30.41	     26.46	     21.01	     21.27		   24.79
2024-09-15 00:34:02,881 - 12  	RMSE	     48.98	     40.29	     35.32	     33.18		   39.44
2024-09-15 00:34:02,881 - 12  	MAPE	     35.57	     30.80	     36.13	     30.38		   33.22
2024-09-15 00:34:02,881 - Avg 	 MAE	     26.71	     22.40	     17.14	     17.73		   20.99
2024-09-15 00:34:02,881 - Avg 	RMSE	     43.26	     33.84	     29.13	     27.22		   33.36
2024-09-15 00:34:02,881 - Avg 	MAPE	     31.16	     25.92	     28.61	     25.20		   27.72
2024-09-15 00:34:02,882 - year	2016	total_time	   62.5570	average_time	    3.2925	epoch	19
2024-09-15 00:34:02,882 - year	2017	total_time	   15.2572	average_time	    2.1796	epoch	7
2024-09-15 00:34:02,882 - year	2018	total_time	   21.2128	average_time	    1.9284	epoch	11
2024-09-15 00:34:02,882 - year	2019	total_time	   29.0922	average_time	    1.8183	epoch	16
2024-09-15 00:34:02,882 - total time: 128.1193
2025-05-09 04:20:34,879 - logger name:log/AIR/trafficstream-42/trafficstream.log
2025-05-09 04:20:34,879 - params : {'conf': 'conf/AIR/trafficstream.json', 'seed': 42, 'paral': 0, 'gpuid': 1, 'logname': 'trafficstream', 'method': 'TrafficStream', 'load_first_year': 1, 'first_year_model_path': 'log/ENERGY-Wind/eac-42/0/2.88.pkl', 'device': device(type='cuda', index=1), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>}, 'begin_year': 2016, 'end_year': 2019, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 1, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'raw_data_path': '/data/weichen/TrafficStream_data/AIR/RawData/', 'save_data_path': '/data/weichen/TrafficStream_data/AIR/FastData/', 'graph_path': '/data/weichen/TrafficStream_data/AIR/graph/', 'model_path': 'log/AIR/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'init': True, 'train': 0, 'auto_test': 1, 'strategy': 'incremental', 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'inforeplay', 'path': 'log/AIR/trafficstream-42', 'logger': <Logger utils.initialize (INFO)>}
2025-05-09 04:20:34,901 - [*] Year 2016 load from /data/weichen/TrafficStream_data/AIR/FastData/2016.npz
2025-05-09 04:20:35,050 - [*] load from log/AIR/trafficstream-42/2016/19.4853.pkl
2025-05-09 04:20:49,073 - [*] year 2016, testing
2025-05-09 04:20:49,595 - T:3	MAE	22.8140	RMSE	37.3172	MAPE	27.8068
2025-05-09 04:20:50,443 - T:6	MAE	25.8959	RMSE	42.2109	MAPE	31.5607
2025-05-09 04:20:52,899 - T:12	MAE	29.5268	RMSE	47.7151	MAPE	35.8311
2025-05-09 04:20:52,899 - T:Avg	MAE	25.7254	RMSE	41.8476	MAPE	31.2938
2025-05-09 04:20:52,923 - [*] Year 2017 load from /data/weichen/TrafficStream_data/AIR/FastData/2017.npz
2025-05-09 04:20:52,937 - [*] load from log/AIR/trafficstream-42/2017/22.8851.pkl
2025-05-09 04:20:58,331 - number of increase nodes:166, nodes after 2 hop:torch.Size([426]), total nodes this year 1154
2025-05-09 04:20:58,331 - [*] load from log/AIR/trafficstream-42/2017/22.8851.pkl
2025-05-09 04:21:12,643 - [*] year 2017, testing
2025-05-09 04:21:13,172 - T:3	MAE	18.2152	RMSE	27.8841	MAPE	21.2511
2025-05-09 04:21:14,082 - T:6	MAE	21.8127	RMSE	33.7463	MAPE	25.4883
2025-05-09 04:21:16,724 - T:12	MAE	25.7353	RMSE	39.6617	MAPE	30.3551
2025-05-09 04:21:16,724 - T:Avg	MAE	21.5167	RMSE	33.0698	MAPE	25.2223
2025-05-09 04:21:16,757 - [*] Year 2018 load from /data/weichen/TrafficStream_data/AIR/FastData/2018.npz
2025-05-09 04:21:16,785 - [*] load from log/AIR/trafficstream-42/2018/24.1695.pkl
2025-05-09 04:21:22,446 - number of increase nodes:145, nodes after 2 hop:torch.Size([307]), total nodes this year 1193
2025-05-09 04:21:22,447 - [*] load from log/AIR/trafficstream-42/2018/24.1695.pkl
2025-05-09 04:21:36,428 - [*] year 2018, testing
2025-05-09 04:21:36,955 - T:3	MAE	13.7253	RMSE	23.7567	MAPE	22.3212
2025-05-09 04:21:37,901 - T:6	MAE	17.0730	RMSE	29.2509	MAPE	28.4576
2025-05-09 04:21:40,487 - T:12	MAE	20.6573	RMSE	34.8081	MAPE	35.6449
2025-05-09 04:21:40,487 - T:Avg	MAE	16.7528	RMSE	28.5688	MAPE	28.1096
2025-05-09 04:21:40,514 - [*] Year 2019 load from /data/weichen/TrafficStream_data/AIR/FastData/2019.npz
2025-05-09 04:21:40,534 - [*] load from log/AIR/trafficstream-42/2019/18.645.pkl
2025-05-09 04:21:46,204 - number of increase nodes:120, nodes after 2 hop:torch.Size([249]), total nodes this year 1202
2025-05-09 04:21:46,205 - [*] load from log/AIR/trafficstream-42/2019/18.645.pkl
2025-05-09 04:22:00,614 - [*] year 2019, testing
2025-05-09 04:22:01,119 - T:3	MAE	14.1412	RMSE	21.8992	MAPE	20.1746
2025-05-09 04:22:02,035 - T:6	MAE	17.2045	RMSE	27.2560	MAPE	24.5865
2025-05-09 04:22:04,712 - T:12	MAE	20.6865	RMSE	32.6395	MAPE	30.0607
2025-05-09 04:22:04,712 - T:Avg	MAE	16.9906	RMSE	26.5828	MAPE	24.4885
2025-05-09 04:22:04,714 - 


2025-05-09 04:22:04,715 - 3   	 MAE	     22.81	     18.22	     13.73	     14.14		   17.22
2025-05-09 04:22:04,715 - 3   	RMSE	     37.32	     27.88	     23.76	     21.90		   27.71
2025-05-09 04:22:04,715 - 3   	MAPE	     27.81	     21.25	     22.32	     20.17		   22.89
2025-05-09 04:22:04,715 - 6   	 MAE	     25.90	     21.81	     17.07	     17.20		   20.50
2025-05-09 04:22:04,715 - 6   	RMSE	     42.21	     33.75	     29.25	     27.26		   33.12
2025-05-09 04:22:04,715 - 6   	MAPE	     31.56	     25.49	     28.46	     24.59		   27.52
2025-05-09 04:22:04,715 - 12  	 MAE	     29.53	     25.74	     20.66	     20.69		   24.15
2025-05-09 04:22:04,715 - 12  	RMSE	     47.72	     39.66	     34.81	     32.64		   38.71
2025-05-09 04:22:04,715 - 12  	MAPE	     35.83	     30.36	     35.64	     30.06		   32.97
2025-05-09 04:22:04,715 - Avg 	 MAE	     25.73	     21.52	     16.75	     16.99		   20.25
2025-05-09 04:22:04,715 - Avg 	RMSE	     41.85	     33.07	     28.57	     26.58		   32.52
2025-05-09 04:22:04,716 - Avg 	MAPE	     31.29	     25.22	     28.11	     24.49		   27.28
2025-05-09 04:22:04,716 - total time: 0.0000
