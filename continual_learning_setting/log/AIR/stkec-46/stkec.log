2024-09-15 01:06:00,677 - logger name:log/AIR/stkec-46/stkec.log
2024-09-15 01:06:00,677 - params : {'conf': 'new_conf/AIR/stkec.json', 'seed': 46, 'paral': 0, 'gpuid': 1, 'logname': 'stkec', 'method': 'STKEC', 'load_first_year': 0, 'first_year_model_path': 'log/PEMS3/trafficStream-42/2011/16.6936.pkl', 'device': device(type='cuda', index=1), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>}, 'begin_year': 2016, 'end_year': 2019, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'influe_length': 168, 'data_process': 0, 'batch_influ_size': 4, 'beita': 1, 'cluster': 24, 'raw_data_path': 'data/AIR/RawData/', 'save_data_path': 'data/AIR/FastData/', 'graph_path': 'data/AIR/graph/', 'model_path': 'log/AIR/', 'influence_path': "Pleaseenter'outdir'inyourpath", 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'init': True, 'train': 1, 'auto_test': 0, 'strategy': 'incremental', 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'detect_infl_strategy': True, 'infl_topk': 10, 'adp_adj': False, 'skip_dim': 64, 'end_dim': 64, 'hidden_channels': 32, 'dilation_channels': 64, 'residual_channels': 64, 'input_dim': 1, 'output_dim': 1, 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0005, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'path': 'log/AIR/stkec-46', 'logger': <Logger utils.initialize (INFO)>}
2024-09-15 01:06:00,698 - [*] Year 2016 load from data/AIR/FastData/2016.npz
2024-09-15 01:06:01,928 - [*] Year 2016 Dataset load!
2024-09-15 01:06:01,931 - [*] Year 2016 Training start
2024-09-15 01:06:02,929 - node number torch.Size([139136, 12])
2024-09-15 01:06:07,248 - epoch:0, training loss:3886.2877 validation loss:19.6285
2024-09-15 01:06:11,929 - epoch:1, training loss:1429.4623 validation loss:21.9118
2024-09-15 01:06:16,731 - epoch:2, training loss:1299.7929 validation loss:20.5359
2024-09-15 01:06:21,316 - epoch:3, training loss:1296.1157 validation loss:22.3507
2024-09-15 01:06:25,911 - epoch:4, training loss:1268.0677 validation loss:20.4560
2024-09-15 01:06:30,396 - epoch:5, training loss:1268.2739 validation loss:24.2266
2024-09-15 01:06:34,932 - epoch:6, training loss:1266.8052 validation loss:20.7047
2024-09-15 01:06:36,225 - [*] loss:2986.8188
2024-09-15 01:06:36,257 - [*] year 2016, testing
2024-09-15 01:06:36,675 - T:3	MAE	31.4496	RMSE	46.7248	MAPE	42.9522
2024-09-15 01:06:37,461 - T:6	MAE	33.4346	RMSE	50.2280	MAPE	43.9399
2024-09-15 01:06:39,772 - T:12	MAE	36.3276	RMSE	54.9859	MAPE	45.0518
2024-09-15 01:06:39,772 - T:Avg	MAE	33.5808	RMSE	50.3576	MAPE	43.8332
2024-09-15 01:06:39,774 - Finished optimization, total time:24.52 s, best model:log/AIR/stkec-46/2016/19.6285.pkl
2024-09-15 01:06:39,804 - [*] Year 2017 load from data/AIR/FastData/2017.npz
2024-09-15 01:06:39,812 - [*] load from log/AIR/stkec-46/2016/19.6285.pkl
2024-09-15 01:06:39,834 - [*] detect strategy feature
2024-09-15 01:06:44,474 - number of increase nodes:107, nodes after 2 hop:torch.Size([328]), total nodes this year 1154
2024-09-15 01:06:45,714 - [*] Year 2017 Dataset load!
2024-09-15 01:06:45,714 - [*] load from log/AIR/stkec-46/2016/19.6285.pkl
2024-09-15 01:06:45,717 - [*] EWC! lambda 0.000500
2024-09-15 01:06:49,406 - [*] Year 2017 Training start
2024-09-15 01:06:50,456 - node number torch.Size([41984, 12])
2024-09-15 01:06:52,699 - epoch:0, training loss:1484.4016 validation loss:30.3882
2024-09-15 01:06:55,517 - epoch:1, training loss:1240.6924 validation loss:23.5830
2024-09-15 01:06:58,358 - epoch:2, training loss:1203.2317 validation loss:27.4537
2024-09-15 01:07:01,267 - epoch:3, training loss:1189.2572 validation loss:26.3479
2024-09-15 01:07:04,188 - epoch:4, training loss:1156.6297 validation loss:24.1473
2024-09-15 01:07:07,176 - epoch:5, training loss:1154.5757 validation loss:24.7873
2024-09-15 01:07:10,204 - epoch:6, training loss:1144.9164 validation loss:28.4679
2024-09-15 01:07:13,055 - epoch:7, training loss:1149.5060 validation loss:27.2600
2024-09-15 01:07:14,401 - [*] loss:1720.5134
2024-09-15 01:07:14,444 - [*] year 2017, testing
2024-09-15 01:07:14,839 - T:3	MAE	20.6914	RMSE	31.9036	MAPE	23.9028
2024-09-15 01:07:15,638 - T:6	MAE	23.8515	RMSE	36.5593	MAPE	27.5935
2024-09-15 01:07:17,993 - T:12	MAE	27.6231	RMSE	41.8198	MAPE	32.0298
2024-09-15 01:07:17,993 - T:Avg	MAE	23.7068	RMSE	36.2399	MAPE	27.4348
2024-09-15 01:07:17,995 - Finished optimization, total time:15.28 s, best model:log/AIR/stkec-46/2017/23.583.pkl
2024-09-15 01:07:18,026 - [*] Year 2018 load from data/AIR/FastData/2018.npz
2024-09-15 01:07:18,035 - [*] load from log/AIR/stkec-46/2017/23.583.pkl
2024-09-15 01:07:18,053 - [*] detect strategy feature
2024-09-15 01:07:23,286 - number of increase nodes:111, nodes after 2 hop:torch.Size([319]), total nodes this year 1193
2024-09-15 01:07:24,551 - [*] Year 2018 Dataset load!
2024-09-15 01:07:24,551 - [*] load from log/AIR/stkec-46/2017/23.583.pkl
2024-09-15 01:07:24,555 - [*] EWC! lambda 0.000500
2024-09-15 01:07:28,272 - [*] Year 2018 Training start
2024-09-15 01:07:29,449 - node number torch.Size([40832, 12])
2024-09-15 01:07:31,398 - epoch:0, training loss:1433.3631 validation loss:25.3586
2024-09-15 01:07:34,327 - epoch:1, training loss:1320.0078 validation loss:30.0045
2024-09-15 01:07:37,251 - epoch:2, training loss:1301.2828 validation loss:26.4364
2024-09-15 01:07:40,151 - epoch:3, training loss:1302.8203 validation loss:25.4567
2024-09-15 01:07:43,082 - epoch:4, training loss:1306.5967 validation loss:27.5097
2024-09-15 01:07:46,051 - epoch:5, training loss:1294.7316 validation loss:25.5983
2024-09-15 01:07:48,866 - epoch:6, training loss:1280.5270 validation loss:28.6869
2024-09-15 01:07:50,216 - [*] loss:1248.4729
2024-09-15 01:07:50,250 - [*] year 2018, testing
2024-09-15 01:07:50,623 - T:3	MAE	16.1765	RMSE	26.7432	MAPE	28.1350
2024-09-15 01:07:51,400 - T:6	MAE	18.4575	RMSE	30.7934	MAPE	31.1314
2024-09-15 01:07:53,701 - T:12	MAE	21.1205	RMSE	35.3966	MAPE	34.5066
2024-09-15 01:07:53,701 - T:Avg	MAE	18.3106	RMSE	30.4820	MAPE	30.8869
2024-09-15 01:07:53,703 - Finished optimization, total time:13.05 s, best model:log/AIR/stkec-46/2018/25.3586.pkl
2024-09-15 01:07:53,737 - [*] Year 2019 load from data/AIR/FastData/2019.npz
2024-09-15 01:07:53,751 - [*] load from log/AIR/stkec-46/2018/25.3586.pkl
2024-09-15 01:07:53,769 - [*] detect strategy feature
2024-09-15 01:07:59,264 - number of increase nodes:117, nodes after 2 hop:torch.Size([304]), total nodes this year 1202
2024-09-15 01:08:00,520 - [*] Year 2019 Dataset load!
2024-09-15 01:08:00,520 - [*] load from log/AIR/stkec-46/2018/25.3586.pkl
2024-09-15 01:08:00,523 - [*] EWC! lambda 0.000500
2024-09-15 01:08:04,367 - [*] Year 2019 Training start
2024-09-15 01:08:05,579 - node number torch.Size([38912, 12])
2024-09-15 01:08:07,677 - epoch:0, training loss:1094.4945 validation loss:22.6514
2024-09-15 01:08:10,856 - epoch:1, training loss:1072.1039 validation loss:25.8447
2024-09-15 01:08:13,925 - epoch:2, training loss:1071.9492 validation loss:22.9806
2024-09-15 01:08:17,008 - epoch:3, training loss:1066.9200 validation loss:21.2558
2024-09-15 01:08:20,014 - epoch:4, training loss:1055.0997 validation loss:21.7931
2024-09-15 01:08:23,138 - epoch:5, training loss:1055.5605 validation loss:26.5757
2024-09-15 01:08:26,296 - epoch:6, training loss:1053.5593 validation loss:22.6501
2024-09-15 01:08:29,442 - epoch:7, training loss:1049.8727 validation loss:22.5005
2024-09-15 01:08:32,518 - epoch:8, training loss:1045.0699 validation loss:25.1197
2024-09-15 01:08:35,570 - epoch:9, training loss:1050.6142 validation loss:25.2201
2024-09-15 01:08:37,030 - [*] loss:1117.3771
2024-09-15 01:08:37,072 - [*] year 2019, testing
2024-09-15 01:08:37,479 - T:3	MAE	15.9312	RMSE	24.1498	MAPE	22.9696
2024-09-15 01:08:38,294 - T:6	MAE	18.6449	RMSE	28.8205	MAPE	26.3939
2024-09-15 01:08:40,693 - T:12	MAE	21.7524	RMSE	33.6554	MAPE	31.0755
2024-09-15 01:08:40,693 - T:Avg	MAE	18.5037	RMSE	28.3120	MAPE	26.4756
2024-09-15 01:08:40,695 - Finished optimization, total time:18.98 s, best model:log/AIR/stkec-46/2019/21.2558.pkl
2024-09-15 01:08:40,706 - 


2024-09-15 01:08:40,706 - 3   	 MAE	     31.45	     20.69	     16.18	     15.93		   21.06
2024-09-15 01:08:40,706 - 3   	RMSE	     46.72	     31.90	     26.74	     24.15		   32.38
2024-09-15 01:08:40,706 - 3   	MAPE	     42.95	     23.90	     28.13	     22.97		   29.49
2024-09-15 01:08:40,706 - 6   	 MAE	     33.43	     23.85	     18.46	     18.64		   23.60
2024-09-15 01:08:40,706 - 6   	RMSE	     50.23	     36.56	     30.79	     28.82		   36.60
2024-09-15 01:08:40,706 - 6   	MAPE	     43.94	     27.59	     31.13	     26.39		   32.26
2024-09-15 01:08:40,706 - 12  	 MAE	     36.33	     27.62	     21.12	     21.75		   26.71
2024-09-15 01:08:40,706 - 12  	RMSE	     54.99	     41.82	     35.40	     33.66		   41.46
2024-09-15 01:08:40,706 - 12  	MAPE	     45.05	     32.03	     34.51	     31.08		   35.67
2024-09-15 01:08:40,707 - Avg 	 MAE	     33.58	     23.71	     18.31	     18.50		   23.53
2024-09-15 01:08:40,707 - Avg 	RMSE	     50.36	     36.24	     30.48	     28.31		   36.35
2024-09-15 01:08:40,707 - Avg 	MAPE	     43.83	     27.43	     30.89	     26.48		   32.16
2024-09-15 01:08:40,707 - year	2016	total_time	   24.5215	average_time	    3.5031	epoch	7
2024-09-15 01:08:40,707 - year	2017	total_time	   15.2796	average_time	    1.9100	epoch	8
2024-09-15 01:08:40,707 - year	2018	total_time	   13.0466	average_time	    1.8638	epoch	7
2024-09-15 01:08:40,707 - year	2019	total_time	   18.9768	average_time	    1.8977	epoch	10
2024-09-15 01:08:40,707 - total time: 71.8244
2025-05-09 13:29:18,484 - logger name:log/AIR/stkec-46/stkec.log
2025-05-09 13:29:18,484 - params : {'conf': 'conf/AIR/stkec.json', 'seed': 46, 'paral': 0, 'gpuid': 1, 'logname': 'stkec', 'method': 'STKEC', 'load_first_year': 0, 'first_year_model_path': 'log/PEMS3/trafficStream-42/2011/16.6936.pkl', 'device': device(type='cuda', index=1), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>}, 'begin_year': 2016, 'end_year': 2019, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 1, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'influe_length': 168, 'data_process': 0, 'batch_influ_size': 4, 'beita': 1, 'cluster': 24, 'raw_data_path': '/data/weichen/TrafficStream_data/AIR/RawData/', 'save_data_path': '/data/weichen/TrafficStream_data/AIR/FastData/', 'graph_path': '/data/weichen/TrafficStream_data/AIR/graph/', 'model_path': 'log/AIR/', 'influence_path': "Pleaseenter'outdir'inyourpath", 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'init': True, 'train': 0, 'auto_test': 1, 'strategy': 'incremental', 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'detect_infl_strategy': True, 'infl_topk': 10, 'adp_adj': False, 'skip_dim': 64, 'end_dim': 64, 'hidden_channels': 32, 'dilation_channels': 64, 'residual_channels': 64, 'input_dim': 1, 'output_dim': 1, 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0005, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'path': 'log/AIR/stkec-46', 'logger': <Logger utils.initialize (INFO)>}
2025-05-09 13:29:18,511 - [*] Year 2016 load from /data/weichen/TrafficStream_data/AIR/FastData/2016.npz
2025-05-09 13:29:19,341 - [*] load from log/AIR/stkec-46/2016/19.6285.pkl
2025-05-09 13:30:16,078 - [*] year 2016, testing
2025-05-09 13:30:16,706 - T:3	MAE	30.4342	RMSE	45.2918	MAPE	43.1830
2025-05-09 13:30:17,901 - T:6	MAE	32.4369	RMSE	48.8492	MAPE	44.1662
2025-05-09 13:30:21,377 - T:12	MAE	35.2858	RMSE	53.6106	MAPE	45.1997
2025-05-09 13:30:21,377 - T:Avg	MAE	32.5486	RMSE	48.9451	MAPE	44.0190
2025-05-09 13:30:21,404 - [*] Year 2017 load from /data/weichen/TrafficStream_data/AIR/FastData/2017.npz
2025-05-09 13:30:21,416 - [*] load from log/AIR/stkec-46/2016/19.6285.pkl
2025-05-09 13:30:21,447 - [*] detect strategy feature
2025-05-09 13:30:26,334 - number of increase nodes:107, nodes after 2 hop:torch.Size([328]), total nodes this year 1154
2025-05-09 13:34:35,312 - [*] load from log/AIR/stkec-46/2017/23.583.pkl
2025-05-09 13:35:26,199 - [*] year 2017, testing
2025-05-09 13:35:26,757 - T:3	MAE	19.8654	RMSE	31.0174	MAPE	23.2860
2025-05-09 13:35:27,969 - T:6	MAE	23.0823	RMSE	35.7613	MAPE	27.0737
2025-05-09 13:35:31,680 - T:12	MAE	26.8962	RMSE	41.0908	MAPE	31.5987
2025-05-09 13:35:31,680 - T:Avg	MAE	22.9222	RMSE	35.4214	MAPE	26.8948
2025-05-09 13:35:31,710 - [*] Year 2018 load from /data/weichen/TrafficStream_data/AIR/FastData/2018.npz
2025-05-09 13:35:31,722 - [*] load from log/AIR/stkec-46/2017/23.583.pkl
2025-05-09 13:35:31,753 - [*] detect strategy feature
2025-05-09 13:35:36,874 - number of increase nodes:111, nodes after 2 hop:torch.Size([319]), total nodes this year 1193
2025-05-09 13:35:36,875 - [*] load from log/AIR/stkec-46/2018/25.3586.pkl
2025-05-09 13:36:26,056 - [*] year 2018, testing
2025-05-09 13:36:26,727 - T:3	MAE	15.9774	RMSE	26.2993	MAPE	27.9296
2025-05-09 13:36:27,903 - T:6	MAE	18.2494	RMSE	30.3788	MAPE	30.9203
2025-05-09 13:36:31,491 - T:12	MAE	20.9074	RMSE	35.0003	MAPE	34.3079
2025-05-09 13:36:31,491 - T:Avg	MAE	18.1055	RMSE	30.0606	MAPE	30.6828
2025-05-09 13:36:31,518 - [*] Year 2019 load from /data/weichen/TrafficStream_data/AIR/FastData/2019.npz
2025-05-09 13:36:31,539 - [*] load from log/AIR/stkec-46/2018/25.3586.pkl
2025-05-09 13:36:31,569 - [*] detect strategy feature
2025-05-09 13:36:36,869 - number of increase nodes:117, nodes after 2 hop:torch.Size([304]), total nodes this year 1202
2025-05-09 13:36:36,869 - [*] load from log/AIR/stkec-46/2019/21.2558.pkl
2025-05-09 13:37:15,104 - [*] year 2019, testing
2025-05-09 13:37:15,707 - T:3	MAE	15.1284	RMSE	23.3993	MAPE	22.0297
2025-05-09 13:37:16,892 - T:6	MAE	17.9802	RMSE	28.2086	MAPE	25.7677
2025-05-09 13:37:20,359 - T:12	MAE	21.2147	RMSE	33.1624	MAPE	30.7551
2025-05-09 13:37:20,359 - T:Avg	MAE	17.8083	RMSE	27.6700	MAPE	25.7887
2025-05-09 13:37:20,362 - 


2025-05-09 13:37:20,362 - 3   	 MAE	     30.43	     19.87	     15.98	     15.13		   20.35
2025-05-09 13:37:20,362 - 3   	RMSE	     45.29	     31.02	     26.30	     23.40		   31.50
2025-05-09 13:37:20,362 - 3   	MAPE	     43.18	     23.29	     27.93	     22.03		   29.11
2025-05-09 13:37:20,362 - 6   	 MAE	     32.44	     23.08	     18.25	     17.98		   22.94
2025-05-09 13:37:20,362 - 6   	RMSE	     48.85	     35.76	     30.38	     28.21		   35.80
2025-05-09 13:37:20,362 - 6   	MAPE	     44.17	     27.07	     30.92	     25.77		   31.98
2025-05-09 13:37:20,362 - 12  	 MAE	     35.29	     26.90	     20.91	     21.21		   26.08
2025-05-09 13:37:20,363 - 12  	RMSE	     53.61	     41.09	     35.00	     33.16		   40.72
2025-05-09 13:37:20,363 - 12  	MAPE	     45.20	     31.60	     34.31	     30.76		   35.47
2025-05-09 13:37:20,363 - Avg 	 MAE	     32.55	     22.92	     18.11	     17.81		   22.85
2025-05-09 13:37:20,363 - Avg 	RMSE	     48.95	     35.42	     30.06	     27.67		   35.52
2025-05-09 13:37:20,363 - Avg 	MAPE	     44.02	     26.89	     30.68	     25.79		   31.85
2025-05-09 13:37:20,363 - total time: 0.0000
