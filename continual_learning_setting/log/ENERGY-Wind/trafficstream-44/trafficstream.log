2024-09-29 18:18:03,824 - logger name:log/ENERGY-Wind/trafficstream-44/trafficstream.log
2024-09-29 18:18:03,824 - params : {'conf': 'new_conf/ENERGY-Wind/trafficstream.json', 'seed': 44, 'paral': 0, 'gpuid': 1, 'logname': 'trafficstream', 'method': 'TrafficStream', 'load_first_year': 0, 'first_year_model_path': 'log/PEMS/trafficstream-42/2011/16.6936.pkl', 'device': device(type='cuda', index=1), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>}, 'begin_year': 0, 'end_year': 3, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'raw_data_path': 'data/ENERGY-Wind/RawData/', 'save_data_path': 'data/ENERGY-Wind/FastData/', 'graph_path': 'data/ENERGY-Wind/graph/', 'model_path': 'log/ENERGY-Wind/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'init': True, 'train': 1, 'auto_test': 0, 'strategy': 'incremental', 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'inforeplay', 'path': 'log/ENERGY-Wind/trafficstream-44', 'logger': <Logger utils.initialize (INFO)>}
2024-09-29 18:18:03,828 - [*] Year 0 load from data/ENERGY-Wind/FastData/0.npz
2024-09-29 18:18:04,107 - [*] Year 0 Dataset load!
2024-09-29 18:18:04,130 - [*] Year 0 Training start
2024-09-29 18:18:04,735 - node number torch.Size([13184, 12])
2024-09-29 18:18:06,568 - epoch:0, training loss:431.8493 validation loss:6.3405
2024-09-29 18:18:08,537 - epoch:1, training loss:13.9612 validation loss:3.2726
2024-09-29 18:18:10,551 - epoch:2, training loss:3.3214 validation loss:3.2248
2024-09-29 18:18:12,493 - epoch:3, training loss:2.6626 validation loss:3.2401
2024-09-29 18:18:14,378 - epoch:4, training loss:2.4276 validation loss:3.3143
2024-09-29 18:18:16,323 - epoch:5, training loss:2.3464 validation loss:3.2363
2024-09-29 18:18:18,261 - epoch:6, training loss:2.2577 validation loss:3.1865
2024-09-29 18:18:20,159 - epoch:7, training loss:2.2111 validation loss:3.0966
2024-09-29 18:18:22,459 - epoch:8, training loss:2.1779 validation loss:3.1082
2024-09-29 18:18:24,489 - epoch:9, training loss:2.1388 validation loss:3.1192
2024-09-29 18:18:26,413 - epoch:10, training loss:2.1082 validation loss:3.2142
2024-09-29 18:18:28,310 - epoch:11, training loss:2.0844 validation loss:3.2087
2024-09-29 18:18:30,340 - epoch:12, training loss:2.0607 validation loss:3.0986
2024-09-29 18:18:32,686 - epoch:13, training loss:2.0520 validation loss:3.1200
2024-09-29 18:18:33,691 - [*] loss:34.1982
2024-09-29 18:18:33,716 - [*] year 0, testing
2024-09-29 18:18:33,776 - T:3	MAE	5.7015	RMSE	5.8122	MAPE	15.4830
2024-09-29 18:18:33,908 - T:6	MAE	5.6864	RMSE	5.8247	MAPE	15.4101
2024-09-29 18:18:35,262 - T:12	MAE	5.6428	RMSE	5.8511	MAPE	15.2187
2024-09-29 18:18:35,262 - T:Avg	MAE	5.6804	RMSE	5.8272	MAPE	15.3861
2024-09-29 18:18:35,262 - Finished optimization, total time:18.67 s, best model:log/ENERGY-Wind/trafficstream-44/0/3.0966.pkl
2024-09-29 18:18:35,268 - [*] Year 1 load from data/ENERGY-Wind/FastData/1.npz
2024-09-29 18:18:35,271 - [*] load from log/ENERGY-Wind/trafficstream-44/0/3.0966.pkl
2024-09-29 18:18:37,126 - number of increase nodes:20, nodes after 2 hop:torch.Size([74]), total nodes this year 113
2024-09-29 18:18:37,302 - [*] Year 1 Dataset load!
2024-09-29 18:18:37,302 - [*] load from log/ENERGY-Wind/trafficstream-44/0/3.0966.pkl
2024-09-29 18:18:37,349 - [*] EWC! lambda 0.000100
2024-09-29 18:18:38,918 - [*] Year 1 Training start
2024-09-29 18:18:39,714 - node number torch.Size([9472, 12])
2024-09-29 18:18:42,761 - epoch:0, training loss:5.3105 validation loss:1.0264
2024-09-29 18:18:46,220 - epoch:1, training loss:1.9634 validation loss:1.1836
2024-09-29 18:18:49,680 - epoch:2, training loss:1.8559 validation loss:1.1199
2024-09-29 18:18:53,238 - epoch:3, training loss:1.8373 validation loss:1.0926
2024-09-29 18:18:56,706 - epoch:4, training loss:1.8262 validation loss:1.0755
2024-09-29 18:19:00,243 - epoch:5, training loss:1.7886 validation loss:1.0914
2024-09-29 18:19:03,862 - epoch:6, training loss:1.7580 validation loss:1.1211
2024-09-29 18:19:05,002 - [*] loss:5.1782
2024-09-29 18:19:05,056 - [*] year 1, testing
2024-09-29 18:19:05,094 - T:3	MAE	1.8264	RMSE	2.0163	MAPE	5.0354
2024-09-29 18:19:05,166 - T:6	MAE	1.8613	RMSE	2.0902	MAPE	5.1580
2024-09-29 18:19:05,431 - T:12	MAE	1.9677	RMSE	2.2847	MAPE	5.5173
2024-09-29 18:19:05,431 - T:Avg	MAE	1.8750	RMSE	2.1140	MAPE	5.2034
2024-09-29 18:19:05,432 - Finished optimization, total time:16.77 s, best model:log/ENERGY-Wind/trafficstream-44/1/1.0264.pkl
2024-09-29 18:19:05,439 - [*] Year 2 load from data/ENERGY-Wind/FastData/2.npz
2024-09-29 18:19:05,441 - [*] load from log/ENERGY-Wind/trafficstream-44/1/1.0264.pkl
2024-09-29 18:19:07,447 - number of increase nodes:21, nodes after 2 hop:torch.Size([105]), total nodes this year 122
2024-09-29 18:19:07,612 - [*] Year 2 Dataset load!
2024-09-29 18:19:07,612 - [*] load from log/ENERGY-Wind/trafficstream-44/1/1.0264.pkl
2024-09-29 18:19:07,658 - [*] EWC! lambda 0.000100
2024-09-29 18:19:09,262 - [*] Year 2 Training start
2024-09-29 18:19:10,211 - node number torch.Size([13440, 12])
2024-09-29 18:19:13,209 - epoch:0, training loss:7.2667 validation loss:8.3364
2024-09-29 18:19:17,045 - epoch:1, training loss:2.2378 validation loss:7.9315
2024-09-29 18:19:20,809 - epoch:2, training loss:2.0925 validation loss:7.9893
2024-09-29 18:19:24,631 - epoch:3, training loss:2.0613 validation loss:7.9080
2024-09-29 18:19:28,452 - epoch:4, training loss:2.0007 validation loss:7.9128
2024-09-29 18:19:32,246 - epoch:5, training loss:1.9831 validation loss:8.0884
2024-09-29 18:19:36,084 - epoch:6, training loss:1.9706 validation loss:7.7135
2024-09-29 18:19:39,956 - epoch:7, training loss:1.9944 validation loss:7.8539
2024-09-29 18:19:43,712 - epoch:8, training loss:1.9314 validation loss:8.0006
2024-09-29 18:19:47,530 - epoch:9, training loss:1.9570 validation loss:7.7871
2024-09-29 18:19:51,343 - epoch:10, training loss:1.9657 validation loss:8.1829
2024-09-29 18:19:55,288 - epoch:11, training loss:1.9568 validation loss:8.0491
2024-09-29 18:19:59,204 - epoch:12, training loss:1.9102 validation loss:8.1295
2024-09-29 18:20:00,526 - [*] loss:63.2853
2024-09-29 18:20:00,533 - [*] year 2, testing
2024-09-29 18:20:00,576 - T:3	MAE	7.7998	RMSE	7.8905	MAPE	34.5287
2024-09-29 18:20:00,656 - T:6	MAE	7.8088	RMSE	7.9196	MAPE	34.6317
2024-09-29 18:20:00,955 - T:12	MAE	7.8213	RMSE	7.9799	MAPE	34.8536
2024-09-29 18:20:00,956 - T:Avg	MAE	7.8096	RMSE	7.9262	MAPE	34.6519
2024-09-29 18:20:00,956 - Finished optimization, total time:33.48 s, best model:log/ENERGY-Wind/trafficstream-44/2/7.7135.pkl
2024-09-29 18:20:00,968 - [*] Year 3 load from data/ENERGY-Wind/FastData/3.npz
2024-09-29 18:20:00,969 - [*] load from log/ENERGY-Wind/trafficstream-44/2/7.7135.pkl
2024-09-29 18:20:03,037 - number of increase nodes:24, nodes after 2 hop:torch.Size([117]), total nodes this year 134
2024-09-29 18:20:03,240 - [*] Year 3 Dataset load!
2024-09-29 18:20:03,240 - [*] load from log/ENERGY-Wind/trafficstream-44/2/7.7135.pkl
2024-09-29 18:20:03,287 - [*] EWC! lambda 0.000100
2024-09-29 18:20:04,968 - [*] Year 3 Training start
2024-09-29 18:20:05,872 - node number torch.Size([14976, 12])
2024-09-29 18:20:08,920 - epoch:0, training loss:21.6027 validation loss:7.2948
2024-09-29 18:20:12,949 - epoch:1, training loss:3.9137 validation loss:6.8184
2024-09-29 18:20:16,921 - epoch:2, training loss:3.1790 validation loss:6.6146
2024-09-29 18:20:20,770 - epoch:3, training loss:2.9003 validation loss:6.5835
2024-09-29 18:20:24,629 - epoch:4, training loss:2.7682 validation loss:6.7623
2024-09-29 18:20:28,518 - epoch:5, training loss:2.6928 validation loss:6.5844
2024-09-29 18:20:32,469 - epoch:6, training loss:2.6483 validation loss:6.6006
2024-09-29 18:20:36,390 - epoch:7, training loss:2.6130 validation loss:6.5741
2024-09-29 18:20:40,297 - epoch:8, training loss:2.5785 validation loss:6.5812
2024-09-29 18:20:44,112 - epoch:9, training loss:2.5489 validation loss:6.4586
2024-09-29 18:20:47,973 - epoch:10, training loss:2.5325 validation loss:6.6395
2024-09-29 18:20:51,928 - epoch:11, training loss:2.5022 validation loss:6.4531
2024-09-29 18:20:55,825 - epoch:12, training loss:2.5024 validation loss:6.6823
2024-09-29 18:20:59,683 - epoch:13, training loss:2.4760 validation loss:6.6134
2024-09-29 18:21:03,547 - epoch:14, training loss:2.4813 validation loss:6.4713
2024-09-29 18:21:07,498 - epoch:15, training loss:2.4732 validation loss:6.5207
2024-09-29 18:21:11,423 - epoch:16, training loss:2.4354 validation loss:6.6074
2024-09-29 18:21:15,287 - epoch:17, training loss:2.4341 validation loss:6.5311
2024-09-29 18:21:16,532 - [*] loss:56.2464
2024-09-29 18:21:16,541 - [*] year 3, testing
2024-09-29 18:21:16,589 - T:3	MAE	7.1928	RMSE	7.3834	MAPE	159.1460
2024-09-29 18:21:16,673 - T:6	MAE	7.1818	RMSE	7.4332	MAPE	161.2340
2024-09-29 18:21:17,836 - T:12	MAE	7.1582	RMSE	7.5411	MAPE	165.3356
2024-09-29 18:21:17,836 - T:Avg	MAE	7.1780	RMSE	7.4430	MAPE	161.3711
2024-09-29 18:21:17,836 - Finished optimization, total time:47.73 s, best model:log/ENERGY-Wind/trafficstream-44/3/6.4531.pkl
2024-09-29 18:21:17,845 - 


2024-09-29 18:21:17,846 - 3   	 MAE	      5.70	      1.83	      7.80	      7.19		    5.63
2024-09-29 18:21:17,846 - 3   	RMSE	      5.81	      2.02	      7.89	      7.38		    5.78
2024-09-29 18:21:17,846 - 3   	MAPE	     15.48	      5.04	     34.53	    159.15		   53.55
2024-09-29 18:21:17,846 - 6   	 MAE	      5.69	      1.86	      7.81	      7.18		    5.63
2024-09-29 18:21:17,846 - 6   	RMSE	      5.82	      2.09	      7.92	      7.43		    5.82
2024-09-29 18:21:17,846 - 6   	MAPE	     15.41	      5.16	     34.63	    161.23		   54.11
2024-09-29 18:21:17,846 - 12  	 MAE	      5.64	      1.97	      7.82	      7.16		    5.65
2024-09-29 18:21:17,846 - 12  	RMSE	      5.85	      2.28	      7.98	      7.54		    5.91
2024-09-29 18:21:17,846 - 12  	MAPE	     15.22	      5.52	     34.85	    165.34		   55.23
2024-09-29 18:21:17,846 - Avg 	 MAE	      5.68	      1.88	      7.81	      7.18		    5.64
2024-09-29 18:21:17,846 - Avg 	RMSE	      5.83	      2.11	      7.93	      7.44		    5.83
2024-09-29 18:21:17,846 - Avg 	MAPE	     15.39	      5.20	     34.65	    161.37		   54.15
2024-09-29 18:21:17,847 - year	0   	total_time	   18.6722	average_time	    1.3337	epoch	14
2024-09-29 18:21:17,847 - year	1   	total_time	   16.7666	average_time	    2.3952	epoch	7
2024-09-29 18:21:17,847 - year	2   	total_time	   33.4828	average_time	    2.5756	epoch	13
2024-09-29 18:21:17,847 - year	3   	total_time	   47.7295	average_time	    2.6517	epoch	18
2024-09-29 18:21:17,847 - total time: 116.6510
2025-05-09 04:27:22,077 - logger name:log/ENERGY-Wind/trafficstream-44/trafficstream.log
2025-05-09 04:27:22,078 - params : {'conf': 'conf/ENERGY-Wind/trafficstream.json', 'seed': 44, 'paral': 0, 'gpuid': 1, 'logname': 'trafficstream', 'method': 'TrafficStream', 'load_first_year': 1, 'first_year_model_path': 'log/ENERGY-Wind/eac-42/0/2.88.pkl', 'device': device(type='cuda', index=1), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>}, 'begin_year': 0, 'end_year': 3, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 1, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'raw_data_path': '/data/weichen/TrafficStream_data/ENERGY-Wind/RawData/', 'save_data_path': '/data/weichen/TrafficStream_data/ENERGY-Wind/FastData/', 'graph_path': '/data/weichen/TrafficStream_data/ENERGY-Wind/graph/', 'model_path': 'log/ENERGY-Wind/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'init': True, 'train': 0, 'auto_test': 1, 'strategy': 'incremental', 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'inforeplay', 'path': 'log/ENERGY-Wind/trafficstream-44', 'logger': <Logger utils.initialize (INFO)>}
2025-05-09 04:27:22,082 - [*] Year 0 load from /data/weichen/TrafficStream_data/ENERGY-Wind/FastData/0.npz
2025-05-09 04:27:22,218 - [*] load from log/ENERGY-Wind/trafficstream-44/0/3.0966.pkl
2025-05-09 04:27:35,883 - [*] year 0, testing
2025-05-09 04:27:35,948 - T:3	MAE	3.5044	RMSE	3.9405	MAPE	9.8576
2025-05-09 04:27:36,091 - T:6	MAE	3.5035	RMSE	3.9670	MAPE	9.8192
2025-05-09 04:27:36,474 - T:12	MAE	3.5011	RMSE	4.0275	MAPE	9.7318
2025-05-09 04:27:36,474 - T:Avg	MAE	3.5034	RMSE	3.9737	MAPE	9.8099
2025-05-09 04:27:36,479 - [*] Year 1 load from /data/weichen/TrafficStream_data/ENERGY-Wind/FastData/1.npz
2025-05-09 04:27:36,480 - [*] load from log/ENERGY-Wind/trafficstream-44/1/1.0264.pkl
2025-05-09 04:27:37,881 - number of increase nodes:20, nodes after 2 hop:torch.Size([74]), total nodes this year 113
2025-05-09 04:27:37,881 - [*] load from log/ENERGY-Wind/trafficstream-44/1/1.0264.pkl
2025-05-09 04:27:51,613 - [*] year 1, testing
2025-05-09 04:27:51,659 - T:3	MAE	0.7786	RMSE	1.0946	MAPE	2.2326
2025-05-09 04:27:51,729 - T:6	MAE	0.8759	RMSE	1.2288	MAPE	2.5149
2025-05-09 04:27:52,068 - T:12	MAE	1.1192	RMSE	1.5529	MAPE	3.2149
2025-05-09 04:27:52,068 - T:Avg	MAE	0.9059	RMSE	1.2668	MAPE	2.6002
2025-05-09 04:27:52,073 - [*] Year 2 load from /data/weichen/TrafficStream_data/ENERGY-Wind/FastData/2.npz
2025-05-09 04:27:52,074 - [*] load from log/ENERGY-Wind/trafficstream-44/2/7.7135.pkl
2025-05-09 04:27:53,617 - number of increase nodes:21, nodes after 2 hop:torch.Size([101]), total nodes this year 122
2025-05-09 04:27:53,617 - [*] load from log/ENERGY-Wind/trafficstream-44/2/7.7135.pkl
2025-05-09 04:28:07,269 - [*] year 2, testing
2025-05-09 04:28:07,319 - T:3	MAE	5.3812	RMSE	5.5965	MAPE	24.1807
2025-05-09 04:28:07,402 - T:6	MAE	5.3919	RMSE	5.6361	MAPE	24.2900
2025-05-09 04:28:07,735 - T:12	MAE	5.4100	RMSE	5.7223	MAPE	24.5300
2025-05-09 04:28:07,735 - T:Avg	MAE	5.3935	RMSE	5.6455	MAPE	24.3127
2025-05-09 04:28:07,741 - [*] Year 3 load from /data/weichen/TrafficStream_data/ENERGY-Wind/FastData/3.npz
2025-05-09 04:28:07,742 - [*] load from log/ENERGY-Wind/trafficstream-44/3/6.4531.pkl
2025-05-09 04:28:09,344 - number of increase nodes:24, nodes after 2 hop:torch.Size([109]), total nodes this year 134
2025-05-09 04:28:09,344 - [*] load from log/ENERGY-Wind/trafficstream-44/3/6.4531.pkl
2025-05-09 04:28:23,295 - [*] year 3, testing
2025-05-09 04:28:23,355 - T:3	MAE	6.0099	RMSE	6.2042	MAPE	139.1401
2025-05-09 04:28:23,444 - T:6	MAE	6.0018	RMSE	6.2618	MAPE	141.0849
2025-05-09 04:28:23,829 - T:12	MAE	5.9911	RMSE	6.3862	MAPE	145.0022
2025-05-09 04:28:23,829 - T:Avg	MAE	6.0003	RMSE	6.2731	MAPE	141.2297
2025-05-09 04:28:23,830 - 


2025-05-09 04:28:23,830 - 3   	 MAE	      3.50	      0.78	      5.38	      6.01		    3.92
2025-05-09 04:28:23,831 - 3   	RMSE	      3.94	      1.09	      5.60	      6.20		    4.21
2025-05-09 04:28:23,831 - 3   	MAPE	      9.86	      2.23	     24.18	    139.14		   43.85
2025-05-09 04:28:23,831 - 6   	 MAE	      3.50	      0.88	      5.39	      6.00		    3.94
2025-05-09 04:28:23,831 - 6   	RMSE	      3.97	      1.23	      5.64	      6.26		    4.27
2025-05-09 04:28:23,831 - 6   	MAPE	      9.82	      2.51	     24.29	    141.08		   44.43
2025-05-09 04:28:23,831 - 12  	 MAE	      3.50	      1.12	      5.41	      5.99		    4.01
2025-05-09 04:28:23,831 - 12  	RMSE	      4.03	      1.55	      5.72	      6.39		    4.42
2025-05-09 04:28:23,831 - 12  	MAPE	      9.73	      3.21	     24.53	    145.00		   45.62
2025-05-09 04:28:23,831 - Avg 	 MAE	      3.50	      0.91	      5.39	      6.00		    3.95
2025-05-09 04:28:23,831 - Avg 	RMSE	      3.97	      1.27	      5.65	      6.27		    4.29
2025-05-09 04:28:23,831 - Avg 	MAPE	      9.81	      2.60	     24.31	    141.23		   44.49
2025-05-09 04:28:23,831 - total time: 0.0000
