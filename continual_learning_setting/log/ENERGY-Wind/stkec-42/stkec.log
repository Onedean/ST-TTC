2024-09-29 18:26:45,429 - logger name:log/ENERGY-Wind/stkec-42/stkec.log
2024-09-29 18:26:45,429 - params : {'conf': 'new_conf/ENERGY-Wind/stkec.json', 'seed': 42, 'paral': 0, 'gpuid': 1, 'logname': 'stkec', 'method': 'STKEC', 'load_first_year': 0, 'first_year_model_path': 'log/PEMS3/trafficStream-42/2011/16.6936.pkl', 'device': device(type='cuda', index=1), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>}, 'begin_year': 0, 'end_year': 3, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'influe_length': 168, 'data_process': 0, 'batch_influ_size': 4, 'beita': 1, 'cluster': 24, 'raw_data_path': 'data/ENERGY-Wind/RawData/', 'save_data_path': 'data/ENERGY-Wind/FastData/', 'graph_path': 'data/ENERGY-Wind/graph/', 'model_path': 'log/ENERGY-Wind/', 'influence_path': "Pleaseenter'outdir'inyourpath", 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'init': True, 'train': 1, 'auto_test': 0, 'strategy': 'incremental', 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'detect_infl_strategy': True, 'infl_topk': 10, 'adp_adj': False, 'skip_dim': 64, 'end_dim': 64, 'hidden_channels': 32, 'dilation_channels': 64, 'residual_channels': 64, 'input_dim': 1, 'output_dim': 1, 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0005, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'path': 'log/ENERGY-Wind/stkec-42', 'logger': <Logger utils.initialize (INFO)>}
2024-09-29 18:26:45,433 - [*] Year 0 load from data/ENERGY-Wind/FastData/0.npz
2024-09-29 18:26:45,719 - [*] Year 0 Dataset load!
2024-09-29 18:26:45,745 - [*] Year 0 Training start
2024-09-29 18:26:46,355 - node number torch.Size([13184, 12])
2024-09-29 18:26:48,411 - epoch:0, training loss:212.7811 validation loss:4.0083
2024-09-29 18:26:50,527 - epoch:1, training loss:6.7179 validation loss:3.2015
2024-09-29 18:26:52,887 - epoch:2, training loss:3.8659 validation loss:3.1862
2024-09-29 18:26:55,183 - epoch:3, training loss:3.1428 validation loss:3.1968
2024-09-29 18:26:57,468 - epoch:4, training loss:2.7515 validation loss:3.1463
2024-09-29 18:26:59,715 - epoch:5, training loss:2.6277 validation loss:3.1954
2024-09-29 18:27:01,830 - epoch:6, training loss:2.5792 validation loss:3.2224
2024-09-29 18:27:03,942 - epoch:7, training loss:2.5258 validation loss:3.3956
2024-09-29 18:27:06,068 - epoch:8, training loss:2.4780 validation loss:3.2284
2024-09-29 18:27:08,180 - epoch:9, training loss:2.4263 validation loss:3.1899
2024-09-29 18:27:10,243 - epoch:10, training loss:2.3853 validation loss:3.4184
2024-09-29 18:27:11,334 - [*] loss:34.2569
2024-09-29 18:27:11,340 - [*] year 0, testing
2024-09-29 18:27:11,379 - T:3	MAE	5.5952	RMSE	5.6908	MAPE	15.0519
2024-09-29 18:27:11,454 - T:6	MAE	5.6148	RMSE	5.7382	MAPE	15.0526
2024-09-29 18:27:11,829 - T:12	MAE	5.6561	RMSE	5.8575	MAPE	15.1281
2024-09-29 18:27:11,829 - T:Avg	MAE	5.6157	RMSE	5.7482	MAPE	15.0568
2024-09-29 18:27:11,830 - Finished optimization, total time:16.84 s, best model:log/ENERGY-Wind/stkec-42/0/3.1463.pkl
2024-09-29 18:27:11,836 - [*] Year 1 load from data/ENERGY-Wind/FastData/1.npz
2024-09-29 18:27:11,838 - [*] load from log/ENERGY-Wind/stkec-42/0/3.1463.pkl
2024-09-29 18:27:11,891 - [*] detect strategy feature
2024-09-29 18:27:13,824 - number of increase nodes:28, nodes after 2 hop:torch.Size([97]), total nodes this year 113
2024-09-29 18:27:14,003 - [*] Year 1 Dataset load!
2024-09-29 18:27:14,003 - [*] load from log/ENERGY-Wind/stkec-42/0/3.1463.pkl
2024-09-29 18:27:14,055 - [*] EWC! lambda 0.000500
2024-09-29 18:27:15,368 - [*] Year 1 Training start
2024-09-29 18:27:16,199 - node number torch.Size([12416, 12])
2024-09-29 18:27:19,416 - epoch:0, training loss:8.3610 validation loss:1.0557
2024-09-29 18:27:23,116 - epoch:1, training loss:2.2327 validation loss:1.1570
2024-09-29 18:27:26,764 - epoch:2, training loss:2.0840 validation loss:1.0010
2024-09-29 18:27:30,428 - epoch:3, training loss:2.0782 validation loss:1.3135
2024-09-29 18:27:34,094 - epoch:4, training loss:2.0576 validation loss:1.0535
2024-09-29 18:27:37,179 - epoch:5, training loss:1.9954 validation loss:0.9802
2024-09-29 18:27:40,785 - epoch:6, training loss:2.0176 validation loss:0.9373
2024-09-29 18:27:44,435 - epoch:7, training loss:1.9869 validation loss:0.9841
2024-09-29 18:27:48,267 - epoch:8, training loss:1.9527 validation loss:0.9413
2024-09-29 18:27:52,070 - epoch:9, training loss:2.0366 validation loss:1.0227
2024-09-29 18:27:55,888 - epoch:10, training loss:1.9738 validation loss:1.3037
2024-09-29 18:27:59,739 - epoch:11, training loss:1.9556 validation loss:1.4275
2024-09-29 18:28:03,420 - epoch:12, training loss:2.0299 validation loss:0.9106
2024-09-29 18:28:07,114 - epoch:13, training loss:1.9553 validation loss:0.9749
2024-09-29 18:28:10,727 - epoch:14, training loss:1.8840 validation loss:1.1955
2024-09-29 18:28:14,369 - epoch:15, training loss:1.9527 validation loss:1.3795
2024-09-29 18:28:18,051 - epoch:16, training loss:2.0573 validation loss:1.7226
2024-09-29 18:28:21,719 - epoch:17, training loss:1.9821 validation loss:0.9418
2024-09-29 18:28:25,391 - epoch:18, training loss:1.9690 validation loss:1.0083
2024-09-29 18:28:26,517 - [*] loss:4.5220
2024-09-29 18:28:26,556 - [*] year 1, testing
2024-09-29 18:28:26,596 - T:3	MAE	1.7336	RMSE	1.8750	MAPE	4.8363
2024-09-29 18:28:26,672 - T:6	MAE	1.7559	RMSE	1.9526	MAPE	4.9220
2024-09-29 18:28:27,424 - T:12	MAE	1.8304	RMSE	2.1284	MAPE	5.1776
2024-09-29 18:28:27,425 - T:Avg	MAE	1.7750	RMSE	1.9796	MAPE	4.9804
2024-09-29 18:28:27,425 - Finished optimization, total time:47.50 s, best model:log/ENERGY-Wind/stkec-42/1/0.9106.pkl
2024-09-29 18:28:27,433 - [*] Year 2 load from data/ENERGY-Wind/FastData/2.npz
2024-09-29 18:28:27,435 - [*] load from log/ENERGY-Wind/stkec-42/1/0.9106.pkl
2024-09-29 18:28:27,488 - [*] detect strategy feature
2024-09-29 18:28:29,327 - number of increase nodes:27, nodes after 2 hop:torch.Size([112]), total nodes this year 122
2024-09-29 18:28:29,508 - [*] Year 2 Dataset load!
2024-09-29 18:28:29,509 - [*] load from log/ENERGY-Wind/stkec-42/1/0.9106.pkl
2024-09-29 18:28:29,545 - [*] EWC! lambda 0.000500
2024-09-29 18:28:31,262 - [*] Year 2 Training start
2024-09-29 18:28:32,158 - node number torch.Size([14336, 12])
2024-09-29 18:28:35,286 - epoch:0, training loss:10.0694 validation loss:8.1105
2024-09-29 18:28:39,168 - epoch:1, training loss:2.3603 validation loss:8.1867
2024-09-29 18:28:43,101 - epoch:2, training loss:2.0706 validation loss:7.9675
2024-09-29 18:28:46,921 - epoch:3, training loss:1.9918 validation loss:7.7680
2024-09-29 18:28:50,688 - epoch:4, training loss:1.9386 validation loss:8.0275
2024-09-29 18:28:54,586 - epoch:5, training loss:1.8640 validation loss:7.9964
2024-09-29 18:28:58,505 - epoch:6, training loss:1.8435 validation loss:8.4345
2024-09-29 18:29:02,415 - epoch:7, training loss:1.9046 validation loss:8.0906
2024-09-29 18:29:06,264 - epoch:8, training loss:1.8695 validation loss:7.9158
2024-09-29 18:29:10,053 - epoch:9, training loss:1.8996 validation loss:8.1965
2024-09-29 18:29:11,336 - [*] loss:61.5069
2024-09-29 18:29:11,343 - [*] year 2, testing
2024-09-29 18:29:11,389 - T:3	MAE	7.7425	RMSE	7.8179	MAPE	34.3793
2024-09-29 18:29:11,465 - T:6	MAE	7.7443	RMSE	7.8369	MAPE	34.4858
2024-09-29 18:29:11,665 - T:12	MAE	7.7200	RMSE	7.8606	MAPE	34.5467
2024-09-29 18:29:11,665 - T:Avg	MAE	7.7357	RMSE	7.8343	MAPE	34.4659
2024-09-29 18:29:11,670 - Finished optimization, total time:26.18 s, best model:log/ENERGY-Wind/stkec-42/2/7.768.pkl
2024-09-29 18:29:11,684 - [*] Year 3 load from data/ENERGY-Wind/FastData/3.npz
2024-09-29 18:29:11,684 - [*] load from log/ENERGY-Wind/stkec-42/2/7.768.pkl
2024-09-29 18:29:11,737 - [*] detect strategy feature
2024-09-29 18:29:13,768 - number of increase nodes:30, nodes after 2 hop:torch.Size([121]), total nodes this year 134
2024-09-29 18:29:13,986 - [*] Year 3 Dataset load!
2024-09-29 18:29:13,986 - [*] load from log/ENERGY-Wind/stkec-42/2/7.768.pkl
2024-09-29 18:29:14,016 - [*] EWC! lambda 0.000500
2024-09-29 18:29:15,956 - [*] Year 3 Training start
2024-09-29 18:29:16,924 - node number torch.Size([15488, 12])
2024-09-29 18:29:20,102 - epoch:0, training loss:24.1474 validation loss:7.1049
2024-09-29 18:29:23,992 - epoch:1, training loss:4.0535 validation loss:6.9573
2024-09-29 18:29:27,935 - epoch:2, training loss:3.2953 validation loss:6.7573
2024-09-29 18:29:31,908 - epoch:3, training loss:3.1227 validation loss:6.9381
2024-09-29 18:29:35,906 - epoch:4, training loss:3.0378 validation loss:6.6114
2024-09-29 18:29:39,817 - epoch:5, training loss:3.0028 validation loss:6.5798
2024-09-29 18:29:43,708 - epoch:6, training loss:2.9572 validation loss:6.5359
2024-09-29 18:29:47,619 - epoch:7, training loss:2.9196 validation loss:6.8165
2024-09-29 18:29:51,548 - epoch:8, training loss:2.8757 validation loss:6.5041
2024-09-29 18:29:55,514 - epoch:9, training loss:2.8472 validation loss:6.4707
2024-09-29 18:29:59,437 - epoch:10, training loss:2.8066 validation loss:6.6356
2024-09-29 18:30:03,340 - epoch:11, training loss:2.6786 validation loss:6.8987
2024-09-29 18:30:07,385 - epoch:12, training loss:2.5817 validation loss:6.5160
2024-09-29 18:30:11,352 - epoch:13, training loss:2.3993 validation loss:6.8502
2024-09-29 18:30:15,464 - epoch:14, training loss:2.3500 validation loss:7.1525
2024-09-29 18:30:19,335 - epoch:15, training loss:2.3682 validation loss:7.4448
2024-09-29 18:30:20,577 - [*] loss:55.8334
2024-09-29 18:30:20,611 - [*] year 3, testing
2024-09-29 18:30:20,656 - T:3	MAE	7.1231	RMSE	7.3286	MAPE	154.1678
2024-09-29 18:30:20,750 - T:6	MAE	7.1507	RMSE	7.4155	MAPE	156.8439
2024-09-29 18:30:21,282 - T:12	MAE	7.1126	RMSE	7.5158	MAPE	161.8920
2024-09-29 18:30:21,282 - T:Avg	MAE	7.1236	RMSE	7.4039	MAPE	157.1420
2024-09-29 18:30:21,282 - Finished optimization, total time:43.16 s, best model:log/ENERGY-Wind/stkec-42/3/6.4707.pkl
2024-09-29 18:30:21,289 - 


2024-09-29 18:30:21,289 - 3   	 MAE	      5.60	      1.73	      7.74	      7.12		    5.55
2024-09-29 18:30:21,289 - 3   	RMSE	      5.69	      1.87	      7.82	      7.33		    5.68
2024-09-29 18:30:21,289 - 3   	MAPE	     15.05	      4.84	     34.38	    154.17		   52.11
2024-09-29 18:30:21,289 - 6   	 MAE	      5.61	      1.76	      7.74	      7.15		    5.57
2024-09-29 18:30:21,289 - 6   	RMSE	      5.74	      1.95	      7.84	      7.42		    5.74
2024-09-29 18:30:21,290 - 6   	MAPE	     15.05	      4.92	     34.49	    156.84		   52.83
2024-09-29 18:30:21,290 - 12  	 MAE	      5.66	      1.83	      7.72	      7.11		    5.58
2024-09-29 18:30:21,290 - 12  	RMSE	      5.86	      2.13	      7.86	      7.52		    5.84
2024-09-29 18:30:21,290 - 12  	MAPE	     15.13	      5.18	     34.55	    161.89		   54.19
2024-09-29 18:30:21,290 - Avg 	 MAE	      5.62	      1.77	      7.74	      7.12		    5.56
2024-09-29 18:30:21,290 - Avg 	RMSE	      5.75	      1.98	      7.83	      7.40		    5.74
2024-09-29 18:30:21,290 - Avg 	MAPE	     15.06	      4.98	     34.47	    157.14		   52.91
2024-09-29 18:30:21,290 - year	0   	total_time	   16.8384	average_time	    1.5308	epoch	11
2024-09-29 18:30:21,290 - year	1   	total_time	   47.5002	average_time	    2.5000	epoch	19
2024-09-29 18:30:21,290 - year	2   	total_time	   26.1760	average_time	    2.6176	epoch	10
2024-09-29 18:30:21,290 - year	3   	total_time	   43.1616	average_time	    2.6976	epoch	16
2024-09-29 18:30:21,290 - total time: 133.6763
2025-05-09 13:29:18,489 - logger name:log/ENERGY-Wind/stkec-42/stkec.log
2025-05-09 13:29:18,489 - params : {'conf': 'conf/ENERGY-Wind/stkec.json', 'seed': 42, 'paral': 0, 'gpuid': 1, 'logname': 'stkec', 'method': 'STKEC', 'load_first_year': 0, 'first_year_model_path': 'log/PEMS3/trafficStream-42/2011/16.6936.pkl', 'device': device(type='cuda', index=1), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>}, 'begin_year': 0, 'end_year': 3, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 1, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'influe_length': 168, 'data_process': 0, 'batch_influ_size': 4, 'beita': 1, 'cluster': 24, 'raw_data_path': '/data/weichen/TrafficStream_data/ENERGY-Wind/RawData/', 'save_data_path': '/data/weichen/TrafficStream_data/ENERGY-Wind/FastData/', 'graph_path': '/data/weichen/TrafficStream_data/ENERGY-Wind/graph/', 'model_path': 'log/ENERGY-Wind/', 'influence_path': "Pleaseenter'outdir'inyourpath", 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'init': True, 'train': 0, 'auto_test': 1, 'strategy': 'incremental', 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'detect_infl_strategy': True, 'infl_topk': 10, 'adp_adj': False, 'skip_dim': 64, 'end_dim': 64, 'hidden_channels': 32, 'dilation_channels': 64, 'residual_channels': 64, 'input_dim': 1, 'output_dim': 1, 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0005, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'path': 'log/ENERGY-Wind/stkec-42', 'logger': <Logger utils.initialize (INFO)>}
2025-05-09 13:29:18,493 - [*] Year 0 load from /data/weichen/TrafficStream_data/ENERGY-Wind/FastData/0.npz
2025-05-09 13:29:19,174 - [*] load from log/ENERGY-Wind/stkec-42/0/3.1463.pkl
2025-05-09 13:30:16,039 - [*] year 0, testing
2025-05-09 13:30:16,088 - T:3	MAE	3.4034	RMSE	3.7928	MAPE	9.4397
2025-05-09 13:30:16,248 - T:6	MAE	3.4310	RMSE	3.8454	MAPE	9.4619
2025-05-09 13:30:16,697 - T:12	MAE	3.5099	RMSE	4.0068	MAPE	9.6318
2025-05-09 13:30:16,697 - T:Avg	MAE	3.4378	RMSE	3.8618	MAPE	9.4808
2025-05-09 13:30:16,704 - [*] Year 1 load from /data/weichen/TrafficStream_data/ENERGY-Wind/FastData/1.npz
2025-05-09 13:30:16,705 - [*] load from log/ENERGY-Wind/stkec-42/0/3.1463.pkl
2025-05-09 13:30:16,717 - [*] detect strategy feature
2025-05-09 13:30:18,723 - number of increase nodes:28, nodes after 2 hop:torch.Size([97]), total nodes this year 113
2025-05-09 13:30:18,723 - [*] load from log/ENERGY-Wind/stkec-42/1/0.9106.pkl
2025-05-09 13:35:16,722 - [*] year 1, testing
2025-05-09 13:35:16,775 - T:3	MAE	0.6920	RMSE	0.9825	MAPE	2.0164
2025-05-09 13:35:16,850 - T:6	MAE	0.8026	RMSE	1.1380	MAPE	2.3342
2025-05-09 13:35:17,172 - T:12	MAE	1.0427	RMSE	1.4637	MAPE	3.0153
2025-05-09 13:35:17,173 - T:Avg	MAE	0.8323	RMSE	1.1747	MAPE	2.4170
2025-05-09 13:35:17,178 - [*] Year 2 load from /data/weichen/TrafficStream_data/ENERGY-Wind/FastData/2.npz
2025-05-09 13:35:17,179 - [*] load from log/ENERGY-Wind/stkec-42/1/0.9106.pkl
2025-05-09 13:35:17,213 - [*] detect strategy feature
2025-05-09 13:35:18,791 - number of increase nodes:27, nodes after 2 hop:torch.Size([112]), total nodes this year 122
2025-05-09 13:35:18,791 - [*] load from log/ENERGY-Wind/stkec-42/2/7.768.pkl
2025-05-09 13:35:57,857 - [*] year 2, testing
2025-05-09 13:35:57,907 - T:3	MAE	5.3552	RMSE	5.5609	MAPE	24.1538
2025-05-09 13:35:57,989 - T:6	MAE	5.3583	RMSE	5.5921	MAPE	24.2642
2025-05-09 13:35:58,338 - T:12	MAE	5.3397	RMSE	5.6434	MAPE	24.3427
2025-05-09 13:35:58,338 - T:Avg	MAE	5.3507	RMSE	5.5931	MAPE	24.2474
2025-05-09 13:35:58,344 - [*] Year 3 load from /data/weichen/TrafficStream_data/ENERGY-Wind/FastData/3.npz
2025-05-09 13:35:58,345 - [*] load from log/ENERGY-Wind/stkec-42/2/7.768.pkl
2025-05-09 13:35:58,384 - [*] detect strategy feature
2025-05-09 13:36:00,046 - number of increase nodes:30, nodes after 2 hop:torch.Size([121]), total nodes this year 134
2025-05-09 13:36:00,046 - [*] load from log/ENERGY-Wind/stkec-42/3/6.4707.pkl
2025-05-09 13:36:40,778 - [*] year 3, testing
2025-05-09 13:36:40,834 - T:3	MAE	5.9479	RMSE	6.1572	MAPE	134.5731
2025-05-09 13:36:40,919 - T:6	MAE	5.9781	RMSE	6.2529	MAPE	137.1119
2025-05-09 13:36:41,294 - T:12	MAE	5.9545	RMSE	6.3696	MAPE	141.9976
2025-05-09 13:36:41,294 - T:Avg	MAE	5.9539	RMSE	6.2426	MAPE	137.4265
2025-05-09 13:36:41,295 - 


2025-05-09 13:36:41,295 - 3   	 MAE	      3.40	      0.69	      5.36	      5.95		    3.85
2025-05-09 13:36:41,295 - 3   	RMSE	      3.79	      0.98	      5.56	      6.16		    4.12
2025-05-09 13:36:41,295 - 3   	MAPE	      9.44	      2.02	     24.15	    134.57		   42.55
2025-05-09 13:36:41,296 - 6   	 MAE	      3.43	      0.80	      5.36	      5.98		    3.89
2025-05-09 13:36:41,296 - 6   	RMSE	      3.85	      1.14	      5.59	      6.25		    4.21
2025-05-09 13:36:41,296 - 6   	MAPE	      9.46	      2.33	     24.26	    137.11		   43.29
2025-05-09 13:36:41,296 - 12  	 MAE	      3.51	      1.04	      5.34	      5.95		    3.96
2025-05-09 13:36:41,296 - 12  	RMSE	      4.01	      1.46	      5.64	      6.37		    4.37
2025-05-09 13:36:41,296 - 12  	MAPE	      9.63	      3.02	     24.34	    142.00		   44.75
2025-05-09 13:36:41,296 - Avg 	 MAE	      3.44	      0.83	      5.35	      5.95		    3.89
2025-05-09 13:36:41,296 - Avg 	RMSE	      3.86	      1.17	      5.59	      6.24		    4.22
2025-05-09 13:36:41,296 - Avg 	MAPE	      9.48	      2.42	     24.25	    137.43		   43.39
2025-05-09 13:36:41,296 - total time: 0.0000
