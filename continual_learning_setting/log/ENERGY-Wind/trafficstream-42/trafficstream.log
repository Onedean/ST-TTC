2024-09-29 18:10:55,404 - logger name:log/ENERGY-Wind/trafficstream-42/trafficstream.log
2024-09-29 18:10:55,404 - params : {'conf': 'new_conf/ENERGY-Wind/trafficstream.json', 'seed': 42, 'paral': 0, 'gpuid': 1, 'logname': 'trafficstream', 'method': 'TrafficStream', 'load_first_year': 0, 'first_year_model_path': 'log/PEMS/trafficstream-42/2011/16.6936.pkl', 'device': device(type='cuda', index=1), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>}, 'begin_year': 0, 'end_year': 3, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'raw_data_path': 'data/ENERGY-Wind/RawData/', 'save_data_path': 'data/ENERGY-Wind/FastData/', 'graph_path': 'data/ENERGY-Wind/graph/', 'model_path': 'log/ENERGY-Wind/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'init': True, 'train': 1, 'auto_test': 0, 'strategy': 'incremental', 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'inforeplay', 'path': 'log/ENERGY-Wind/trafficstream-42', 'logger': <Logger utils.initialize (INFO)>}
2024-09-29 18:10:55,408 - [*] Year 0 load from data/ENERGY-Wind/FastData/0.npz
2024-09-29 18:10:55,687 - [*] Year 0 Dataset load!
2024-09-29 18:10:55,711 - [*] Year 0 Training start
2024-09-29 18:10:56,279 - node number torch.Size([13184, 12])
2024-09-29 18:10:58,110 - epoch:0, training loss:375.6643 validation loss:5.0403
2024-09-29 18:11:00,072 - epoch:1, training loss:12.8195 validation loss:3.1709
2024-09-29 18:11:02,051 - epoch:2, training loss:5.7147 validation loss:3.3096
2024-09-29 18:11:03,948 - epoch:3, training loss:4.5046 validation loss:3.2003
2024-09-29 18:11:06,004 - epoch:4, training loss:3.8006 validation loss:3.1280
2024-09-29 18:11:07,932 - epoch:5, training loss:3.3156 validation loss:3.2220
2024-09-29 18:11:09,791 - epoch:6, training loss:3.0156 validation loss:3.2191
2024-09-29 18:11:11,728 - epoch:7, training loss:2.7785 validation loss:3.2619
2024-09-29 18:11:13,617 - epoch:8, training loss:2.6167 validation loss:3.1963
2024-09-29 18:11:15,488 - epoch:9, training loss:2.5076 validation loss:3.2581
2024-09-29 18:11:17,371 - epoch:10, training loss:2.4105 validation loss:3.1323
2024-09-29 18:11:18,385 - [*] loss:35.3177
2024-09-29 18:11:18,391 - [*] year 0, testing
2024-09-29 18:11:18,451 - T:3	MAE	5.6382	RMSE	5.7938	MAPE	15.0325
2024-09-29 18:11:18,584 - T:6	MAE	5.6480	RMSE	5.8369	MAPE	15.0494
2024-09-29 18:11:18,954 - T:12	MAE	5.6708	RMSE	5.9388	MAPE	15.0822
2024-09-29 18:11:18,954 - T:Avg	MAE	5.6519	RMSE	5.8496	MAPE	15.0566
2024-09-29 18:11:18,955 - Finished optimization, total time:14.30 s, best model:log/ENERGY-Wind/trafficstream-42/0/3.128.pkl
2024-09-29 18:11:18,961 - [*] Year 1 load from data/ENERGY-Wind/FastData/1.npz
2024-09-29 18:11:18,962 - [*] load from log/ENERGY-Wind/trafficstream-42/0/3.128.pkl
2024-09-29 18:11:20,730 - number of increase nodes:20, nodes after 2 hop:torch.Size([83]), total nodes this year 113
2024-09-29 18:11:20,925 - [*] Year 1 Dataset load!
2024-09-29 18:11:20,925 - [*] load from log/ENERGY-Wind/trafficstream-42/0/3.128.pkl
2024-09-29 18:11:20,972 - [*] EWC! lambda 0.000100
2024-09-29 18:11:22,360 - [*] Year 1 Training start
2024-09-29 18:11:23,192 - node number torch.Size([10624, 12])
2024-09-29 18:11:26,359 - epoch:0, training loss:6.4646 validation loss:1.1782
2024-09-29 18:11:29,919 - epoch:1, training loss:2.5589 validation loss:1.1705
2024-09-29 18:11:33,493 - epoch:2, training loss:2.3234 validation loss:1.0434
2024-09-29 18:11:37,046 - epoch:3, training loss:2.2239 validation loss:1.0242
2024-09-29 18:11:40,638 - epoch:4, training loss:2.1201 validation loss:1.0569
2024-09-29 18:11:44,203 - epoch:5, training loss:2.0524 validation loss:1.0616
2024-09-29 18:11:47,900 - epoch:6, training loss:2.0416 validation loss:1.0562
2024-09-29 18:11:51,497 - epoch:7, training loss:2.0041 validation loss:0.9685
2024-09-29 18:11:55,140 - epoch:8, training loss:2.0211 validation loss:0.9768
2024-09-29 18:11:58,720 - epoch:9, training loss:1.9833 validation loss:0.9834
2024-09-29 18:12:02,339 - epoch:10, training loss:1.9328 validation loss:0.9715
2024-09-29 18:12:05,928 - epoch:11, training loss:1.9527 validation loss:1.0843
2024-09-29 18:12:09,613 - epoch:12, training loss:1.9172 validation loss:0.9741
2024-09-29 18:12:13,287 - epoch:13, training loss:1.9194 validation loss:1.0125
2024-09-29 18:12:14,450 - [*] loss:6.0700
2024-09-29 18:12:14,486 - [*] year 1, testing
2024-09-29 18:12:14,527 - T:3	MAE	1.9775	RMSE	2.1387	MAPE	5.6077
2024-09-29 18:12:14,607 - T:6	MAE	2.0450	RMSE	2.2405	MAPE	5.8074
2024-09-29 18:12:15,272 - T:12	MAE	2.1652	RMSE	2.4590	MAPE	6.1698
2024-09-29 18:12:15,272 - T:Avg	MAE	2.0524	RMSE	2.2637	MAPE	5.8306
2024-09-29 18:12:15,272 - Finished optimization, total time:34.50 s, best model:log/ENERGY-Wind/trafficstream-42/1/0.9685.pkl
2024-09-29 18:12:15,283 - [*] Year 2 load from data/ENERGY-Wind/FastData/2.npz
2024-09-29 18:12:15,285 - [*] load from log/ENERGY-Wind/trafficstream-42/1/0.9685.pkl
2024-09-29 18:12:17,414 - number of increase nodes:21, nodes after 2 hop:torch.Size([98]), total nodes this year 122
2024-09-29 18:12:17,597 - [*] Year 2 Dataset load!
2024-09-29 18:12:17,597 - [*] load from log/ENERGY-Wind/trafficstream-42/1/0.9685.pkl
2024-09-29 18:12:17,628 - [*] EWC! lambda 0.000100
2024-09-29 18:12:19,738 - [*] Year 2 Training start
2024-09-29 18:12:20,695 - node number torch.Size([12544, 12])
2024-09-29 18:12:23,693 - epoch:0, training loss:8.0909 validation loss:8.2905
2024-09-29 18:12:27,484 - epoch:1, training loss:2.1864 validation loss:7.7545
2024-09-29 18:12:31,306 - epoch:2, training loss:1.9971 validation loss:7.8003
2024-09-29 18:12:35,159 - epoch:3, training loss:1.9090 validation loss:7.8887
2024-09-29 18:12:38,950 - epoch:4, training loss:1.8755 validation loss:7.9253
2024-09-29 18:12:42,733 - epoch:5, training loss:1.8546 validation loss:7.5827
2024-09-29 18:12:46,559 - epoch:6, training loss:1.8628 validation loss:7.7168
2024-09-29 18:12:50,309 - epoch:7, training loss:1.8197 validation loss:7.8700
2024-09-29 18:12:53,984 - epoch:8, training loss:1.8268 validation loss:7.8954
2024-09-29 18:12:57,787 - epoch:9, training loss:1.8444 validation loss:7.7136
2024-09-29 18:13:01,572 - epoch:10, training loss:1.8189 validation loss:7.9510
2024-09-29 18:13:05,428 - epoch:11, training loss:1.8191 validation loss:7.7831
2024-09-29 18:13:06,665 - [*] loss:63.8445
2024-09-29 18:13:06,687 - [*] year 2, testing
2024-09-29 18:13:06,731 - T:3	MAE	7.8348	RMSE	7.9270	MAPE	34.6704
2024-09-29 18:13:06,986 - T:6	MAE	7.8340	RMSE	7.9467	MAPE	34.7373
2024-09-29 18:13:08,218 - T:12	MAE	7.8509	RMSE	8.0195	MAPE	34.9461
2024-09-29 18:13:08,219 - T:Avg	MAE	7.8372	RMSE	7.9580	MAPE	34.7570
2024-09-29 18:13:08,219 - Finished optimization, total time:30.69 s, best model:log/ENERGY-Wind/trafficstream-42/2/7.5827.pkl
2024-09-29 18:13:08,233 - [*] Year 3 load from data/ENERGY-Wind/FastData/3.npz
2024-09-29 18:13:08,234 - [*] load from log/ENERGY-Wind/trafficstream-42/2/7.5827.pkl
2024-09-29 18:13:10,221 - number of increase nodes:24, nodes after 2 hop:torch.Size([107]), total nodes this year 134
2024-09-29 18:13:10,415 - [*] Year 3 Dataset load!
2024-09-29 18:13:10,415 - [*] load from log/ENERGY-Wind/trafficstream-42/2/7.5827.pkl
2024-09-29 18:13:10,461 - [*] EWC! lambda 0.000100
2024-09-29 18:13:12,691 - [*] Year 3 Training start
2024-09-29 18:13:13,618 - node number torch.Size([13696, 12])
2024-09-29 18:13:16,652 - epoch:0, training loss:24.6562 validation loss:7.1201
2024-09-29 18:13:20,619 - epoch:1, training loss:4.5724 validation loss:6.9446
2024-09-29 18:13:24,469 - epoch:2, training loss:3.1217 validation loss:6.8031
2024-09-29 18:13:28,349 - epoch:3, training loss:2.7849 validation loss:6.5880
2024-09-29 18:13:32,316 - epoch:4, training loss:2.6652 validation loss:6.6326
2024-09-29 18:13:36,244 - epoch:5, training loss:2.5990 validation loss:6.6524
2024-09-29 18:13:40,119 - epoch:6, training loss:2.5721 validation loss:6.5690
2024-09-29 18:13:43,990 - epoch:7, training loss:2.5108 validation loss:6.4475
2024-09-29 18:13:47,803 - epoch:8, training loss:2.4796 validation loss:6.3922
2024-09-29 18:13:51,741 - epoch:9, training loss:2.4380 validation loss:6.6072
2024-09-29 18:13:55,605 - epoch:10, training loss:2.3993 validation loss:6.2169
2024-09-29 18:13:59,411 - epoch:11, training loss:2.3580 validation loss:6.2726
2024-09-29 18:14:03,240 - epoch:12, training loss:2.3240 validation loss:6.6670
2024-09-29 18:14:07,068 - epoch:13, training loss:2.3407 validation loss:6.4327
2024-09-29 18:14:10,855 - epoch:14, training loss:2.3276 validation loss:6.3292
2024-09-29 18:14:14,691 - epoch:15, training loss:2.2570 validation loss:6.3199
2024-09-29 18:14:18,505 - epoch:16, training loss:2.2048 validation loss:6.2134
2024-09-29 18:14:22,456 - epoch:17, training loss:2.2283 validation loss:6.2135
2024-09-29 18:14:26,704 - epoch:18, training loss:2.1788 validation loss:6.7320
2024-09-29 18:14:30,606 - epoch:19, training loss:2.1969 validation loss:6.8150
2024-09-29 18:14:34,432 - epoch:20, training loss:2.1742 validation loss:6.7009
2024-09-29 18:14:38,358 - epoch:21, training loss:2.1784 validation loss:6.6067
2024-09-29 18:14:42,407 - epoch:22, training loss:2.1607 validation loss:6.5348
2024-09-29 18:14:43,679 - [*] loss:53.7308
2024-09-29 18:14:43,788 - [*] year 3, testing
2024-09-29 18:14:43,833 - T:3	MAE	6.9488	RMSE	7.1640	MAPE	151.5380
2024-09-29 18:14:43,926 - T:6	MAE	6.9436	RMSE	7.2225	MAPE	154.1838
2024-09-29 18:14:44,429 - T:12	MAE	6.9605	RMSE	7.3741	MAPE	159.6138
2024-09-29 18:14:44,430 - T:Avg	MAE	6.9549	RMSE	7.2469	MAPE	154.7555
2024-09-29 18:14:44,430 - Finished optimization, total time:60.31 s, best model:log/ENERGY-Wind/trafficstream-42/3/6.2134.pkl
2024-09-29 18:14:44,442 - 


2024-09-29 18:14:44,443 - 3   	 MAE	      5.64	      1.98	      7.83	      6.95		    5.60
2024-09-29 18:14:44,443 - 3   	RMSE	      5.79	      2.14	      7.93	      7.16		    5.76
2024-09-29 18:14:44,443 - 3   	MAPE	     15.03	      5.61	     34.67	    151.54		   51.71
2024-09-29 18:14:44,443 - 6   	 MAE	      5.65	      2.05	      7.83	      6.94		    5.62
2024-09-29 18:14:44,443 - 6   	RMSE	      5.84	      2.24	      7.95	      7.22		    5.81
2024-09-29 18:14:44,443 - 6   	MAPE	     15.05	      5.81	     34.74	    154.18		   52.44
2024-09-29 18:14:44,443 - 12  	 MAE	      5.67	      2.17	      7.85	      6.96		    5.66
2024-09-29 18:14:44,443 - 12  	RMSE	      5.94	      2.46	      8.02	      7.37		    5.95
2024-09-29 18:14:44,443 - 12  	MAPE	     15.08	      6.17	     34.95	    159.61		   53.95
2024-09-29 18:14:44,443 - Avg 	 MAE	      5.65	      2.05	      7.84	      6.95		    5.62
2024-09-29 18:14:44,443 - Avg 	RMSE	      5.85	      2.26	      7.96	      7.25		    5.83
2024-09-29 18:14:44,443 - Avg 	MAPE	     15.06	      5.83	     34.76	    154.76		   52.60
2024-09-29 18:14:44,443 - year	0   	total_time	   14.3023	average_time	    1.3002	epoch	11
2024-09-29 18:14:44,443 - year	1   	total_time	   34.5039	average_time	    2.4646	epoch	14
2024-09-29 18:14:44,444 - year	2   	total_time	   30.6876	average_time	    2.5573	epoch	12
2024-09-29 18:14:44,444 - year	3   	total_time	   60.3132	average_time	    2.6223	epoch	23
2024-09-29 18:14:44,444 - total time: 139.8070
2025-05-09 04:25:11,408 - logger name:log/ENERGY-Wind/trafficstream-42/trafficstream.log
2025-05-09 04:25:11,408 - params : {'conf': 'conf/ENERGY-Wind/trafficstream.json', 'seed': 42, 'paral': 0, 'gpuid': 1, 'logname': 'trafficstream', 'method': 'TrafficStream', 'load_first_year': 1, 'first_year_model_path': 'log/ENERGY-Wind/eac-42/0/2.88.pkl', 'device': device(type='cuda', index=1), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>}, 'begin_year': 0, 'end_year': 3, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 1, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'raw_data_path': '/data/weichen/TrafficStream_data/ENERGY-Wind/RawData/', 'save_data_path': '/data/weichen/TrafficStream_data/ENERGY-Wind/FastData/', 'graph_path': '/data/weichen/TrafficStream_data/ENERGY-Wind/graph/', 'model_path': 'log/ENERGY-Wind/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'init': True, 'train': 0, 'auto_test': 1, 'strategy': 'incremental', 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'inforeplay', 'path': 'log/ENERGY-Wind/trafficstream-42', 'logger': <Logger utils.initialize (INFO)>}
2025-05-09 04:25:11,412 - [*] Year 0 load from /data/weichen/TrafficStream_data/ENERGY-Wind/FastData/0.npz
2025-05-09 04:25:11,582 - [*] load from log/ENERGY-Wind/trafficstream-42/0/3.128.pkl
2025-05-09 04:25:25,345 - [*] year 0, testing
2025-05-09 04:25:25,414 - T:3	MAE	3.4891	RMSE	3.8898	MAPE	9.5348
2025-05-09 04:25:25,563 - T:6	MAE	3.5158	RMSE	3.9539	MAPE	9.5923
2025-05-09 04:25:25,948 - T:12	MAE	3.5839	RMSE	4.1035	MAPE	9.7362
2025-05-09 04:25:25,948 - T:Avg	MAE	3.5256	RMSE	3.9718	MAPE	9.6137
2025-05-09 04:25:25,953 - [*] Year 1 load from /data/weichen/TrafficStream_data/ENERGY-Wind/FastData/1.npz
2025-05-09 04:25:25,954 - [*] load from log/ENERGY-Wind/trafficstream-42/1/0.9685.pkl
2025-05-09 04:25:27,719 - number of increase nodes:20, nodes after 2 hop:torch.Size([79]), total nodes this year 113
2025-05-09 04:25:27,719 - [*] load from log/ENERGY-Wind/trafficstream-42/1/0.9685.pkl
2025-05-09 04:25:41,151 - [*] year 1, testing
2025-05-09 04:25:41,195 - T:3	MAE	0.8563	RMSE	1.1828	MAPE	2.5132
2025-05-09 04:25:41,264 - T:6	MAE	0.9442	RMSE	1.3001	MAPE	2.7708
2025-05-09 04:25:41,586 - T:12	MAE	1.1668	RMSE	1.5958	MAPE	3.4058
2025-05-09 04:25:41,586 - T:Avg	MAE	0.9730	RMSE	1.3388	MAPE	2.8502
2025-05-09 04:25:41,591 - [*] Year 2 load from /data/weichen/TrafficStream_data/ENERGY-Wind/FastData/2.npz
2025-05-09 04:25:41,592 - [*] load from log/ENERGY-Wind/trafficstream-42/2/7.5827.pkl
2025-05-09 04:25:43,158 - number of increase nodes:21, nodes after 2 hop:torch.Size([105]), total nodes this year 122
2025-05-09 04:25:43,158 - [*] load from log/ENERGY-Wind/trafficstream-42/2/7.5827.pkl
2025-05-09 04:25:56,855 - [*] year 2, testing
2025-05-09 04:25:56,905 - T:3	MAE	5.3991	RMSE	5.6134	MAPE	24.2547
2025-05-09 04:25:56,986 - T:6	MAE	5.3998	RMSE	5.6446	MAPE	24.3267
2025-05-09 04:25:57,312 - T:12	MAE	5.4226	RMSE	5.7416	MAPE	24.5555
2025-05-09 04:25:57,313 - T:Avg	MAE	5.4040	RMSE	5.6581	MAPE	24.3497
2025-05-09 04:25:57,318 - [*] Year 3 load from /data/weichen/TrafficStream_data/ENERGY-Wind/FastData/3.npz
2025-05-09 04:25:57,319 - [*] load from log/ENERGY-Wind/trafficstream-42/3/6.2134.pkl
2025-05-09 04:25:58,853 - number of increase nodes:24, nodes after 2 hop:torch.Size([114]), total nodes this year 134
2025-05-09 04:25:58,853 - [*] load from log/ENERGY-Wind/trafficstream-42/3/6.2134.pkl
2025-05-09 04:26:12,426 - [*] year 3, testing
2025-05-09 04:26:12,477 - T:3	MAE	5.7863	RMSE	6.0006	MAPE	132.1784
2025-05-09 04:26:12,558 - T:6	MAE	5.7847	RMSE	6.0679	MAPE	134.7096
2025-05-09 04:26:12,925 - T:12	MAE	5.8158	RMSE	6.2375	MAPE	139.9622
2025-05-09 04:26:12,925 - T:Avg	MAE	5.7984	RMSE	6.0940	MAPE	135.2815
2025-05-09 04:26:12,926 - 


2025-05-09 04:26:12,926 - 3   	 MAE	      3.49	      0.86	      5.40	      5.79		    3.88
2025-05-09 04:26:12,926 - 3   	RMSE	      3.89	      1.18	      5.61	      6.00		    4.17
2025-05-09 04:26:12,927 - 3   	MAPE	      9.53	      2.51	     24.25	    132.18		   42.12
2025-05-09 04:26:12,927 - 6   	 MAE	      3.52	      0.94	      5.40	      5.78		    3.91
2025-05-09 04:26:12,927 - 6   	RMSE	      3.95	      1.30	      5.64	      6.07		    4.24
2025-05-09 04:26:12,927 - 6   	MAPE	      9.59	      2.77	     24.33	    134.71		   42.85
2025-05-09 04:26:12,927 - 12  	 MAE	      3.58	      1.17	      5.42	      5.82		    4.00
2025-05-09 04:26:12,927 - 12  	RMSE	      4.10	      1.60	      5.74	      6.24		    4.42
2025-05-09 04:26:12,927 - 12  	MAPE	      9.74	      3.41	     24.56	    139.96		   44.41
2025-05-09 04:26:12,927 - Avg 	 MAE	      3.53	      0.97	      5.40	      5.80		    3.93
2025-05-09 04:26:12,927 - Avg 	RMSE	      3.97	      1.34	      5.66	      6.09		    4.27
2025-05-09 04:26:12,927 - Avg 	MAPE	      9.61	      2.85	     24.35	    135.28		   43.02
2025-05-09 04:26:12,927 - total time: 0.0000
