2024-09-15 01:02:08,517 - logger name:log/PEMS/stkec-44/stkec.log
2024-09-15 01:02:08,517 - params : {'conf': 'new_conf/PEMS/stkec.json', 'seed': 44, 'paral': 0, 'gpuid': 0, 'logname': 'stkec', 'method': 'STKEC', 'load_first_year': 0, 'first_year_model_path': 'log/PEMS3/trafficStream-42/2011/16.6936.pkl', 'device': device(type='cuda', index=0), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>}, 'begin_year': 2011, 'end_year': 2017, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'influe_length': 168, 'data_process': 0, 'batch_influ_size': 4, 'beita': 1, 'cluster': 24, 'raw_data_path': 'data/PEMS/RawData/', 'save_data_path': 'data/PEMS/FastData/', 'graph_path': 'data/PEMS/graph/', 'model_path': 'log/PEMS/', 'influence_path': "Pleaseenter'outdir'inyourpath", 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'init': True, 'train': 1, 'auto_test': 0, 'strategy': 'incremental', 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'detect_infl_strategy': True, 'infl_topk': 10, 'adp_adj': False, 'skip_dim': 64, 'end_dim': 64, 'hidden_channels': 32, 'dilation_channels': 64, 'residual_channels': 64, 'input_dim': 1, 'output_dim': 1, 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0005, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'path': 'log/PEMS/stkec-44', 'logger': <Logger utils.initialize (INFO)>}
2024-09-15 01:02:08,530 - [*] Year 2011 load from data/PEMS/FastData/2011.npz
2024-09-15 01:02:09,289 - [*] Year 2011 Dataset load!
2024-09-15 01:02:09,291 - [*] Year 2011 Training start
2024-09-15 01:02:10,268 - node number torch.Size([83840, 12])
2024-09-15 01:02:13,223 - epoch:0, training loss:12626.2480 validation loss:28.7449
2024-09-15 01:02:16,564 - epoch:1, training loss:1251.9614 validation loss:19.3010
2024-09-15 01:02:19,983 - epoch:2, training loss:894.8231 validation loss:18.5933
2024-09-15 01:02:23,485 - epoch:3, training loss:832.6152 validation loss:18.1921
2024-09-15 01:02:26,968 - epoch:4, training loss:805.6163 validation loss:18.0836
2024-09-15 01:02:30,391 - epoch:5, training loss:782.6520 validation loss:17.9114
2024-09-15 01:02:33,847 - epoch:6, training loss:769.5924 validation loss:17.5856
2024-09-15 01:02:37,360 - epoch:7, training loss:759.0192 validation loss:17.4684
2024-09-15 01:02:40,907 - epoch:8, training loss:744.8768 validation loss:17.4127
2024-09-15 01:02:44,507 - epoch:9, training loss:739.7580 validation loss:17.3624
2024-09-15 01:02:47,893 - epoch:10, training loss:727.4213 validation loss:17.0428
2024-09-15 01:02:51,371 - epoch:11, training loss:725.2810 validation loss:17.1124
2024-09-15 01:02:55,101 - epoch:12, training loss:734.7917 validation loss:17.4132
2024-09-15 01:02:58,650 - epoch:13, training loss:716.9013 validation loss:17.2241
2024-09-15 01:03:02,029 - epoch:14, training loss:708.5071 validation loss:16.5680
2024-09-15 01:03:05,568 - epoch:15, training loss:726.5129 validation loss:17.1772
2024-09-15 01:03:09,134 - epoch:16, training loss:678.3925 validation loss:16.6903
2024-09-15 01:03:12,585 - epoch:17, training loss:674.1106 validation loss:16.4845
2024-09-15 01:03:16,177 - epoch:18, training loss:671.9027 validation loss:16.4472
2024-09-15 01:03:19,775 - epoch:19, training loss:675.5916 validation loss:16.5723
2024-09-15 01:03:23,158 - epoch:20, training loss:669.1141 validation loss:16.3496
2024-09-15 01:03:26,672 - epoch:21, training loss:679.1247 validation loss:16.9349
2024-09-15 01:03:30,287 - epoch:22, training loss:668.1781 validation loss:16.3494
2024-09-15 01:03:33,975 - epoch:23, training loss:661.2042 validation loss:16.3319
2024-09-15 01:03:37,388 - epoch:24, training loss:663.9397 validation loss:16.2389
2024-09-15 01:03:40,827 - epoch:25, training loss:665.3285 validation loss:16.7727
2024-09-15 01:03:44,209 - epoch:26, training loss:669.1669 validation loss:16.5226
2024-09-15 01:03:47,665 - epoch:27, training loss:659.5257 validation loss:16.8091
2024-09-15 01:03:51,135 - epoch:28, training loss:661.6788 validation loss:16.2700
2024-09-15 01:03:54,815 - epoch:29, training loss:677.1385 validation loss:18.3129
2024-09-15 01:03:58,347 - epoch:30, training loss:668.1402 validation loss:16.3094
2024-09-15 01:03:59,385 - [*] loss:614.4081
2024-09-15 01:03:59,408 - [*] year 2011, testing
2024-09-15 01:03:59,689 - T:3	MAE	12.9512	RMSE	19.6913	MAPE	18.6084
2024-09-15 01:04:00,178 - T:6	MAE	13.9468	RMSE	21.4299	MAPE	19.7890
2024-09-15 01:04:01,708 - T:12	MAE	16.0511	RMSE	24.9968	MAPE	23.0052
2024-09-15 01:04:01,708 - T:Avg	MAE	14.1092	RMSE	21.6806	MAPE	20.1395
2024-09-15 01:04:01,709 - Finished optimization, total time:75.46 s, best model:log/PEMS/stkec-44/2011/16.2389.pkl
2024-09-15 01:04:01,727 - [*] Year 2012 load from data/PEMS/FastData/2012.npz
2024-09-15 01:04:01,731 - [*] load from log/PEMS/stkec-44/2011/16.2389.pkl
2024-09-15 01:04:01,740 - [*] detect strategy feature
2024-09-15 01:04:05,332 - number of increase nodes:78, nodes after 2 hop:torch.Size([238]), total nodes this year 715
2024-09-15 01:04:06,086 - [*] Year 2012 Dataset load!
2024-09-15 01:04:06,086 - [*] load from log/PEMS/stkec-44/2011/16.2389.pkl
2024-09-15 01:04:06,089 - [*] EWC! lambda 0.000500
2024-09-15 01:04:08,987 - [*] Year 2012 Training start
2024-09-15 01:04:10,026 - node number torch.Size([30464, 12])
2024-09-15 01:04:12,211 - epoch:0, training loss:862.0040 validation loss:15.3449
2024-09-15 01:04:14,819 - epoch:1, training loss:623.6162 validation loss:14.5978
2024-09-15 01:04:17,565 - epoch:2, training loss:619.6902 validation loss:14.6842
2024-09-15 01:04:20,186 - epoch:3, training loss:617.6689 validation loss:14.6045
2024-09-15 01:04:22,932 - epoch:4, training loss:619.5731 validation loss:14.5991
2024-09-15 01:04:25,711 - epoch:5, training loss:615.6536 validation loss:14.5253
2024-09-15 01:04:28,389 - epoch:6, training loss:617.8716 validation loss:14.6781
2024-09-15 01:04:31,142 - epoch:7, training loss:617.9239 validation loss:14.5067
2024-09-15 01:04:33,821 - epoch:8, training loss:608.0249 validation loss:14.6625
2024-09-15 01:04:36,555 - epoch:9, training loss:611.6299 validation loss:14.4901
2024-09-15 01:04:39,334 - epoch:10, training loss:610.6390 validation loss:14.5731
2024-09-15 01:04:42,047 - epoch:11, training loss:620.9902 validation loss:15.0621
2024-09-15 01:04:44,784 - epoch:12, training loss:618.5687 validation loss:14.5032
2024-09-15 01:04:47,442 - epoch:13, training loss:613.9602 validation loss:14.4691
2024-09-15 01:04:50,144 - epoch:14, training loss:612.7956 validation loss:14.6900
2024-09-15 01:04:52,930 - epoch:15, training loss:609.6994 validation loss:14.7885
2024-09-15 01:04:55,732 - epoch:16, training loss:620.2974 validation loss:14.6342
2024-09-15 01:04:58,383 - epoch:17, training loss:605.6233 validation loss:14.7731
2024-09-15 01:05:01,094 - epoch:18, training loss:601.8085 validation loss:14.6259
2024-09-15 01:05:03,875 - epoch:19, training loss:605.0598 validation loss:14.4361
2024-09-15 01:05:06,832 - epoch:20, training loss:618.7688 validation loss:14.4959
2024-09-15 01:05:09,501 - epoch:21, training loss:598.4679 validation loss:14.6356
2024-09-15 01:05:12,211 - epoch:22, training loss:601.1732 validation loss:14.6872
2024-09-15 01:05:14,993 - epoch:23, training loss:600.1393 validation loss:14.6579
2024-09-15 01:05:17,715 - epoch:24, training loss:607.9056 validation loss:14.5014
2024-09-15 01:05:20,464 - epoch:25, training loss:599.5304 validation loss:14.4809
2024-09-15 01:05:21,582 - [*] loss:641.4038
2024-09-15 01:05:21,612 - [*] year 2012, testing
2024-09-15 01:05:21,880 - T:3	MAE	12.9774	RMSE	19.9083	MAPE	20.8040
2024-09-15 01:05:22,391 - T:6	MAE	14.0264	RMSE	21.7875	MAPE	22.3100
2024-09-15 01:05:23,929 - T:12	MAE	16.1635	RMSE	25.5399	MAPE	25.7143
2024-09-15 01:05:23,929 - T:Avg	MAE	14.1895	RMSE	22.0593	MAPE	22.6383
2024-09-15 01:05:23,931 - Finished optimization, total time:44.23 s, best model:log/PEMS/stkec-44/2012/14.4361.pkl
2024-09-15 01:05:23,962 - [*] Year 2013 load from data/PEMS/FastData/2013.npz
2024-09-15 01:05:23,966 - [*] load from log/PEMS/stkec-44/2012/14.4361.pkl
2024-09-15 01:05:23,975 - [*] detect strategy feature
2024-09-15 01:05:27,923 - number of increase nodes:91, nodes after 2 hop:torch.Size([214]), total nodes this year 786
2024-09-15 01:05:28,731 - [*] Year 2013 Dataset load!
2024-09-15 01:05:28,732 - [*] load from log/PEMS/stkec-44/2012/14.4361.pkl
2024-09-15 01:05:28,735 - [*] EWC! lambda 0.000500
2024-09-15 01:05:31,679 - [*] Year 2013 Training start
2024-09-15 01:05:32,759 - node number torch.Size([27392, 12])
2024-09-15 01:05:34,490 - epoch:0, training loss:816.6115 validation loss:14.2402
2024-09-15 01:05:37,253 - epoch:1, training loss:507.9973 validation loss:14.1231
2024-09-15 01:05:39,919 - epoch:2, training loss:496.0032 validation loss:13.9717
2024-09-15 01:05:42,656 - epoch:3, training loss:494.2226 validation loss:14.1978
2024-09-15 01:05:45,421 - epoch:4, training loss:491.0136 validation loss:13.8228
2024-09-15 01:05:48,100 - epoch:5, training loss:491.3308 validation loss:14.8649
2024-09-15 01:05:50,829 - epoch:6, training loss:492.2231 validation loss:14.3131
2024-09-15 01:05:53,504 - epoch:7, training loss:495.1649 validation loss:14.6340
2024-09-15 01:05:56,148 - epoch:8, training loss:493.0016 validation loss:14.6596
2024-09-15 01:05:58,693 - epoch:9, training loss:491.8522 validation loss:13.6295
2024-09-15 01:06:01,333 - epoch:10, training loss:491.6853 validation loss:14.1739
2024-09-15 01:06:03,971 - epoch:11, training loss:491.6213 validation loss:13.9376
2024-09-15 01:06:06,664 - epoch:12, training loss:488.4616 validation loss:14.0176
2024-09-15 01:06:09,422 - epoch:13, training loss:488.6025 validation loss:13.9866
2024-09-15 01:06:12,028 - epoch:14, training loss:493.2942 validation loss:13.5893
2024-09-15 01:06:14,681 - epoch:15, training loss:492.2830 validation loss:13.7580
2024-09-15 01:06:17,539 - epoch:16, training loss:492.7947 validation loss:13.7589
2024-09-15 01:06:20,263 - epoch:17, training loss:503.7293 validation loss:13.5769
2024-09-15 01:06:22,923 - epoch:18, training loss:504.0590 validation loss:13.7274
2024-09-15 01:06:25,573 - epoch:19, training loss:489.4575 validation loss:13.7416
2024-09-15 01:06:28,417 - epoch:20, training loss:502.0440 validation loss:13.8172
2024-09-15 01:06:31,060 - epoch:21, training loss:481.8879 validation loss:13.8256
2024-09-15 01:06:33,749 - epoch:22, training loss:487.4993 validation loss:13.7553
2024-09-15 01:06:36,452 - epoch:23, training loss:478.7755 validation loss:13.9289
2024-09-15 01:06:37,635 - [*] loss:672.3510
2024-09-15 01:06:37,672 - [*] year 2013, testing
2024-09-15 01:06:37,936 - T:3	MAE	12.4500	RMSE	19.7835	MAPE	18.2624
2024-09-15 01:06:38,508 - T:6	MAE	13.6107	RMSE	21.9238	MAPE	19.4986
2024-09-15 01:06:40,179 - T:12	MAE	15.9886	RMSE	26.1339	MAPE	22.1575
2024-09-15 01:06:40,180 - T:Avg	MAE	13.7928	RMSE	22.2068	MAPE	19.7407
2024-09-15 01:06:40,181 - Finished optimization, total time:39.39 s, best model:log/PEMS/stkec-44/2013/13.5769.pkl
2024-09-15 01:06:40,209 - [*] Year 2014 load from data/PEMS/FastData/2014.npz
2024-09-15 01:06:40,214 - [*] load from log/PEMS/stkec-44/2013/13.5769.pkl
2024-09-15 01:06:40,223 - [*] detect strategy feature
2024-09-15 01:06:44,287 - number of increase nodes:82, nodes after 2 hop:torch.Size([280]), total nodes this year 822
2024-09-15 01:06:45,155 - [*] Year 2014 Dataset load!
2024-09-15 01:06:45,156 - [*] load from log/PEMS/stkec-44/2013/13.5769.pkl
2024-09-15 01:06:45,159 - [*] EWC! lambda 0.000500
2024-09-15 01:06:48,059 - [*] Year 2014 Training start
2024-09-15 01:06:49,102 - node number torch.Size([35840, 12])
2024-09-15 01:06:51,004 - epoch:0, training loss:805.0256 validation loss:15.1923
2024-09-15 01:06:53,902 - epoch:1, training loss:683.4872 validation loss:15.1979
2024-09-15 01:06:56,803 - epoch:2, training loss:685.0376 validation loss:14.9604
2024-09-15 01:06:59,870 - epoch:3, training loss:679.1003 validation loss:15.4100
2024-09-15 01:07:02,775 - epoch:4, training loss:671.7567 validation loss:14.9555
2024-09-15 01:07:05,661 - epoch:5, training loss:684.4354 validation loss:16.3681
2024-09-15 01:07:08,627 - epoch:6, training loss:686.2046 validation loss:14.9371
2024-09-15 01:07:11,664 - epoch:7, training loss:687.6480 validation loss:15.4953
2024-09-15 01:07:14,594 - epoch:8, training loss:679.1505 validation loss:15.6203
2024-09-15 01:07:17,570 - epoch:9, training loss:670.2778 validation loss:15.2585
2024-09-15 01:07:20,605 - epoch:10, training loss:675.3772 validation loss:15.2176
2024-09-15 01:07:23,546 - epoch:11, training loss:671.9879 validation loss:15.0125
2024-09-15 01:07:26,344 - epoch:12, training loss:696.4834 validation loss:15.0898
2024-09-15 01:07:27,578 - [*] loss:759.9001
2024-09-15 01:07:27,614 - [*] year 2014, testing
2024-09-15 01:07:27,895 - T:3	MAE	13.3274	RMSE	21.4605	MAPE	17.5336
2024-09-15 01:07:28,454 - T:6	MAE	14.4730	RMSE	23.5612	MAPE	18.5416
2024-09-15 01:07:30,145 - T:12	MAE	16.9322	RMSE	27.8723	MAPE	20.9797
2024-09-15 01:07:30,145 - T:Avg	MAE	14.6766	RMSE	23.8721	MAPE	18.7725
2024-09-15 01:07:30,147 - Finished optimization, total time:23.87 s, best model:log/PEMS/stkec-44/2014/14.9371.pkl
2024-09-15 01:07:30,181 - [*] Year 2015 load from data/PEMS/FastData/2015.npz
2024-09-15 01:07:30,186 - [*] load from log/PEMS/stkec-44/2014/14.9371.pkl
2024-09-15 01:07:30,195 - [*] detect strategy feature
2024-09-15 01:07:34,368 - number of increase nodes:82, nodes after 2 hop:torch.Size([288]), total nodes this year 834
2024-09-15 01:07:35,290 - [*] Year 2015 Dataset load!
2024-09-15 01:07:35,291 - [*] load from log/PEMS/stkec-44/2014/14.9371.pkl
2024-09-15 01:07:35,294 - [*] EWC! lambda 0.000500
2024-09-15 01:07:38,322 - [*] Year 2015 Training start
2024-09-15 01:07:39,409 - node number torch.Size([36864, 12])
2024-09-15 01:07:41,347 - epoch:0, training loss:1300.6348 validation loss:16.0048
2024-09-15 01:07:44,268 - epoch:1, training loss:952.9784 validation loss:15.1824
2024-09-15 01:07:47,056 - epoch:2, training loss:931.1397 validation loss:15.1449
2024-09-15 01:07:50,148 - epoch:3, training loss:923.6420 validation loss:15.2005
2024-09-15 01:07:52,876 - epoch:4, training loss:916.4552 validation loss:14.9907
2024-09-15 01:07:55,723 - epoch:5, training loss:916.3610 validation loss:15.3681
2024-09-15 01:07:58,662 - epoch:6, training loss:910.4108 validation loss:15.0572
2024-09-15 01:08:01,401 - epoch:7, training loss:904.1096 validation loss:14.9972
2024-09-15 01:08:04,162 - epoch:8, training loss:913.7883 validation loss:15.3155
2024-09-15 01:08:07,029 - epoch:9, training loss:901.0652 validation loss:15.1290
2024-09-15 01:08:09,908 - epoch:10, training loss:900.4822 validation loss:15.1139
2024-09-15 01:08:11,152 - [*] loss:714.1061
2024-09-15 01:08:11,190 - [*] year 2015, testing
2024-09-15 01:08:11,496 - T:3	MAE	12.7133	RMSE	20.5996	MAPE	17.4665
2024-09-15 01:08:12,113 - T:6	MAE	13.9304	RMSE	22.9690	MAPE	18.9128
2024-09-15 01:08:13,920 - T:12	MAE	16.2466	RMSE	27.0088	MAPE	22.5598
2024-09-15 01:08:13,920 - T:Avg	MAE	14.0747	RMSE	23.1279	MAPE	19.3229
2024-09-15 01:08:13,921 - Finished optimization, total time:19.95 s, best model:log/PEMS/stkec-44/2015/14.9907.pkl
2024-09-15 01:08:13,947 - [*] Year 2016 load from data/PEMS/FastData/2016.npz
2024-09-15 01:08:13,952 - [*] load from log/PEMS/stkec-44/2015/14.9907.pkl
2024-09-15 01:08:13,961 - [*] detect strategy feature
2024-09-15 01:08:18,415 - number of increase nodes:85, nodes after 2 hop:torch.Size([283]), total nodes this year 850
2024-09-15 01:08:19,344 - [*] Year 2016 Dataset load!
2024-09-15 01:08:19,344 - [*] load from log/PEMS/stkec-44/2015/14.9907.pkl
2024-09-15 01:08:19,347 - [*] EWC! lambda 0.000500
2024-09-15 01:08:22,421 - [*] Year 2016 Training start
2024-09-15 01:08:23,665 - node number torch.Size([36224, 12])
2024-09-15 01:08:25,657 - epoch:0, training loss:1281.4677 validation loss:16.8749
2024-09-15 01:08:28,777 - epoch:1, training loss:963.0151 validation loss:16.5666
2024-09-15 01:08:31,781 - epoch:2, training loss:948.4230 validation loss:16.7006
2024-09-15 01:08:34,855 - epoch:3, training loss:944.0996 validation loss:16.4936
2024-09-15 01:08:37,834 - epoch:4, training loss:958.1465 validation loss:16.5501
2024-09-15 01:08:40,816 - epoch:5, training loss:947.9547 validation loss:16.6881
2024-09-15 01:08:43,798 - epoch:6, training loss:938.6245 validation loss:16.6936
2024-09-15 01:08:46,788 - epoch:7, training loss:937.1687 validation loss:17.4026
2024-09-15 01:08:49,741 - epoch:8, training loss:941.6235 validation loss:16.7144
2024-09-15 01:08:52,687 - epoch:9, training loss:936.3171 validation loss:16.9753
2024-09-15 01:08:53,930 - [*] loss:760.4026
2024-09-15 01:08:53,960 - [*] year 2016, testing
2024-09-15 01:08:54,262 - T:3	MAE	12.2683	RMSE	21.6743	MAPE	16.2674
2024-09-15 01:08:54,835 - T:6	MAE	13.3905	RMSE	23.9214	MAPE	17.7108
2024-09-15 01:08:56,558 - T:12	MAE	15.6450	RMSE	27.8227	MAPE	21.2688
2024-09-15 01:08:56,558 - T:Avg	MAE	13.5506	RMSE	24.0706	MAPE	18.0701
2024-09-15 01:08:56,559 - Finished optimization, total time:18.80 s, best model:log/PEMS/stkec-44/2016/16.4936.pkl
2024-09-15 01:08:56,589 - [*] Year 2017 load from data/PEMS/FastData/2017.npz
2024-09-15 01:08:56,596 - [*] load from log/PEMS/stkec-44/2016/16.4936.pkl
2024-09-15 01:08:56,606 - [*] detect strategy feature
2024-09-15 01:09:00,907 - number of increase nodes:85, nodes after 2 hop:torch.Size([291]), total nodes this year 871
2024-09-15 01:09:01,850 - [*] Year 2017 Dataset load!
2024-09-15 01:09:01,850 - [*] load from log/PEMS/stkec-44/2016/16.4936.pkl
2024-09-15 01:09:01,853 - [*] EWC! lambda 0.000500
2024-09-15 01:09:04,903 - [*] Year 2017 Training start
2024-09-15 01:09:06,020 - node number torch.Size([37248, 12])
2024-09-15 01:09:08,099 - epoch:0, training loss:1386.2336 validation loss:17.1694
2024-09-15 01:09:11,313 - epoch:1, training loss:1094.3104 validation loss:17.1859
2024-09-15 01:09:14,549 - epoch:2, training loss:1076.1654 validation loss:16.9304
2024-09-15 01:09:17,617 - epoch:3, training loss:1073.1415 validation loss:17.0113
2024-09-15 01:09:20,686 - epoch:4, training loss:1073.1849 validation loss:16.7486
2024-09-15 01:09:23,734 - epoch:5, training loss:1069.8090 validation loss:16.7804
2024-09-15 01:09:26,696 - epoch:6, training loss:1071.3350 validation loss:16.9664
2024-09-15 01:09:29,723 - epoch:7, training loss:1074.2430 validation loss:17.2676
2024-09-15 01:09:32,836 - epoch:8, training loss:1072.9291 validation loss:16.6842
2024-09-15 01:09:35,949 - epoch:9, training loss:1074.6066 validation loss:16.7297
2024-09-15 01:09:38,961 - epoch:10, training loss:1085.0968 validation loss:17.0759
2024-09-15 01:09:41,906 - epoch:11, training loss:1067.7889 validation loss:16.8486
2024-09-15 01:09:44,893 - epoch:12, training loss:1067.8365 validation loss:16.6801
2024-09-15 01:09:47,938 - epoch:13, training loss:1074.4484 validation loss:16.8924
2024-09-15 01:09:50,872 - epoch:14, training loss:1070.6337 validation loss:17.3228
2024-09-15 01:09:53,958 - epoch:15, training loss:1070.9085 validation loss:17.2856
2024-09-15 01:09:56,933 - epoch:16, training loss:1072.8544 validation loss:16.8372
2024-09-15 01:09:59,912 - epoch:17, training loss:1072.1844 validation loss:17.8267
2024-09-15 01:10:02,975 - epoch:18, training loss:1084.1201 validation loss:17.1151
2024-09-15 01:10:04,265 - [*] loss:786.5654
2024-09-15 01:10:04,299 - [*] year 2017, testing
2024-09-15 01:10:04,599 - T:3	MAE	13.4329	RMSE	22.1285	MAPE	16.8892
2024-09-15 01:10:05,152 - T:6	MAE	14.6502	RMSE	24.3068	MAPE	18.1316
2024-09-15 01:10:06,885 - T:12	MAE	17.0487	RMSE	28.2962	MAPE	20.8882
2024-09-15 01:10:06,885 - T:Avg	MAE	14.8133	RMSE	24.5228	MAPE	18.3722
2024-09-15 01:10:06,886 - Finished optimization, total time:36.02 s, best model:log/PEMS/stkec-44/2017/16.6801.pkl
2024-09-15 01:10:06,896 - 


2024-09-15 01:10:06,896 - 3   	 MAE	     12.95	     12.98	     12.45	     13.33	     12.71	     12.27	     13.43		   12.87
2024-09-15 01:10:06,896 - 3   	RMSE	     19.69	     19.91	     19.78	     21.46	     20.60	     21.67	     22.13		   20.75
2024-09-15 01:10:06,896 - 3   	MAPE	     18.61	     20.80	     18.26	     17.53	     17.47	     16.27	     16.89		   17.98
2024-09-15 01:10:06,896 - 6   	 MAE	     13.95	     14.03	     13.61	     14.47	     13.93	     13.39	     14.65		   14.00
2024-09-15 01:10:06,896 - 6   	RMSE	     21.43	     21.79	     21.92	     23.56	     22.97	     23.92	     24.31		   22.84
2024-09-15 01:10:06,896 - 6   	MAPE	     19.79	     22.31	     19.50	     18.54	     18.91	     17.71	     18.13		   19.27
2024-09-15 01:10:06,896 - 12  	 MAE	     16.05	     16.16	     15.99	     16.93	     16.25	     15.65	     17.05		   16.30
2024-09-15 01:10:06,897 - 12  	RMSE	     25.00	     25.54	     26.13	     27.87	     27.01	     27.82	     28.30		   26.81
2024-09-15 01:10:06,897 - 12  	MAPE	     23.01	     25.71	     22.16	     20.98	     22.56	     21.27	     20.89		   22.37
2024-09-15 01:10:06,897 - Avg 	 MAE	     14.11	     14.19	     13.79	     14.68	     14.07	     13.55	     14.81		   14.17
2024-09-15 01:10:06,897 - Avg 	RMSE	     21.68	     22.06	     22.21	     23.87	     23.13	     24.07	     24.52		   23.08
2024-09-15 01:10:06,897 - Avg 	MAPE	     20.14	     22.64	     19.74	     18.77	     19.32	     18.07	     18.37		   19.58
2024-09-15 01:10:06,897 - year	2011	total_time	   75.4596	average_time	    2.4342	epoch	31
2024-09-15 01:10:06,897 - year	2012	total_time	   44.2271	average_time	    1.7011	epoch	26
2024-09-15 01:10:06,897 - year	2013	total_time	   39.3921	average_time	    1.6414	epoch	24
2024-09-15 01:10:06,897 - year	2014	total_time	   23.8703	average_time	    1.8362	epoch	13
2024-09-15 01:10:06,897 - year	2015	total_time	   19.9486	average_time	    1.8135	epoch	11
2024-09-15 01:10:06,897 - year	2016	total_time	   18.8021	average_time	    1.8802	epoch	10
2024-09-15 01:10:06,897 - year	2017	total_time	   36.0157	average_time	    1.8956	epoch	19
2024-09-15 01:10:06,897 - total time: 257.7156
2025-05-09 13:29:18,350 - logger name:log/PEMS/stkec-44/stkec.log
2025-05-09 13:29:18,350 - params : {'conf': 'conf/PEMS/stkec.json', 'seed': 44, 'paral': 0, 'gpuid': 1, 'logname': 'stkec', 'method': 'STKEC', 'load_first_year': 0, 'first_year_model_path': 'log/PEMS3/trafficStream-42/2011/16.6936.pkl', 'device': device(type='cuda', index=1), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>}, 'begin_year': 2011, 'end_year': 2017, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 1, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'influe_length': 168, 'data_process': 0, 'batch_influ_size': 4, 'beita': 1, 'cluster': 24, 'raw_data_path': '/data/weichen/TrafficStream_data/PEMS/RawData/', 'save_data_path': '/data/weichen/TrafficStream_data/PEMS/FastData/', 'graph_path': '/data/weichen/TrafficStream_data/PEMS/graph/', 'model_path': 'log/PEMS/', 'influence_path': "Pleaseenter'outdir'inyourpath", 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'init': True, 'train': 0, 'auto_test': 1, 'strategy': 'incremental', 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'detect_infl_strategy': True, 'infl_topk': 10, 'adp_adj': False, 'skip_dim': 64, 'end_dim': 64, 'hidden_channels': 32, 'dilation_channels': 64, 'residual_channels': 64, 'input_dim': 1, 'output_dim': 1, 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0005, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'path': 'log/PEMS/stkec-44', 'logger': <Logger utils.initialize (INFO)>}
2025-05-09 13:29:18,363 - [*] Year 2011 load from /data/weichen/TrafficStream_data/PEMS/FastData/2011.npz
2025-05-09 13:29:19,186 - [*] load from log/PEMS/stkec-44/2011/16.2389.pkl
2025-05-09 13:30:16,844 - [*] year 2011, testing
2025-05-09 13:30:17,337 - T:3	MAE	12.8293	RMSE	19.5292	MAPE	18.2607
2025-05-09 13:30:18,129 - T:6	MAE	13.8143	RMSE	21.2556	MAPE	19.4200
2025-05-09 13:30:20,245 - T:12	MAE	15.9065	RMSE	24.8016	MAPE	22.5749
2025-05-09 13:30:20,245 - T:Avg	MAE	13.9818	RMSE	21.5124	MAPE	19.7658
2025-05-09 13:30:20,261 - [*] Year 2012 load from /data/weichen/TrafficStream_data/PEMS/FastData/2012.npz
2025-05-09 13:30:20,268 - [*] load from log/PEMS/stkec-44/2011/16.2389.pkl
2025-05-09 13:30:20,292 - [*] detect strategy feature
2025-05-09 13:30:23,939 - number of increase nodes:78, nodes after 2 hop:torch.Size([238]), total nodes this year 715
2025-05-09 13:34:35,312 - [*] load from log/PEMS/stkec-44/2012/14.4361.pkl
2025-05-09 13:35:27,376 - [*] year 2012, testing
2025-05-09 13:35:27,867 - T:3	MAE	12.4481	RMSE	19.2757	MAPE	19.9603
2025-05-09 13:35:28,765 - T:6	MAE	13.5024	RMSE	21.1468	MAPE	21.4519
2025-05-09 13:35:31,217 - T:12	MAE	15.6810	RMSE	24.9219	MAPE	24.8243
2025-05-09 13:35:31,218 - T:Avg	MAE	13.6743	RMSE	21.4253	MAPE	21.7776
2025-05-09 13:35:31,237 - [*] Year 2013 load from /data/weichen/TrafficStream_data/PEMS/FastData/2013.npz
2025-05-09 13:35:31,248 - [*] load from log/PEMS/stkec-44/2012/14.4361.pkl
2025-05-09 13:35:31,273 - [*] detect strategy feature
2025-05-09 13:35:35,175 - number of increase nodes:91, nodes after 2 hop:torch.Size([214]), total nodes this year 786
2025-05-09 13:35:35,175 - [*] load from log/PEMS/stkec-44/2013/13.5769.pkl
2025-05-09 13:36:26,467 - [*] year 2013, testing
2025-05-09 13:36:26,906 - T:3	MAE	12.3475	RMSE	19.6822	MAPE	17.7843
2025-05-09 13:36:27,791 - T:6	MAE	13.5102	RMSE	21.8085	MAPE	19.0089
2025-05-09 13:36:30,452 - T:12	MAE	15.8903	RMSE	25.9948	MAPE	21.6396
2025-05-09 13:36:30,452 - T:Avg	MAE	13.6909	RMSE	22.0884	MAPE	19.2460
2025-05-09 13:36:30,471 - [*] Year 2014 load from /data/weichen/TrafficStream_data/PEMS/FastData/2014.npz
2025-05-09 13:36:30,476 - [*] load from log/PEMS/stkec-44/2013/13.5769.pkl
2025-05-09 13:36:30,504 - [*] detect strategy feature
2025-05-09 13:36:34,857 - number of increase nodes:82, nodes after 2 hop:torch.Size([280]), total nodes this year 822
2025-05-09 13:36:34,857 - [*] load from log/PEMS/stkec-44/2014/14.9371.pkl
2025-05-09 13:37:14,823 - [*] year 2014, testing
2025-05-09 13:37:15,219 - T:3	MAE	13.1072	RMSE	20.9606	MAPE	17.4547
2025-05-09 13:37:16,027 - T:6	MAE	14.2236	RMSE	23.0042	MAPE	18.4667
2025-05-09 13:37:18,522 - T:12	MAE	16.6197	RMSE	27.1985	MAPE	20.9023
2025-05-09 13:37:18,522 - T:Avg	MAE	14.4197	RMSE	23.3046	MAPE	18.6947
2025-05-09 13:37:18,540 - [*] Year 2015 load from /data/weichen/TrafficStream_data/PEMS/FastData/2015.npz
2025-05-09 13:37:18,544 - [*] load from log/PEMS/stkec-44/2014/14.9371.pkl
2025-05-09 13:37:18,558 - [*] detect strategy feature
2025-05-09 13:37:22,898 - number of increase nodes:82, nodes after 2 hop:torch.Size([288]), total nodes this year 834
2025-05-09 13:37:22,898 - [*] load from log/PEMS/stkec-44/2015/14.9907.pkl
2025-05-09 13:37:45,857 - [*] year 2015, testing
2025-05-09 13:37:46,221 - T:3	MAE	12.6863	RMSE	20.5005	MAPE	17.2606
2025-05-09 13:37:46,987 - T:6	MAE	13.8739	RMSE	22.8051	MAPE	18.6665
2025-05-09 13:37:49,090 - T:12	MAE	16.1285	RMSE	26.7346	MAPE	22.2003
2025-05-09 13:37:49,090 - T:Avg	MAE	14.0129	RMSE	22.9581	MAPE	19.0613
2025-05-09 13:37:49,108 - [*] Year 2016 load from /data/weichen/TrafficStream_data/PEMS/FastData/2016.npz
2025-05-09 13:37:49,114 - [*] load from log/PEMS/stkec-44/2015/14.9907.pkl
2025-05-09 13:37:49,125 - [*] detect strategy feature
2025-05-09 13:37:53,060 - number of increase nodes:85, nodes after 2 hop:torch.Size([283]), total nodes this year 850
2025-05-09 13:37:53,060 - [*] load from log/PEMS/stkec-44/2016/16.4936.pkl
2025-05-09 13:38:17,439 - [*] year 2016, testing
2025-05-09 13:38:17,819 - T:3	MAE	12.1365	RMSE	21.5423	MAPE	15.9511
2025-05-09 13:38:18,569 - T:6	MAE	13.2720	RMSE	23.8041	MAPE	17.3582
2025-05-09 13:38:20,867 - T:12	MAE	15.5420	RMSE	27.7208	MAPE	20.8212
2025-05-09 13:38:20,867 - T:Avg	MAE	13.4321	RMSE	23.9525	MAPE	17.7061
2025-05-09 13:38:20,887 - [*] Year 2017 load from /data/weichen/TrafficStream_data/PEMS/FastData/2017.npz
2025-05-09 13:38:20,896 - [*] load from log/PEMS/stkec-44/2016/16.4936.pkl
2025-05-09 13:38:20,911 - [*] detect strategy feature
2025-05-09 13:38:24,954 - number of increase nodes:85, nodes after 2 hop:torch.Size([291]), total nodes this year 871
2025-05-09 13:38:24,954 - [*] load from log/PEMS/stkec-44/2017/16.6801.pkl
2025-05-09 13:38:48,660 - [*] year 2017, testing
2025-05-09 13:38:49,041 - T:3	MAE	13.3883	RMSE	22.0560	MAPE	16.7039
2025-05-09 13:38:49,809 - T:6	MAE	14.5950	RMSE	24.2082	MAPE	17.9357
2025-05-09 13:38:51,969 - T:12	MAE	16.9680	RMSE	28.1456	MAPE	20.6441
2025-05-09 13:38:51,970 - T:Avg	MAE	14.7555	RMSE	24.4191	MAPE	18.1678
2025-05-09 13:38:51,972 - 


2025-05-09 13:38:51,972 - 3   	 MAE	     12.83	     12.45	     12.35	     13.11	     12.69	     12.14	     13.39		   12.71
2025-05-09 13:38:51,972 - 3   	RMSE	     19.53	     19.28	     19.68	     20.96	     20.50	     21.54	     22.06		   20.51
2025-05-09 13:38:51,972 - 3   	MAPE	     18.26	     19.96	     17.78	     17.45	     17.26	     15.95	     16.70		   17.63
2025-05-09 13:38:51,972 - 6   	 MAE	     13.81	     13.50	     13.51	     14.22	     13.87	     13.27	     14.60		   13.83
2025-05-09 13:38:51,972 - 6   	RMSE	     21.26	     21.15	     21.81	     23.00	     22.81	     23.80	     24.21		   22.58
2025-05-09 13:38:51,972 - 6   	MAPE	     19.42	     21.45	     19.01	     18.47	     18.67	     17.36	     17.94		   18.90
2025-05-09 13:38:51,972 - 12  	 MAE	     15.91	     15.68	     15.89	     16.62	     16.13	     15.54	     16.97		   16.11
2025-05-09 13:38:51,972 - 12  	RMSE	     24.80	     24.92	     25.99	     27.20	     26.73	     27.72	     28.15		   26.50
2025-05-09 13:38:51,973 - 12  	MAPE	     22.57	     24.82	     21.64	     20.90	     22.20	     20.82	     20.64		   21.94
2025-05-09 13:38:51,973 - Avg 	 MAE	     13.98	     13.67	     13.69	     14.42	     14.01	     13.43	     14.76		   14.00
2025-05-09 13:38:51,973 - Avg 	RMSE	     21.51	     21.43	     22.09	     23.30	     22.96	     23.95	     24.42		   22.81
2025-05-09 13:38:51,973 - Avg 	MAPE	     19.77	     21.78	     19.25	     18.69	     19.06	     17.71	     18.17		   19.20
2025-05-09 13:38:51,973 - total time: 0.0000
