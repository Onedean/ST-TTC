2024-09-12 22:07:28,530 - logger name:log/PEMS/trafficstream-44/trafficstream.log
2024-09-12 22:07:28,530 - params : {'conf': 'new_conf/PEMS/trafficstream.json', 'seed': 44, 'paral': 0, 'gpuid': 2, 'logname': 'trafficstream', 'method': 'TrafficStream', 'load_first_year': 0, 'first_year_model_path': 'log/PEMS/trafficstream-42/2011/16.6936.pkl', 'device': device(type='cuda', index=2), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'LSTM': <class 'src.model.model.LSTM_Model'>, 'MLP': <class 'src.model.model.MLP_Model'>, 'STLora': <class 'src.model.model.STLora_Model'>, 'STEmb': <class 'src.model.model.STEmb_Model'>}, 'begin_year': 2011, 'end_year': 2017, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'raw_data_path': 'data/PEMS/RawData/', 'save_data_path': 'data/PEMS/FastData/', 'graph_path': 'data/PEMS/graph/', 'model_path': 'log/PEMS/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'init': True, 'train': 1, 'auto_test': 0, 'strategy': 'incremental', 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'inforeplay', 'path': 'log/PEMS/trafficstream-44', 'logger': <Logger utils.initialize (INFO)>}
2024-09-12 22:07:28,542 - [*] Year 2011 load from data/PEMS/FastData/2011.npz
2024-09-12 22:07:29,215 - [*] Year 2011 Dataset load!
2024-09-12 22:07:29,217 - [*] Year 2011 Training start
2024-09-12 22:07:30,114 - node number torch.Size([83840, 12])
2024-09-12 22:07:32,756 - epoch:0, training loss:19934.8797 validation loss:60.5865
2024-09-12 22:07:35,539 - epoch:1, training loss:3165.7956 validation loss:27.1779
2024-09-12 22:07:38,380 - epoch:2, training loss:1317.5097 validation loss:21.4478
2024-09-12 22:07:41,265 - epoch:3, training loss:1007.6163 validation loss:19.4107
2024-09-12 22:07:44,069 - epoch:4, training loss:903.1004 validation loss:18.8254
2024-09-12 22:07:46,890 - epoch:5, training loss:860.0261 validation loss:18.5768
2024-09-12 22:07:49,687 - epoch:6, training loss:837.4176 validation loss:18.7197
2024-09-12 22:07:52,516 - epoch:7, training loss:819.8547 validation loss:18.2651
2024-09-12 22:07:55,298 - epoch:8, training loss:803.1238 validation loss:17.9851
2024-09-12 22:07:58,166 - epoch:9, training loss:790.3675 validation loss:17.8541
2024-09-12 22:08:00,947 - epoch:10, training loss:780.8418 validation loss:18.0495
2024-09-12 22:08:03,770 - epoch:11, training loss:764.8578 validation loss:17.6797
2024-09-12 22:08:06,725 - epoch:12, training loss:751.3069 validation loss:17.5141
2024-09-12 22:08:09,609 - epoch:13, training loss:747.0926 validation loss:17.5330
2024-09-12 22:08:12,697 - epoch:14, training loss:734.3110 validation loss:17.1884
2024-09-12 22:08:15,471 - epoch:15, training loss:730.2005 validation loss:17.3989
2024-09-12 22:08:18,309 - epoch:16, training loss:724.4915 validation loss:17.0049
2024-09-12 22:08:21,121 - epoch:17, training loss:719.6084 validation loss:17.4552
2024-09-12 22:08:23,929 - epoch:18, training loss:708.8253 validation loss:16.8661
2024-09-12 22:08:26,758 - epoch:19, training loss:702.2475 validation loss:17.1792
2024-09-12 22:08:29,596 - epoch:20, training loss:703.4832 validation loss:16.7377
2024-09-12 22:08:32,349 - epoch:21, training loss:695.4387 validation loss:16.7413
2024-09-12 22:08:35,151 - epoch:22, training loss:690.1524 validation loss:16.6427
2024-09-12 22:08:37,935 - epoch:23, training loss:692.9672 validation loss:16.7528
2024-09-12 22:08:40,715 - epoch:24, training loss:691.3351 validation loss:16.6706
2024-09-12 22:08:43,593 - epoch:25, training loss:684.6955 validation loss:16.5226
2024-09-12 22:08:46,358 - epoch:26, training loss:682.0220 validation loss:16.6373
2024-09-12 22:08:49,139 - epoch:27, training loss:684.2578 validation loss:16.8307
2024-09-12 22:08:51,977 - epoch:28, training loss:680.5209 validation loss:16.5116
2024-09-12 22:08:54,771 - epoch:29, training loss:690.9559 validation loss:16.4903
2024-09-12 22:08:57,643 - epoch:30, training loss:679.5045 validation loss:16.4568
2024-09-12 22:09:00,444 - epoch:31, training loss:671.8562 validation loss:16.3593
2024-09-12 22:09:03,281 - epoch:32, training loss:671.8376 validation loss:16.4170
2024-09-12 22:09:06,119 - epoch:33, training loss:676.4609 validation loss:16.6069
2024-09-12 22:09:08,936 - epoch:34, training loss:668.6366 validation loss:16.4050
2024-09-12 22:09:11,710 - epoch:35, training loss:666.0592 validation loss:16.5621
2024-09-12 22:09:14,522 - epoch:36, training loss:678.9428 validation loss:16.7080
2024-09-12 22:09:17,330 - epoch:37, training loss:670.8544 validation loss:16.3987
2024-09-12 22:09:18,177 - [*] loss:623.7260
2024-09-12 22:09:18,199 - [*] year 2011, testing
2024-09-12 22:09:18,469 - T:3	MAE	12.9262	RMSE	19.6996	MAPE	17.0545
2024-09-12 22:09:18,950 - T:6	MAE	13.9789	RMSE	21.5311	MAPE	18.4902
2024-09-12 22:09:20,399 - T:12	MAE	16.1217	RMSE	25.1861	MAPE	21.8051
2024-09-12 22:09:20,400 - T:Avg	MAE	14.1449	RMSE	21.7931	MAPE	18.8397
2024-09-12 22:09:20,401 - Finished optimization, total time:74.27 s, best model:log/PEMS/trafficstream-44/2011/16.3593.pkl
2024-09-12 22:09:20,417 - [*] Year 2012 load from data/PEMS/FastData/2012.npz
2024-09-12 22:09:20,425 - [*] load from log/PEMS/trafficstream-44/2011/16.3593.pkl
2024-09-12 22:09:23,577 - number of increase nodes:129, nodes after 2 hop:torch.Size([314]), total nodes this year 715
2024-09-12 22:09:24,382 - [*] Year 2012 Dataset load!
2024-09-12 22:09:24,382 - [*] load from log/PEMS/trafficstream-44/2011/16.3593.pkl
2024-09-12 22:09:24,385 - [*] EWC! lambda 0.000100
2024-09-12 22:09:27,058 - [*] Year 2012 Training start
2024-09-12 22:09:27,989 - node number torch.Size([40192, 12])
2024-09-12 22:09:30,125 - epoch:0, training loss:956.9491 validation loss:17.8297
2024-09-12 22:09:32,893 - epoch:1, training loss:873.8598 validation loss:17.8245
2024-09-12 22:09:35,565 - epoch:2, training loss:872.6502 validation loss:17.8579
2024-09-12 22:09:38,323 - epoch:3, training loss:867.7408 validation loss:17.8173
2024-09-12 22:09:41,131 - epoch:4, training loss:870.0838 validation loss:17.8143
2024-09-12 22:09:43,861 - epoch:5, training loss:866.1719 validation loss:17.6973
2024-09-12 22:09:46,533 - epoch:6, training loss:859.9652 validation loss:17.6561
2024-09-12 22:09:49,181 - epoch:7, training loss:859.3888 validation loss:17.6874
2024-09-12 22:09:51,957 - epoch:8, training loss:853.8408 validation loss:17.6826
2024-09-12 22:09:54,721 - epoch:9, training loss:858.0183 validation loss:17.6719
2024-09-12 22:09:57,440 - epoch:10, training loss:857.2299 validation loss:18.9841
2024-09-12 22:10:00,145 - epoch:11, training loss:874.9702 validation loss:18.3218
2024-09-12 22:10:02,849 - epoch:12, training loss:851.6788 validation loss:17.5644
2024-09-12 22:10:05,617 - epoch:13, training loss:847.7459 validation loss:17.8935
2024-09-12 22:10:08,315 - epoch:14, training loss:851.4048 validation loss:17.5918
2024-09-12 22:10:11,012 - epoch:15, training loss:852.5436 validation loss:17.7042
2024-09-12 22:10:13,664 - epoch:16, training loss:849.8637 validation loss:17.7702
2024-09-12 22:10:16,307 - epoch:17, training loss:850.3305 validation loss:17.7313
2024-09-12 22:10:19,043 - epoch:18, training loss:853.5083 validation loss:17.5323
2024-09-12 22:10:21,852 - epoch:19, training loss:858.9362 validation loss:17.5361
2024-09-12 22:10:24,576 - epoch:20, training loss:850.9744 validation loss:17.5877
2024-09-12 22:10:27,323 - epoch:21, training loss:841.2282 validation loss:17.5572
2024-09-12 22:10:30,125 - epoch:22, training loss:858.4638 validation loss:17.5093
2024-09-12 22:10:32,793 - epoch:23, training loss:841.1259 validation loss:17.4954
2024-09-12 22:10:35,572 - epoch:24, training loss:838.0027 validation loss:17.6489
2024-09-12 22:10:38,491 - epoch:25, training loss:837.5903 validation loss:17.4718
2024-09-12 22:10:41,343 - epoch:26, training loss:833.6693 validation loss:17.4010
2024-09-12 22:10:44,337 - epoch:27, training loss:830.4347 validation loss:17.3325
2024-09-12 22:10:47,219 - epoch:28, training loss:837.0872 validation loss:17.3348
2024-09-12 22:10:50,094 - epoch:29, training loss:838.0475 validation loss:17.3900
2024-09-12 22:10:52,863 - epoch:30, training loss:841.2453 validation loss:17.8074
2024-09-12 22:10:55,653 - epoch:31, training loss:862.2687 validation loss:17.4273
2024-09-12 22:10:58,449 - epoch:32, training loss:828.0451 validation loss:17.3983
2024-09-12 22:11:01,289 - epoch:33, training loss:831.3391 validation loss:17.4424
2024-09-12 22:11:02,370 - [*] loss:625.6551
2024-09-12 22:11:02,394 - [*] year 2012, testing
2024-09-12 22:11:02,636 - T:3	MAE	12.6802	RMSE	19.6442	MAPE	17.7281
2024-09-12 22:11:03,099 - T:6	MAE	13.6424	RMSE	21.3736	MAPE	19.0480
2024-09-12 22:11:04,530 - T:12	MAE	15.8089	RMSE	25.2262	MAPE	22.9944
2024-09-12 22:11:04,530 - T:Avg	MAE	13.8551	RMSE	21.7387	MAPE	19.5898
2024-09-12 22:11:04,531 - Finished optimization, total time:60.24 s, best model:log/PEMS/trafficstream-44/2012/17.3325.pkl
2024-09-12 22:11:04,558 - [*] Year 2013 load from data/PEMS/FastData/2013.npz
2024-09-12 22:11:04,571 - [*] load from log/PEMS/trafficstream-44/2012/17.3325.pkl
2024-09-12 22:11:08,229 - number of increase nodes:149, nodes after 2 hop:torch.Size([349]), total nodes this year 786
2024-09-12 22:11:09,059 - [*] Year 2013 Dataset load!
2024-09-12 22:11:09,059 - [*] load from log/PEMS/trafficstream-44/2012/17.3325.pkl
2024-09-12 22:11:09,062 - [*] EWC! lambda 0.000100
2024-09-12 22:11:11,646 - [*] Year 2013 Training start
2024-09-12 22:11:12,622 - node number torch.Size([44672, 12])
2024-09-12 22:11:14,565 - epoch:0, training loss:738.4777 validation loss:16.9533
2024-09-12 22:11:17,317 - epoch:1, training loss:675.9785 validation loss:16.7345
2024-09-12 22:11:20,048 - epoch:2, training loss:673.1140 validation loss:16.7846
2024-09-12 22:11:22,810 - epoch:3, training loss:671.0727 validation loss:16.5974
2024-09-12 22:11:25,640 - epoch:4, training loss:675.5982 validation loss:16.7281
2024-09-12 22:11:28,406 - epoch:5, training loss:668.0836 validation loss:16.4823
2024-09-12 22:11:31,211 - epoch:6, training loss:671.0152 validation loss:16.2121
2024-09-12 22:11:34,037 - epoch:7, training loss:670.3022 validation loss:16.4153
2024-09-12 22:11:36,888 - epoch:8, training loss:670.2205 validation loss:16.2119
2024-09-12 22:11:39,655 - epoch:9, training loss:662.5579 validation loss:16.4619
2024-09-12 22:11:42,423 - epoch:10, training loss:662.0469 validation loss:16.7729
2024-09-12 22:11:45,197 - epoch:11, training loss:661.7775 validation loss:16.4303
2024-09-12 22:11:48,036 - epoch:12, training loss:674.1544 validation loss:16.2947
2024-09-12 22:11:50,852 - epoch:13, training loss:669.5721 validation loss:16.8404
2024-09-12 22:11:53,678 - epoch:14, training loss:656.7107 validation loss:16.9123
2024-09-12 22:11:54,801 - [*] loss:660.6979
2024-09-12 22:11:54,831 - [*] year 2013, testing
2024-09-12 22:11:55,116 - T:3	MAE	12.3471	RMSE	19.6263	MAPE	18.2458
2024-09-12 22:11:55,679 - T:6	MAE	13.5274	RMSE	21.7525	MAPE	19.9678
2024-09-12 22:11:57,439 - T:12	MAE	15.9331	RMSE	25.9105	MAPE	24.0145
2024-09-12 22:11:57,440 - T:Avg	MAE	13.7064	RMSE	22.0233	MAPE	20.3713
2024-09-12 22:11:57,441 - Finished optimization, total time:27.12 s, best model:log/PEMS/trafficstream-44/2013/16.2119.pkl
2024-09-12 22:11:57,464 - [*] Year 2014 load from data/PEMS/FastData/2014.npz
2024-09-12 22:11:57,472 - [*] load from log/PEMS/trafficstream-44/2013/16.2119.pkl
2024-09-12 22:12:01,215 - number of increase nodes:117, nodes after 2 hop:torch.Size([348]), total nodes this year 822
2024-09-12 22:12:02,067 - [*] Year 2014 Dataset load!
2024-09-12 22:12:02,067 - [*] load from log/PEMS/trafficstream-44/2013/16.2119.pkl
2024-09-12 22:12:02,070 - [*] EWC! lambda 0.000100
2024-09-12 22:12:04,731 - [*] Year 2014 Training start
2024-09-12 22:12:05,716 - node number torch.Size([44544, 12])
2024-09-12 22:12:07,681 - epoch:0, training loss:1171.0675 validation loss:19.3421
2024-09-12 22:12:10,557 - epoch:1, training loss:1093.3354 validation loss:19.4229
2024-09-12 22:12:13,404 - epoch:2, training loss:1080.2817 validation loss:19.1589
2024-09-12 22:12:16,311 - epoch:3, training loss:1071.0721 validation loss:19.1955
2024-09-12 22:12:19,153 - epoch:4, training loss:1064.2109 validation loss:19.0629
2024-09-12 22:12:22,027 - epoch:5, training loss:1065.3253 validation loss:19.2487
2024-09-12 22:12:24,868 - epoch:6, training loss:1054.2640 validation loss:19.1517
2024-09-12 22:12:27,739 - epoch:7, training loss:1050.7653 validation loss:19.1191
2024-09-12 22:12:30,535 - epoch:8, training loss:1052.9792 validation loss:19.0686
2024-09-12 22:12:33,409 - epoch:9, training loss:1045.1581 validation loss:19.0891
2024-09-12 22:12:36,275 - epoch:10, training loss:1061.4276 validation loss:19.0216
2024-09-12 22:12:39,191 - epoch:11, training loss:1045.9750 validation loss:19.7451
2024-09-12 22:12:42,087 - epoch:12, training loss:1044.6080 validation loss:19.2355
2024-09-12 22:12:44,953 - epoch:13, training loss:1040.7693 validation loss:19.1878
2024-09-12 22:12:47,737 - epoch:14, training loss:1035.9297 validation loss:18.9841
2024-09-12 22:12:50,519 - epoch:15, training loss:1036.3356 validation loss:18.9559
2024-09-12 22:12:53,385 - epoch:16, training loss:1031.0633 validation loss:19.2571
2024-09-12 22:12:56,205 - epoch:17, training loss:1029.1119 validation loss:19.1909
2024-09-12 22:12:59,048 - epoch:18, training loss:1029.3231 validation loss:19.0596
2024-09-12 22:13:01,903 - epoch:19, training loss:1033.4246 validation loss:19.0350
2024-09-12 22:13:04,715 - epoch:20, training loss:1023.1090 validation loss:18.8578
2024-09-12 22:13:07,477 - epoch:21, training loss:1022.3067 validation loss:18.9977
2024-09-12 22:13:10,312 - epoch:22, training loss:1020.8658 validation loss:19.1834
2024-09-12 22:13:13,117 - epoch:23, training loss:1015.5053 validation loss:18.8772
2024-09-12 22:13:15,991 - epoch:24, training loss:1023.1155 validation loss:19.0102
2024-09-12 22:13:18,802 - epoch:25, training loss:1022.4274 validation loss:18.8901
2024-09-12 22:13:21,618 - epoch:26, training loss:1016.1773 validation loss:18.7680
2024-09-12 22:13:24,461 - epoch:27, training loss:1013.0831 validation loss:19.0184
2024-09-12 22:13:27,302 - epoch:28, training loss:1020.7066 validation loss:18.7948
2024-09-12 22:13:30,091 - epoch:29, training loss:1011.0495 validation loss:18.7858
2024-09-12 22:13:32,909 - epoch:30, training loss:1011.6329 validation loss:18.9253
2024-09-12 22:13:36,074 - epoch:31, training loss:1009.9146 validation loss:18.9885
2024-09-12 22:13:38,944 - epoch:32, training loss:1009.9557 validation loss:18.7304
2024-09-12 22:13:41,923 - epoch:33, training loss:1006.2815 validation loss:18.8484
2024-09-12 22:13:44,781 - epoch:34, training loss:1000.8809 validation loss:18.7805
2024-09-12 22:13:47,633 - epoch:35, training loss:1021.7881 validation loss:19.2168
2024-09-12 22:13:50,492 - epoch:36, training loss:1007.1805 validation loss:18.8188
2024-09-12 22:13:53,363 - epoch:37, training loss:997.1246 validation loss:18.6651
2024-09-12 22:13:56,220 - epoch:38, training loss:999.5021 validation loss:18.7747
2024-09-12 22:13:59,054 - epoch:39, training loss:1001.0975 validation loss:18.8936
2024-09-12 22:14:01,943 - epoch:40, training loss:999.3444 validation loss:18.6566
2024-09-12 22:14:04,719 - epoch:41, training loss:1009.3871 validation loss:18.6908
2024-09-12 22:14:07,570 - epoch:42, training loss:1022.3274 validation loss:19.0429
2024-09-12 22:14:10,434 - epoch:43, training loss:1006.7664 validation loss:19.2321
2024-09-12 22:14:13,239 - epoch:44, training loss:995.4292 validation loss:18.7519
2024-09-12 22:14:16,039 - epoch:45, training loss:997.6414 validation loss:18.8569
2024-09-12 22:14:18,872 - epoch:46, training loss:988.7488 validation loss:18.7070
2024-09-12 22:14:19,992 - [*] loss:733.4050
2024-09-12 22:14:20,015 - [*] year 2014, testing
2024-09-12 22:14:20,294 - T:3	MAE	13.2504	RMSE	21.3932	MAPE	17.1125
2024-09-12 22:14:20,792 - T:6	MAE	14.3916	RMSE	23.4198	MAPE	18.1935
2024-09-12 22:14:22,401 - T:12	MAE	16.7009	RMSE	27.3812	MAPE	21.4146
2024-09-12 22:14:22,401 - T:Avg	MAE	14.5649	RMSE	23.6821	MAPE	18.5765
2024-09-12 22:14:22,403 - Finished optimization, total time:86.27 s, best model:log/PEMS/trafficstream-44/2014/18.6566.pkl
2024-09-12 22:14:22,436 - [*] Year 2015 load from data/PEMS/FastData/2015.npz
2024-09-12 22:14:22,446 - [*] load from log/PEMS/trafficstream-44/2014/18.6566.pkl
2024-09-12 22:14:26,291 - number of increase nodes:94, nodes after 2 hop:torch.Size([240]), total nodes this year 834
2024-09-12 22:14:27,125 - [*] Year 2015 Dataset load!
2024-09-12 22:14:27,125 - [*] load from log/PEMS/trafficstream-44/2014/18.6566.pkl
2024-09-12 22:14:27,128 - [*] EWC! lambda 0.000100
2024-09-12 22:14:29,812 - [*] Year 2015 Training start
2024-09-12 22:14:30,856 - node number torch.Size([30720, 12])
2024-09-12 22:14:32,578 - epoch:0, training loss:811.1837 validation loss:13.4775
2024-09-12 22:14:35,077 - epoch:1, training loss:766.2543 validation loss:13.4358
2024-09-12 22:14:37,654 - epoch:2, training loss:757.8233 validation loss:13.2411
2024-09-12 22:14:40,250 - epoch:3, training loss:745.3513 validation loss:13.2846
2024-09-12 22:14:42,803 - epoch:4, training loss:738.1819 validation loss:13.4774
2024-09-12 22:14:45,405 - epoch:5, training loss:740.0264 validation loss:13.6354
2024-09-12 22:14:48,012 - epoch:6, training loss:732.3505 validation loss:13.3542
2024-09-12 22:14:50,677 - epoch:7, training loss:731.8983 validation loss:13.2182
2024-09-12 22:14:53,294 - epoch:8, training loss:725.9473 validation loss:13.2777
2024-09-12 22:14:55,867 - epoch:9, training loss:728.6512 validation loss:13.2682
2024-09-12 22:14:58,500 - epoch:10, training loss:721.3343 validation loss:13.4887
2024-09-12 22:15:01,091 - epoch:11, training loss:720.8801 validation loss:13.4772
2024-09-12 22:15:03,716 - epoch:12, training loss:717.7412 validation loss:13.2659
2024-09-12 22:15:06,396 - epoch:13, training loss:718.5098 validation loss:13.1635
2024-09-12 22:15:09,102 - epoch:14, training loss:713.1259 validation loss:13.4797
2024-09-12 22:15:11,765 - epoch:15, training loss:710.6423 validation loss:13.2424
2024-09-12 22:15:14,337 - epoch:16, training loss:712.1222 validation loss:13.3402
2024-09-12 22:15:16,847 - epoch:17, training loss:711.4317 validation loss:13.2763
2024-09-12 22:15:19,357 - epoch:18, training loss:708.6867 validation loss:13.3862
2024-09-12 22:15:21,980 - epoch:19, training loss:707.0254 validation loss:13.3006
2024-09-12 22:15:23,053 - [*] loss:730.9037
2024-09-12 22:15:23,086 - [*] year 2015, testing
2024-09-12 22:15:23,405 - T:3	MAE	12.7584	RMSE	20.5646	MAPE	16.5891
2024-09-12 22:15:24,007 - T:6	MAE	13.9768	RMSE	22.9653	MAPE	18.2783
2024-09-12 22:15:25,772 - T:12	MAE	16.3185	RMSE	27.3256	MAPE	21.5224
2024-09-12 22:15:25,772 - T:Avg	MAE	14.1315	RMSE	23.2072	MAPE	18.5045
2024-09-12 22:15:25,774 - Finished optimization, total time:32.02 s, best model:log/PEMS/trafficstream-44/2015/13.1635.pkl
2024-09-12 22:15:25,797 - [*] Year 2016 load from data/PEMS/FastData/2016.npz
2024-09-12 22:15:25,806 - [*] load from log/PEMS/trafficstream-44/2015/13.1635.pkl
2024-09-12 22:15:29,646 - number of increase nodes:99, nodes after 2 hop:torch.Size([225]), total nodes this year 850
2024-09-12 22:15:30,481 - [*] Year 2016 Dataset load!
2024-09-12 22:15:30,482 - [*] load from log/PEMS/trafficstream-44/2015/13.1635.pkl
2024-09-12 22:15:30,485 - [*] EWC! lambda 0.000100
2024-09-12 22:15:33,260 - [*] Year 2016 Training start
2024-09-12 22:15:34,261 - node number torch.Size([28800, 12])
2024-09-12 22:15:35,857 - epoch:0, training loss:1524.3609 validation loss:16.0593
2024-09-12 22:15:38,393 - epoch:1, training loss:1446.3489 validation loss:15.7200
2024-09-12 22:15:40,931 - epoch:2, training loss:1438.7820 validation loss:16.1385
2024-09-12 22:15:43,428 - epoch:3, training loss:1429.7481 validation loss:15.7279
2024-09-12 22:15:45,923 - epoch:4, training loss:1420.0464 validation loss:15.8938
2024-09-12 22:15:48,433 - epoch:5, training loss:1423.1356 validation loss:15.6478
2024-09-12 22:15:50,920 - epoch:6, training loss:1418.8960 validation loss:15.4808
2024-09-12 22:15:53,416 - epoch:7, training loss:1418.8059 validation loss:15.6341
2024-09-12 22:15:55,987 - epoch:8, training loss:1416.4987 validation loss:15.6287
2024-09-12 22:15:58,541 - epoch:9, training loss:1411.9395 validation loss:15.8281
2024-09-12 22:16:01,047 - epoch:10, training loss:1416.8913 validation loss:15.4810
2024-09-12 22:16:03,575 - epoch:11, training loss:1412.3550 validation loss:15.7478
2024-09-12 22:16:06,131 - epoch:12, training loss:1406.3940 validation loss:16.3298
2024-09-12 22:16:07,226 - [*] loss:776.1016
2024-09-12 22:16:07,258 - [*] year 2016, testing
2024-09-12 22:16:07,567 - T:3	MAE	12.2037	RMSE	21.5943	MAPE	15.4079
2024-09-12 22:16:08,176 - T:6	MAE	13.3632	RMSE	23.9198	MAPE	16.9053
2024-09-12 22:16:09,990 - T:12	MAE	15.6834	RMSE	28.1052	MAPE	20.0202
2024-09-12 22:16:09,990 - T:Avg	MAE	13.5347	RMSE	24.1256	MAPE	17.1539
2024-09-12 22:16:09,991 - Finished optimization, total time:20.05 s, best model:log/PEMS/trafficstream-44/2016/15.4808.pkl
2024-09-12 22:16:10,017 - [*] Year 2017 load from data/PEMS/FastData/2017.npz
2024-09-12 22:16:10,026 - [*] load from log/PEMS/trafficstream-44/2016/15.4808.pkl
2024-09-12 22:16:13,905 - number of increase nodes:106, nodes after 2 hop:torch.Size([315]), total nodes this year 871
2024-09-12 22:16:14,792 - [*] Year 2017 Dataset load!
2024-09-12 22:16:14,793 - [*] load from log/PEMS/trafficstream-44/2016/15.4808.pkl
2024-09-12 22:16:14,795 - [*] EWC! lambda 0.000100
2024-09-12 22:16:17,593 - [*] Year 2017 Training start
2024-09-12 22:16:18,608 - node number torch.Size([40320, 12])
2024-09-12 22:16:20,445 - epoch:0, training loss:946.7157 validation loss:17.6101
2024-09-12 22:16:23,612 - epoch:1, training loss:897.2661 validation loss:17.3377
2024-09-12 22:16:26,268 - epoch:2, training loss:888.5036 validation loss:17.8060
2024-09-12 22:16:29,021 - epoch:3, training loss:886.2043 validation loss:17.5204
2024-09-12 22:16:31,747 - epoch:4, training loss:879.5704 validation loss:17.1372
2024-09-12 22:16:34,434 - epoch:5, training loss:877.6788 validation loss:17.3992
2024-09-12 22:16:37,247 - epoch:6, training loss:876.4188 validation loss:16.9265
2024-09-12 22:16:40,008 - epoch:7, training loss:877.1585 validation loss:17.3405
2024-09-12 22:16:42,940 - epoch:8, training loss:879.5962 validation loss:17.5515
2024-09-12 22:16:45,718 - epoch:9, training loss:877.1552 validation loss:17.3602
2024-09-12 22:16:48,491 - epoch:10, training loss:872.9745 validation loss:17.4746
2024-09-12 22:16:51,211 - epoch:11, training loss:870.6190 validation loss:17.8958
2024-09-12 22:16:54,024 - epoch:12, training loss:873.3909 validation loss:17.3152
2024-09-12 22:16:55,199 - [*] loss:781.8745
2024-09-12 22:16:55,228 - [*] year 2017, testing
2024-09-12 22:16:55,536 - T:3	MAE	13.6539	RMSE	22.2940	MAPE	17.4328
2024-09-12 22:16:56,090 - T:6	MAE	14.8032	RMSE	24.4058	MAPE	18.2327
2024-09-12 22:16:57,791 - T:12	MAE	17.0267	RMSE	28.2131	MAPE	20.4422
2024-09-12 22:16:57,791 - T:Avg	MAE	14.9457	RMSE	24.5953	MAPE	18.4869
2024-09-12 22:16:57,793 - Finished optimization, total time:23.30 s, best model:log/PEMS/trafficstream-44/2017/16.9265.pkl
2024-09-12 22:16:57,802 - 


2024-09-12 22:16:57,803 - 3   	 MAE	     12.93	     12.68	     12.35	     13.25	     12.76	     12.20	     13.65		   12.83
2024-09-12 22:16:57,803 - 3   	RMSE	     19.70	     19.64	     19.63	     21.39	     20.56	     21.59	     22.29		   20.69
2024-09-12 22:16:57,803 - 3   	MAPE	     17.05	     17.73	     18.25	     17.11	     16.59	     15.41	     17.43		   17.08
2024-09-12 22:16:57,803 - 6   	 MAE	     13.98	     13.64	     13.53	     14.39	     13.98	     13.36	     14.80		   13.95
2024-09-12 22:16:57,803 - 6   	RMSE	     21.53	     21.37	     21.75	     23.42	     22.97	     23.92	     24.41		   22.77
2024-09-12 22:16:57,803 - 6   	MAPE	     18.49	     19.05	     19.97	     18.19	     18.28	     16.91	     18.23		   18.45
2024-09-12 22:16:57,803 - 12  	 MAE	     16.12	     15.81	     15.93	     16.70	     16.32	     15.68	     17.03		   16.23
2024-09-12 22:16:57,803 - 12  	RMSE	     25.19	     25.23	     25.91	     27.38	     27.33	     28.11	     28.21		   26.76
2024-09-12 22:16:57,803 - 12  	MAPE	     21.81	     22.99	     24.01	     21.41	     21.52	     20.02	     20.44		   21.74
2024-09-12 22:16:57,803 - Avg 	 MAE	     14.14	     13.86	     13.71	     14.56	     14.13	     13.53	     14.95		   14.13
2024-09-12 22:16:57,803 - Avg 	RMSE	     21.79	     21.74	     22.02	     23.68	     23.21	     24.13	     24.60		   23.02
2024-09-12 22:16:57,803 - Avg 	MAPE	     18.84	     19.59	     20.37	     18.58	     18.50	     17.15	     18.49		   18.79
2024-09-12 22:16:57,803 - year	2011	total_time	   74.2671	average_time	    1.9544	epoch	38
2024-09-12 22:16:57,804 - year	2012	total_time	   60.2407	average_time	    1.7718	epoch	34
2024-09-12 22:16:57,804 - year	2013	total_time	   27.1218	average_time	    1.8081	epoch	15
2024-09-12 22:16:57,804 - year	2014	total_time	   86.2682	average_time	    1.8355	epoch	47
2024-09-12 22:16:57,804 - year	2015	total_time	   32.0238	average_time	    1.6012	epoch	20
2024-09-12 22:16:57,804 - year	2016	total_time	   20.0473	average_time	    1.5421	epoch	13
2024-09-12 22:16:57,804 - year	2017	total_time	   23.3022	average_time	    1.7925	epoch	13
2024-09-12 22:16:57,804 - total time: 323.2711
2025-05-09 04:18:04,381 - logger name:log/PEMS/trafficstream-44/trafficstream.log
2025-05-09 04:18:04,381 - params : {'conf': 'conf/PEMS/trafficstream.json', 'seed': 44, 'paral': 0, 'gpuid': 1, 'logname': 'trafficstream', 'method': 'TrafficStream', 'load_first_year': 1, 'first_year_model_path': 'log/ENERGY-Wind/eac-42/0/2.88.pkl', 'device': device(type='cuda', index=1), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>}, 'begin_year': 2011, 'end_year': 2017, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 1, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'raw_data_path': '/data/weichen/TrafficStream_data/PEMS/RawData/', 'save_data_path': '/data/weichen/TrafficStream_data/PEMS/FastData/', 'graph_path': '/data/weichen/TrafficStream_data/PEMS/graph/', 'model_path': 'log/PEMS/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'init': True, 'train': 0, 'auto_test': 1, 'strategy': 'incremental', 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0001, 'replay': True, 'replay_strategy': 'inforeplay', 'path': 'log/PEMS/trafficstream-44', 'logger': <Logger utils.initialize (INFO)>}
2025-05-09 04:18:04,394 - [*] Year 2011 load from /data/weichen/TrafficStream_data/PEMS/FastData/2011.npz
2025-05-09 04:18:04,547 - [*] load from log/PEMS/trafficstream-44/2011/16.3593.pkl
2025-05-09 04:18:19,119 - [*] year 2011, testing
2025-05-09 04:18:19,486 - T:3	MAE	12.8319	RMSE	19.5806	MAPE	16.8598
2025-05-09 04:18:20,066 - T:6	MAE	13.8734	RMSE	21.4036	MAPE	18.2625
2025-05-09 04:18:21,618 - T:12	MAE	16.0086	RMSE	25.0450	MAPE	21.5138
2025-05-09 04:18:21,618 - T:Avg	MAE	14.0379	RMSE	21.6595	MAPE	18.6055
2025-05-09 04:18:21,633 - [*] Year 2012 load from /data/weichen/TrafficStream_data/PEMS/FastData/2012.npz
2025-05-09 04:18:21,641 - [*] load from log/PEMS/trafficstream-44/2012/17.3325.pkl
2025-05-09 04:18:25,160 - number of increase nodes:129, nodes after 2 hop:torch.Size([319]), total nodes this year 715
2025-05-09 04:18:25,160 - [*] load from log/PEMS/trafficstream-44/2012/17.3325.pkl
2025-05-09 04:18:40,190 - [*] year 2012, testing
2025-05-09 04:18:40,514 - T:3	MAE	12.2085	RMSE	19.0420	MAPE	17.0847
2025-05-09 04:18:41,152 - T:6	MAE	13.2207	RMSE	20.8314	MAPE	18.4194
2025-05-09 04:18:42,885 - T:12	MAE	15.4037	RMSE	24.6802	MAPE	22.2782
2025-05-09 04:18:42,885 - T:Avg	MAE	13.4149	RMSE	21.1663	MAPE	18.9314
2025-05-09 04:18:42,901 - [*] Year 2013 load from /data/weichen/TrafficStream_data/PEMS/FastData/2013.npz
2025-05-09 04:18:42,913 - [*] load from log/PEMS/trafficstream-44/2013/16.2119.pkl
2025-05-09 04:18:46,691 - number of increase nodes:149, nodes after 2 hop:torch.Size([349]), total nodes this year 786
2025-05-09 04:18:46,691 - [*] load from log/PEMS/trafficstream-44/2013/16.2119.pkl
2025-05-09 04:19:01,077 - [*] year 2013, testing
2025-05-09 04:19:01,444 - T:3	MAE	12.3011	RMSE	19.5634	MAPE	17.8282
2025-05-09 04:19:02,103 - T:6	MAE	13.4658	RMSE	21.6638	MAPE	19.5148
2025-05-09 04:19:03,930 - T:12	MAE	15.8373	RMSE	25.7694	MAPE	23.4681
2025-05-09 04:19:03,930 - T:Avg	MAE	13.6414	RMSE	21.9297	MAPE	19.9077
2025-05-09 04:19:03,951 - [*] Year 2014 load from /data/weichen/TrafficStream_data/PEMS/FastData/2014.npz
2025-05-09 04:19:03,976 - [*] load from log/PEMS/trafficstream-44/2014/18.6566.pkl
2025-05-09 04:19:07,799 - number of increase nodes:117, nodes after 2 hop:torch.Size([314]), total nodes this year 822
2025-05-09 04:19:07,800 - [*] load from log/PEMS/trafficstream-44/2014/18.6566.pkl
2025-05-09 04:19:22,220 - [*] year 2014, testing
2025-05-09 04:19:22,559 - T:3	MAE	13.0728	RMSE	20.8988	MAPE	17.0882
2025-05-09 04:19:23,249 - T:6	MAE	14.1941	RMSE	22.8846	MAPE	18.1619
2025-05-09 04:19:25,177 - T:12	MAE	16.4769	RMSE	26.8115	MAPE	21.3149
2025-05-09 04:19:25,178 - T:Avg	MAE	14.3651	RMSE	23.1482	MAPE	18.5293
2025-05-09 04:19:25,199 - [*] Year 2015 load from /data/weichen/TrafficStream_data/PEMS/FastData/2015.npz
2025-05-09 04:19:25,214 - [*] load from log/PEMS/trafficstream-44/2015/13.1635.pkl
2025-05-09 04:19:29,472 - number of increase nodes:94, nodes after 2 hop:torch.Size([251]), total nodes this year 834
2025-05-09 04:19:29,472 - [*] load from log/PEMS/trafficstream-44/2015/13.1635.pkl
2025-05-09 04:19:44,841 - [*] year 2015, testing
2025-05-09 04:19:45,224 - T:3	MAE	12.7698	RMSE	20.5778	MAPE	16.5446
2025-05-09 04:19:45,946 - T:6	MAE	13.9417	RMSE	22.8839	MAPE	18.1904
2025-05-09 04:19:47,932 - T:12	MAE	16.2341	RMSE	27.1428	MAPE	21.3652
2025-05-09 04:19:47,932 - T:Avg	MAE	14.0976	RMSE	23.1285	MAPE	18.4122
2025-05-09 04:19:47,954 - [*] Year 2016 load from /data/weichen/TrafficStream_data/PEMS/FastData/2016.npz
2025-05-09 04:19:47,966 - [*] load from log/PEMS/trafficstream-44/2016/15.4808.pkl
2025-05-09 04:19:52,335 - number of increase nodes:99, nodes after 2 hop:torch.Size([195]), total nodes this year 850
2025-05-09 04:19:52,335 - [*] load from log/PEMS/trafficstream-44/2016/15.4808.pkl
2025-05-09 04:20:07,407 - [*] year 2016, testing
2025-05-09 04:20:07,759 - T:3	MAE	12.1369	RMSE	21.5114	MAPE	15.2506
2025-05-09 04:20:08,447 - T:6	MAE	13.3057	RMSE	23.8277	MAPE	16.7268
2025-05-09 04:20:10,452 - T:12	MAE	15.6038	RMSE	27.9578	MAPE	19.7783
2025-05-09 04:20:10,452 - T:Avg	MAE	13.4674	RMSE	24.0206	MAPE	16.9665
2025-05-09 04:20:10,471 - [*] Year 2017 load from /data/weichen/TrafficStream_data/PEMS/FastData/2017.npz
2025-05-09 04:20:10,481 - [*] load from log/PEMS/trafficstream-44/2017/16.9265.pkl
2025-05-09 04:20:14,535 - number of increase nodes:106, nodes after 2 hop:torch.Size([291]), total nodes this year 871
2025-05-09 04:20:14,535 - [*] load from log/PEMS/trafficstream-44/2017/16.9265.pkl
2025-05-09 04:20:28,951 - [*] year 2017, testing
2025-05-09 04:20:29,325 - T:3	MAE	13.4982	RMSE	22.1013	MAPE	17.2155
2025-05-09 04:20:30,066 - T:6	MAE	14.6653	RMSE	24.2377	MAPE	18.0035
2025-05-09 04:20:32,132 - T:12	MAE	16.9224	RMSE	28.0803	MAPE	20.1815
2025-05-09 04:20:32,132 - T:Avg	MAE	14.8120	RMSE	24.4290	MAPE	18.2569
2025-05-09 04:20:32,135 - 


2025-05-09 04:20:32,135 - 3   	 MAE	     12.83	     12.21	     12.30	     13.07	     12.77	     12.14	     13.50		   12.69
2025-05-09 04:20:32,135 - 3   	RMSE	     19.58	     19.04	     19.56	     20.90	     20.58	     21.51	     22.10		   20.47
2025-05-09 04:20:32,135 - 3   	MAPE	     16.86	     17.08	     17.83	     17.09	     16.54	     15.25	     17.22		   16.84
2025-05-09 04:20:32,135 - 6   	 MAE	     13.87	     13.22	     13.47	     14.19	     13.94	     13.31	     14.67		   13.81
2025-05-09 04:20:32,135 - 6   	RMSE	     21.40	     20.83	     21.66	     22.88	     22.88	     23.83	     24.24		   22.53
2025-05-09 04:20:32,135 - 6   	MAPE	     18.26	     18.42	     19.51	     18.16	     18.19	     16.73	     18.00		   18.18
2025-05-09 04:20:32,136 - 12  	 MAE	     16.01	     15.40	     15.84	     16.48	     16.23	     15.60	     16.92		   16.07
2025-05-09 04:20:32,136 - 12  	RMSE	     25.04	     24.68	     25.77	     26.81	     27.14	     27.96	     28.08		   26.50
2025-05-09 04:20:32,136 - 12  	MAPE	     21.51	     22.28	     23.47	     21.31	     21.37	     19.78	     20.18		   21.41
2025-05-09 04:20:32,136 - Avg 	 MAE	     14.04	     13.41	     13.64	     14.37	     14.10	     13.47	     14.81		   13.98
2025-05-09 04:20:32,136 - Avg 	RMSE	     21.66	     21.17	     21.93	     23.15	     23.13	     24.02	     24.43		   22.78
2025-05-09 04:20:32,136 - Avg 	MAPE	     18.61	     18.93	     19.91	     18.53	     18.41	     16.97	     18.26		   18.52
2025-05-09 04:20:32,136 - total time: 0.0000
