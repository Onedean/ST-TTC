2024-09-15 00:53:01,553 - logger name:log/PEMS/stkec-43/stkec.log
2024-09-15 00:53:01,553 - params : {'conf': 'new_conf/PEMS/stkec.json', 'seed': 43, 'paral': 0, 'gpuid': 0, 'logname': 'stkec', 'method': 'STKEC', 'load_first_year': 0, 'first_year_model_path': 'log/PEMS3/trafficStream-42/2011/16.6936.pkl', 'device': device(type='cuda', index=0), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>}, 'begin_year': 2011, 'end_year': 2017, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'influe_length': 168, 'data_process': 0, 'batch_influ_size': 4, 'beita': 1, 'cluster': 24, 'raw_data_path': 'data/PEMS/RawData/', 'save_data_path': 'data/PEMS/FastData/', 'graph_path': 'data/PEMS/graph/', 'model_path': 'log/PEMS/', 'influence_path': "Pleaseenter'outdir'inyourpath", 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'init': True, 'train': 1, 'auto_test': 0, 'strategy': 'incremental', 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'detect_infl_strategy': True, 'infl_topk': 10, 'adp_adj': False, 'skip_dim': 64, 'end_dim': 64, 'hidden_channels': 32, 'dilation_channels': 64, 'residual_channels': 64, 'input_dim': 1, 'output_dim': 1, 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0005, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'path': 'log/PEMS/stkec-43', 'logger': <Logger utils.initialize (INFO)>}
2024-09-15 00:53:01,566 - [*] Year 2011 load from data/PEMS/FastData/2011.npz
2024-09-15 00:53:02,329 - [*] Year 2011 Dataset load!
2024-09-15 00:53:02,331 - [*] Year 2011 Training start
2024-09-15 00:53:03,226 - node number torch.Size([83840, 12])
2024-09-15 00:53:06,165 - epoch:0, training loss:14205.7168 validation loss:40.4485
2024-09-15 00:53:09,372 - epoch:1, training loss:1780.0737 validation loss:22.8571
2024-09-15 00:53:12,524 - epoch:2, training loss:1197.0746 validation loss:19.5029
2024-09-15 00:53:15,752 - epoch:3, training loss:896.1503 validation loss:18.3496
2024-09-15 00:53:19,019 - epoch:4, training loss:819.2904 validation loss:18.5010
2024-09-15 00:53:22,410 - epoch:5, training loss:789.8463 validation loss:17.7906
2024-09-15 00:53:25,617 - epoch:6, training loss:766.6360 validation loss:17.5695
2024-09-15 00:53:28,911 - epoch:7, training loss:747.7940 validation loss:17.1928
2024-09-15 00:53:32,127 - epoch:8, training loss:738.0375 validation loss:17.0513
2024-09-15 00:53:35,335 - epoch:9, training loss:725.1454 validation loss:16.7963
2024-09-15 00:53:38,513 - epoch:10, training loss:710.4537 validation loss:16.9308
2024-09-15 00:53:41,675 - epoch:11, training loss:702.5854 validation loss:16.7469
2024-09-15 00:53:44,786 - epoch:12, training loss:706.7480 validation loss:16.6588
2024-09-15 00:53:47,889 - epoch:13, training loss:691.3225 validation loss:16.5414
2024-09-15 00:53:51,328 - epoch:14, training loss:687.4155 validation loss:16.9744
2024-09-15 00:53:54,595 - epoch:15, training loss:697.0775 validation loss:16.8915
2024-09-15 00:53:57,784 - epoch:16, training loss:674.7792 validation loss:16.8323
2024-09-15 00:54:00,965 - epoch:17, training loss:679.6118 validation loss:16.3757
2024-09-15 00:54:04,094 - epoch:18, training loss:674.3244 validation loss:16.5900
2024-09-15 00:54:07,180 - epoch:19, training loss:693.3961 validation loss:16.4291
2024-09-15 00:54:10,228 - epoch:20, training loss:671.5211 validation loss:16.4590
2024-09-15 00:54:13,328 - epoch:21, training loss:665.2038 validation loss:16.2977
2024-09-15 00:54:16,462 - epoch:22, training loss:679.5655 validation loss:16.8900
2024-09-15 00:54:19,533 - epoch:23, training loss:673.1793 validation loss:16.2678
2024-09-15 00:54:22,735 - epoch:24, training loss:666.2791 validation loss:16.4592
2024-09-15 00:54:25,980 - epoch:25, training loss:673.4525 validation loss:17.7933
2024-09-15 00:54:29,177 - epoch:26, training loss:675.9426 validation loss:16.3411
2024-09-15 00:54:32,426 - epoch:27, training loss:662.1454 validation loss:16.2479
2024-09-15 00:54:35,563 - epoch:28, training loss:672.3671 validation loss:16.2866
2024-09-15 00:54:38,641 - epoch:29, training loss:657.1677 validation loss:16.6844
2024-09-15 00:54:41,766 - epoch:30, training loss:677.2069 validation loss:16.1932
2024-09-15 00:54:44,831 - epoch:31, training loss:656.6334 validation loss:16.3827
2024-09-15 00:54:47,967 - epoch:32, training loss:658.4142 validation loss:16.4246
2024-09-15 00:54:51,080 - epoch:33, training loss:658.6113 validation loss:16.6783
2024-09-15 00:54:54,335 - epoch:34, training loss:663.5786 validation loss:16.4655
2024-09-15 00:54:57,462 - epoch:35, training loss:665.7549 validation loss:16.2662
2024-09-15 00:55:00,556 - epoch:36, training loss:652.6107 validation loss:16.1528
2024-09-15 00:55:03,700 - epoch:37, training loss:656.4934 validation loss:16.2914
2024-09-15 00:55:06,875 - epoch:38, training loss:671.2653 validation loss:16.3796
2024-09-15 00:55:09,960 - epoch:39, training loss:656.6375 validation loss:16.2402
2024-09-15 00:55:13,003 - epoch:40, training loss:658.3147 validation loss:16.5134
2024-09-15 00:55:16,086 - epoch:41, training loss:649.4637 validation loss:16.3783
2024-09-15 00:55:19,204 - epoch:42, training loss:657.1668 validation loss:16.0710
2024-09-15 00:55:22,256 - epoch:43, training loss:648.6637 validation loss:16.6627
2024-09-15 00:55:25,372 - epoch:44, training loss:653.9027 validation loss:16.1324
2024-09-15 00:55:28,535 - epoch:45, training loss:661.5354 validation loss:16.2884
2024-09-15 00:55:31,781 - epoch:46, training loss:650.2002 validation loss:16.1348
2024-09-15 00:55:35,058 - epoch:47, training loss:651.9277 validation loss:16.1480
2024-09-15 00:55:38,246 - epoch:48, training loss:652.0791 validation loss:16.4530
2024-09-15 00:55:39,225 - [*] loss:596.4387
2024-09-15 00:55:39,247 - [*] year 2011, testing
2024-09-15 00:55:39,506 - T:3	MAE	12.7726	RMSE	19.4758	MAPE	16.7414
2024-09-15 00:55:39,983 - T:6	MAE	13.7781	RMSE	21.2258	MAPE	17.7832
2024-09-15 00:55:41,427 - T:12	MAE	15.8023	RMSE	24.6297	MAPE	21.1389
2024-09-15 00:55:41,427 - T:Avg	MAE	13.9242	RMSE	21.4419	MAPE	18.2375
2024-09-15 00:55:41,428 - Finished optimization, total time:111.14 s, best model:log/PEMS/stkec-43/2011/16.071.pkl
2024-09-15 00:55:41,446 - [*] Year 2012 load from data/PEMS/FastData/2012.npz
2024-09-15 00:55:41,451 - [*] load from log/PEMS/stkec-43/2011/16.071.pkl
2024-09-15 00:55:41,459 - [*] detect strategy feature
2024-09-15 00:55:44,837 - number of increase nodes:78, nodes after 2 hop:torch.Size([243]), total nodes this year 715
2024-09-15 00:55:45,590 - [*] Year 2012 Dataset load!
2024-09-15 00:55:45,590 - [*] load from log/PEMS/stkec-43/2011/16.071.pkl
2024-09-15 00:55:45,594 - [*] EWC! lambda 0.000500
2024-09-15 00:55:48,391 - [*] Year 2012 Training start
2024-09-15 00:55:49,265 - node number torch.Size([31104, 12])
2024-09-15 00:55:51,295 - epoch:0, training loss:743.1179 validation loss:15.1047
2024-09-15 00:55:53,929 - epoch:1, training loss:624.9627 validation loss:14.6855
2024-09-15 00:55:56,553 - epoch:2, training loss:619.4877 validation loss:14.7952
2024-09-15 00:55:59,173 - epoch:3, training loss:622.1255 validation loss:14.6600
2024-09-15 00:56:01,840 - epoch:4, training loss:621.9638 validation loss:14.8865
2024-09-15 00:56:04,518 - epoch:5, training loss:629.3172 validation loss:14.7745
2024-09-15 00:56:07,105 - epoch:6, training loss:618.4157 validation loss:14.9345
2024-09-15 00:56:09,692 - epoch:7, training loss:625.0392 validation loss:14.7763
2024-09-15 00:56:12,235 - epoch:8, training loss:624.9083 validation loss:14.9701
2024-09-15 00:56:14,806 - epoch:9, training loss:620.0421 validation loss:14.6532
2024-09-15 00:56:17,445 - epoch:10, training loss:621.7516 validation loss:14.9081
2024-09-15 00:56:20,079 - epoch:11, training loss:615.5913 validation loss:14.8989
2024-09-15 00:56:22,657 - epoch:12, training loss:623.8729 validation loss:14.6374
2024-09-15 00:56:25,254 - epoch:13, training loss:615.7799 validation loss:14.7047
2024-09-15 00:56:27,879 - epoch:14, training loss:615.1506 validation loss:14.7943
2024-09-15 00:56:30,510 - epoch:15, training loss:609.0037 validation loss:14.5589
2024-09-15 00:56:33,251 - epoch:16, training loss:609.6883 validation loss:14.8523
2024-09-15 00:56:35,954 - epoch:17, training loss:610.8214 validation loss:14.7222
2024-09-15 00:56:38,909 - epoch:18, training loss:622.0866 validation loss:14.9206
2024-09-15 00:56:41,572 - epoch:19, training loss:607.3118 validation loss:14.6227
2024-09-15 00:56:44,227 - epoch:20, training loss:607.7695 validation loss:14.7190
2024-09-15 00:56:46,994 - epoch:21, training loss:611.9844 validation loss:14.8770
2024-09-15 00:56:48,118 - [*] loss:614.8535
2024-09-15 00:56:48,147 - [*] year 2012, testing
2024-09-15 00:56:48,398 - T:3	MAE	12.4641	RMSE	19.3190	MAPE	18.8555
2024-09-15 00:56:48,867 - T:6	MAE	13.5128	RMSE	21.1475	MAPE	20.0280
2024-09-15 00:56:50,430 - T:12	MAE	15.7689	RMSE	25.0002	MAPE	23.4290
2024-09-15 00:56:50,431 - T:Avg	MAE	13.7195	RMSE	21.4794	MAPE	20.5321
2024-09-15 00:56:50,432 - Finished optimization, total time:36.56 s, best model:log/PEMS/stkec-43/2012/14.5589.pkl
2024-09-15 00:56:50,453 - [*] Year 2013 load from data/PEMS/FastData/2013.npz
2024-09-15 00:56:50,457 - [*] load from log/PEMS/stkec-43/2012/14.5589.pkl
2024-09-15 00:56:50,465 - [*] detect strategy feature
2024-09-15 00:56:54,425 - number of increase nodes:91, nodes after 2 hop:torch.Size([194]), total nodes this year 786
2024-09-15 00:56:55,220 - [*] Year 2013 Dataset load!
2024-09-15 00:56:55,220 - [*] load from log/PEMS/stkec-43/2012/14.5589.pkl
2024-09-15 00:56:55,223 - [*] EWC! lambda 0.000500
2024-09-15 00:56:58,102 - [*] Year 2013 Training start
2024-09-15 00:56:59,152 - node number torch.Size([24832, 12])
2024-09-15 00:57:00,850 - epoch:0, training loss:580.0935 validation loss:14.3654
2024-09-15 00:57:03,537 - epoch:1, training loss:461.2455 validation loss:13.3963
2024-09-15 00:57:06,270 - epoch:2, training loss:453.9041 validation loss:13.3109
2024-09-15 00:57:08,907 - epoch:3, training loss:459.9790 validation loss:13.4852
2024-09-15 00:57:11,681 - epoch:4, training loss:451.2037 validation loss:13.1445
2024-09-15 00:57:14,285 - epoch:5, training loss:448.0906 validation loss:13.3132
2024-09-15 00:57:16,965 - epoch:6, training loss:447.5977 validation loss:13.5981
2024-09-15 00:57:19,609 - epoch:7, training loss:451.4858 validation loss:13.0359
2024-09-15 00:57:22,296 - epoch:8, training loss:445.0818 validation loss:13.1045
2024-09-15 00:57:25,011 - epoch:9, training loss:440.2413 validation loss:13.0667
2024-09-15 00:57:27,686 - epoch:10, training loss:439.7879 validation loss:13.4530
2024-09-15 00:57:30,273 - epoch:11, training loss:443.3216 validation loss:14.0635
2024-09-15 00:57:32,825 - epoch:12, training loss:436.0856 validation loss:13.0013
2024-09-15 00:57:35,504 - epoch:13, training loss:444.6569 validation loss:13.9001
2024-09-15 00:57:38,120 - epoch:14, training loss:448.8799 validation loss:13.0287
2024-09-15 00:57:40,657 - epoch:15, training loss:440.1356 validation loss:12.8888
2024-09-15 00:57:43,317 - epoch:16, training loss:441.4933 validation loss:13.3038
2024-09-15 00:57:45,935 - epoch:17, training loss:434.4152 validation loss:13.4096
2024-09-15 00:57:48,615 - epoch:18, training loss:434.2031 validation loss:14.4992
2024-09-15 00:57:51,151 - epoch:19, training loss:439.7325 validation loss:14.5718
2024-09-15 00:57:53,753 - epoch:20, training loss:444.4474 validation loss:13.8867
2024-09-15 00:57:56,374 - epoch:21, training loss:436.2105 validation loss:12.8269
2024-09-15 00:57:59,020 - epoch:22, training loss:436.9822 validation loss:12.8519
2024-09-15 00:58:01,616 - epoch:23, training loss:433.7688 validation loss:13.5770
2024-09-15 00:58:04,258 - epoch:24, training loss:433.1953 validation loss:13.0709
2024-09-15 00:58:06,966 - epoch:25, training loss:431.4395 validation loss:13.3343
2024-09-15 00:58:09,620 - epoch:26, training loss:442.2790 validation loss:13.4742
2024-09-15 00:58:12,326 - epoch:27, training loss:439.9462 validation loss:13.1739
2024-09-15 00:58:13,567 - [*] loss:663.7225
2024-09-15 00:58:13,590 - [*] year 2013, testing
2024-09-15 00:58:13,859 - T:3	MAE	12.3046	RMSE	19.6369	MAPE	17.9119
2024-09-15 00:58:14,378 - T:6	MAE	13.4896	RMSE	21.8110	MAPE	18.9431
2024-09-15 00:58:16,038 - T:12	MAE	15.8559	RMSE	25.9623	MAPE	22.3096
2024-09-15 00:58:16,039 - T:Avg	MAE	13.6591	RMSE	22.0656	MAPE	19.4143
2024-09-15 00:58:16,040 - Finished optimization, total time:44.56 s, best model:log/PEMS/stkec-43/2013/12.8269.pkl
2024-09-15 00:58:16,068 - [*] Year 2014 load from data/PEMS/FastData/2014.npz
2024-09-15 00:58:16,073 - [*] load from log/PEMS/stkec-43/2013/12.8269.pkl
2024-09-15 00:58:16,083 - [*] detect strategy feature
2024-09-15 00:58:19,920 - number of increase nodes:82, nodes after 2 hop:torch.Size([283]), total nodes this year 822
2024-09-15 00:58:20,794 - [*] Year 2014 Dataset load!
2024-09-15 00:58:20,794 - [*] load from log/PEMS/stkec-43/2013/12.8269.pkl
2024-09-15 00:58:20,797 - [*] EWC! lambda 0.000500
2024-09-15 00:58:23,693 - [*] Year 2014 Training start
2024-09-15 00:58:24,661 - node number torch.Size([36224, 12])
2024-09-15 00:58:26,478 - epoch:0, training loss:855.2806 validation loss:15.5446
2024-09-15 00:58:29,201 - epoch:1, training loss:688.2270 validation loss:15.5904
2024-09-15 00:58:31,982 - epoch:2, training loss:681.8238 validation loss:15.4723
2024-09-15 00:58:34,734 - epoch:3, training loss:679.5378 validation loss:15.4152
2024-09-15 00:58:37,504 - epoch:4, training loss:678.3815 validation loss:15.3456
2024-09-15 00:58:40,212 - epoch:5, training loss:675.0770 validation loss:15.5748
2024-09-15 00:58:42,871 - epoch:6, training loss:679.4981 validation loss:15.3067
2024-09-15 00:58:45,706 - epoch:7, training loss:677.9815 validation loss:15.3094
2024-09-15 00:58:48,511 - epoch:8, training loss:691.5124 validation loss:15.2989
2024-09-15 00:58:51,308 - epoch:9, training loss:671.1896 validation loss:15.4473
2024-09-15 00:58:54,085 - epoch:10, training loss:680.2021 validation loss:15.4486
2024-09-15 00:58:56,792 - epoch:11, training loss:682.6333 validation loss:15.3194
2024-09-15 00:58:59,576 - epoch:12, training loss:681.2100 validation loss:15.8966
2024-09-15 00:59:02,409 - epoch:13, training loss:674.0789 validation loss:15.7263
2024-09-15 00:59:05,163 - epoch:14, training loss:678.8343 validation loss:15.3214
2024-09-15 00:59:06,348 - [*] loss:745.4357
2024-09-15 00:59:06,386 - [*] year 2014, testing
2024-09-15 00:59:06,675 - T:3	MAE	13.3227	RMSE	21.5454	MAPE	18.3690
2024-09-15 00:59:07,302 - T:6	MAE	14.4017	RMSE	23.4687	MAPE	19.8027
2024-09-15 00:59:09,010 - T:12	MAE	16.7699	RMSE	27.6013	MAPE	22.5841
2024-09-15 00:59:09,010 - T:Avg	MAE	14.6049	RMSE	23.7963	MAPE	19.9786
2024-09-15 00:59:09,012 - Finished optimization, total time:26.09 s, best model:log/PEMS/stkec-43/2014/15.2989.pkl
2024-09-15 00:59:09,035 - [*] Year 2015 load from data/PEMS/FastData/2015.npz
2024-09-15 00:59:09,040 - [*] load from log/PEMS/stkec-43/2014/15.2989.pkl
2024-09-15 00:59:09,049 - [*] detect strategy feature
2024-09-15 00:59:12,959 - number of increase nodes:82, nodes after 2 hop:torch.Size([274]), total nodes this year 834
2024-09-15 00:59:13,920 - [*] Year 2015 Dataset load!
2024-09-15 00:59:13,920 - [*] load from log/PEMS/stkec-43/2014/15.2989.pkl
2024-09-15 00:59:13,923 - [*] EWC! lambda 0.000500
2024-09-15 00:59:16,840 - [*] Year 2015 Training start
2024-09-15 00:59:17,805 - node number torch.Size([35072, 12])
2024-09-15 00:59:19,608 - epoch:0, training loss:1366.1673 validation loss:18.3954
2024-09-15 00:59:22,365 - epoch:1, training loss:1113.6174 validation loss:17.5416
2024-09-15 00:59:25,073 - epoch:2, training loss:1086.4469 validation loss:17.5937
2024-09-15 00:59:27,831 - epoch:3, training loss:1080.2418 validation loss:17.7348
2024-09-15 00:59:30,643 - epoch:4, training loss:1068.5229 validation loss:17.9408
2024-09-15 00:59:33,306 - epoch:5, training loss:1071.5349 validation loss:17.5056
2024-09-15 00:59:36,058 - epoch:6, training loss:1064.1528 validation loss:17.6085
2024-09-15 00:59:38,835 - epoch:7, training loss:1059.9401 validation loss:17.4470
2024-09-15 00:59:41,570 - epoch:8, training loss:1064.4115 validation loss:17.6028
2024-09-15 00:59:44,290 - epoch:9, training loss:1049.0395 validation loss:17.5871
2024-09-15 00:59:47,072 - epoch:10, training loss:1056.2277 validation loss:18.2413
2024-09-15 00:59:49,864 - epoch:11, training loss:1049.7607 validation loss:17.9965
2024-09-15 00:59:52,547 - epoch:12, training loss:1090.6379 validation loss:17.5181
2024-09-15 00:59:55,274 - epoch:13, training loss:1044.1676 validation loss:17.6444
2024-09-15 00:59:56,567 - [*] loss:705.9070
2024-09-15 00:59:56,608 - [*] year 2015, testing
2024-09-15 00:59:56,887 - T:3	MAE	12.8271	RMSE	20.5922	MAPE	17.6679
2024-09-15 00:59:57,518 - T:6	MAE	14.0246	RMSE	22.8614	MAPE	19.2865
2024-09-15 00:59:59,295 - T:12	MAE	16.2707	RMSE	26.8537	MAPE	22.1996
2024-09-15 00:59:59,295 - T:Avg	MAE	14.1597	RMSE	23.0422	MAPE	19.4651
2024-09-15 00:59:59,297 - Finished optimization, total time:23.98 s, best model:log/PEMS/stkec-43/2015/17.447.pkl
2024-09-15 00:59:59,327 - [*] Year 2016 load from data/PEMS/FastData/2016.npz
2024-09-15 00:59:59,333 - [*] load from log/PEMS/stkec-43/2015/17.447.pkl
2024-09-15 00:59:59,343 - [*] detect strategy feature
2024-09-15 01:00:03,300 - number of increase nodes:85, nodes after 2 hop:torch.Size([243]), total nodes this year 850
2024-09-15 01:00:04,185 - [*] Year 2016 Dataset load!
2024-09-15 01:00:04,185 - [*] load from log/PEMS/stkec-43/2015/17.447.pkl
2024-09-15 01:00:04,188 - [*] EWC! lambda 0.000500
2024-09-15 01:00:07,151 - [*] Year 2016 Training start
2024-09-15 01:00:08,206 - node number torch.Size([31104, 12])
2024-09-15 01:00:09,956 - epoch:0, training loss:723.7844 validation loss:13.7264
2024-09-15 01:00:12,527 - epoch:1, training loss:579.6816 validation loss:13.6574
2024-09-15 01:00:15,196 - epoch:2, training loss:574.6498 validation loss:13.6694
2024-09-15 01:00:17,766 - epoch:3, training loss:573.3113 validation loss:13.9641
2024-09-15 01:00:20,486 - epoch:4, training loss:573.1434 validation loss:13.7044
2024-09-15 01:00:23,205 - epoch:5, training loss:572.2293 validation loss:13.9467
2024-09-15 01:00:25,894 - epoch:6, training loss:573.1127 validation loss:13.6122
2024-09-15 01:00:28,589 - epoch:7, training loss:569.9358 validation loss:13.7363
2024-09-15 01:00:31,297 - epoch:8, training loss:566.3712 validation loss:13.9463
2024-09-15 01:00:33,950 - epoch:9, training loss:572.0752 validation loss:13.5685
2024-09-15 01:00:36,628 - epoch:10, training loss:585.9656 validation loss:14.3260
2024-09-15 01:00:39,308 - epoch:11, training loss:575.1205 validation loss:13.7005
2024-09-15 01:00:42,055 - epoch:12, training loss:574.8923 validation loss:13.5690
2024-09-15 01:00:44,898 - epoch:13, training loss:577.4229 validation loss:14.2242
2024-09-15 01:00:47,625 - epoch:14, training loss:565.5113 validation loss:13.5149
2024-09-15 01:00:50,292 - epoch:15, training loss:564.4795 validation loss:13.4975
2024-09-15 01:00:53,114 - epoch:16, training loss:570.2062 validation loss:14.0274
2024-09-15 01:00:55,837 - epoch:17, training loss:572.4298 validation loss:13.5441
2024-09-15 01:00:58,626 - epoch:18, training loss:563.0193 validation loss:13.5229
2024-09-15 01:01:01,317 - epoch:19, training loss:564.5260 validation loss:14.0217
2024-09-15 01:01:04,010 - epoch:20, training loss:561.6326 validation loss:13.6505
2024-09-15 01:01:06,701 - epoch:21, training loss:574.3692 validation loss:13.8778
2024-09-15 01:01:07,859 - [*] loss:765.3573
2024-09-15 01:01:07,896 - [*] year 2016, testing
2024-09-15 01:01:08,197 - T:3	MAE	12.2554	RMSE	21.6635	MAPE	15.7194
2024-09-15 01:01:08,817 - T:6	MAE	13.3843	RMSE	23.9389	MAPE	16.8290
2024-09-15 01:01:10,715 - T:12	MAE	15.6364	RMSE	27.9085	MAPE	19.8300
2024-09-15 01:01:10,715 - T:Avg	MAE	13.5477	RMSE	24.0968	MAPE	17.1667
2024-09-15 01:01:10,717 - Finished optimization, total time:37.10 s, best model:log/PEMS/stkec-43/2016/13.4975.pkl
2024-09-15 01:01:10,742 - [*] Year 2017 load from data/PEMS/FastData/2017.npz
2024-09-15 01:01:10,748 - [*] load from log/PEMS/stkec-43/2016/13.4975.pkl
2024-09-15 01:01:10,758 - [*] detect strategy feature
2024-09-15 01:01:15,040 - number of increase nodes:85, nodes after 2 hop:torch.Size([271]), total nodes this year 871
2024-09-15 01:01:15,974 - [*] Year 2017 Dataset load!
2024-09-15 01:01:15,975 - [*] load from log/PEMS/stkec-43/2016/13.4975.pkl
2024-09-15 01:01:15,978 - [*] EWC! lambda 0.000500
2024-09-15 01:01:18,999 - [*] Year 2017 Training start
2024-09-15 01:01:20,082 - node number torch.Size([34688, 12])
2024-09-15 01:01:21,905 - epoch:0, training loss:1554.4398 validation loss:19.2786
2024-09-15 01:01:24,756 - epoch:1, training loss:1282.5637 validation loss:18.8342
2024-09-15 01:01:27,563 - epoch:2, training loss:1262.1930 validation loss:18.9964
2024-09-15 01:01:30,522 - epoch:3, training loss:1254.1760 validation loss:18.8013
2024-09-15 01:01:33,267 - epoch:4, training loss:1258.6612 validation loss:18.5401
2024-09-15 01:01:36,163 - epoch:5, training loss:1255.2279 validation loss:19.5429
2024-09-15 01:01:38,979 - epoch:6, training loss:1251.4066 validation loss:18.8811
2024-09-15 01:01:41,753 - epoch:7, training loss:1249.3678 validation loss:18.5408
2024-09-15 01:01:44,615 - epoch:8, training loss:1249.7820 validation loss:18.3368
2024-09-15 01:01:47,325 - epoch:9, training loss:1248.5322 validation loss:19.0490
2024-09-15 01:01:50,375 - epoch:10, training loss:1257.0095 validation loss:18.7709
2024-09-15 01:01:53,258 - epoch:11, training loss:1250.9004 validation loss:18.6026
2024-09-15 01:01:56,095 - epoch:12, training loss:1247.0052 validation loss:19.4377
2024-09-15 01:01:58,909 - epoch:13, training loss:1245.4819 validation loss:19.0534
2024-09-15 01:02:01,727 - epoch:14, training loss:1245.2334 validation loss:18.6180
2024-09-15 01:02:02,957 - [*] loss:779.9457
2024-09-15 01:02:02,982 - [*] year 2017, testing
2024-09-15 01:02:03,285 - T:3	MAE	13.5494	RMSE	22.1231	MAPE	19.5475
2024-09-15 01:02:03,870 - T:6	MAE	14.8154	RMSE	24.2957	MAPE	21.0849
2024-09-15 01:02:05,610 - T:12	MAE	17.1602	RMSE	28.1674	MAPE	24.2184
2024-09-15 01:02:05,610 - T:Avg	MAE	14.9442	RMSE	24.4782	MAPE	21.2625
2024-09-15 01:02:05,611 - Finished optimization, total time:26.95 s, best model:log/PEMS/stkec-43/2017/18.3368.pkl
2024-09-15 01:02:05,620 - 


2024-09-15 01:02:05,620 - 3   	 MAE	     12.77	     12.46	     12.30	     13.32	     12.83	     12.26	     13.55		   12.79
2024-09-15 01:02:05,620 - 3   	RMSE	     19.48	     19.32	     19.64	     21.55	     20.59	     21.66	     22.12		   20.62
2024-09-15 01:02:05,620 - 3   	MAPE	     16.74	     18.86	     17.91	     18.37	     17.67	     15.72	     19.55		   17.83
2024-09-15 01:02:05,621 - 6   	 MAE	     13.78	     13.51	     13.49	     14.40	     14.02	     13.38	     14.82		   13.92
2024-09-15 01:02:05,621 - 6   	RMSE	     21.23	     21.15	     21.81	     23.47	     22.86	     23.94	     24.30		   22.68
2024-09-15 01:02:05,621 - 6   	MAPE	     17.78	     20.03	     18.94	     19.80	     19.29	     16.83	     21.08		   19.11
2024-09-15 01:02:05,621 - 12  	 MAE	     15.80	     15.77	     15.86	     16.77	     16.27	     15.64	     17.16		   16.18
2024-09-15 01:02:05,621 - 12  	RMSE	     24.63	     25.00	     25.96	     27.60	     26.85	     27.91	     28.17		   26.59
2024-09-15 01:02:05,621 - 12  	MAPE	     21.14	     23.43	     22.31	     22.58	     22.20	     19.83	     24.22		   22.24
2024-09-15 01:02:05,621 - Avg 	 MAE	     13.92	     13.72	     13.66	     14.60	     14.16	     13.55	     14.94		   14.08
2024-09-15 01:02:05,621 - Avg 	RMSE	     21.44	     21.48	     22.07	     23.80	     23.04	     24.10	     24.48		   22.91
2024-09-15 01:02:05,621 - Avg 	MAPE	     18.24	     20.53	     19.41	     19.98	     19.47	     17.17	     21.26		   19.44
2024-09-15 01:02:05,621 - year	2011	total_time	  111.1359	average_time	    2.2681	epoch	49
2024-09-15 01:02:05,621 - year	2012	total_time	   36.5630	average_time	    1.6620	epoch	22
2024-09-15 01:02:05,621 - year	2013	total_time	   44.5579	average_time	    1.5914	epoch	28
2024-09-15 01:02:05,621 - year	2014	total_time	   26.0890	average_time	    1.7393	epoch	15
2024-09-15 01:02:05,621 - year	2015	total_time	   23.9773	average_time	    1.7127	epoch	14
2024-09-15 01:02:05,622 - year	2016	total_time	   37.1003	average_time	    1.6864	epoch	22
2024-09-15 01:02:05,622 - year	2017	total_time	   26.9499	average_time	    1.7967	epoch	15
2024-09-15 01:02:05,622 - total time: 306.3734
2025-05-09 13:29:18,220 - logger name:log/PEMS/stkec-43/stkec.log
2025-05-09 13:29:18,221 - params : {'conf': 'conf/PEMS/stkec.json', 'seed': 43, 'paral': 0, 'gpuid': 1, 'logname': 'stkec', 'method': 'STKEC', 'load_first_year': 0, 'first_year_model_path': 'log/PEMS3/trafficStream-42/2011/16.6936.pkl', 'device': device(type='cuda', index=1), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>}, 'begin_year': 2011, 'end_year': 2017, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 1, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'influe_length': 168, 'data_process': 0, 'batch_influ_size': 4, 'beita': 1, 'cluster': 24, 'raw_data_path': '/data/weichen/TrafficStream_data/PEMS/RawData/', 'save_data_path': '/data/weichen/TrafficStream_data/PEMS/FastData/', 'graph_path': '/data/weichen/TrafficStream_data/PEMS/graph/', 'model_path': 'log/PEMS/', 'influence_path': "Pleaseenter'outdir'inyourpath", 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'init': True, 'train': 0, 'auto_test': 1, 'strategy': 'incremental', 'increase': True, 'num_hops': 2, 'detect': True, 'detect_strategy': 'feature', 'detect_infl_strategy': True, 'infl_topk': 10, 'adp_adj': False, 'skip_dim': 64, 'end_dim': 64, 'hidden_channels': 32, 'dilation_channels': 64, 'residual_channels': 64, 'input_dim': 1, 'output_dim': 1, 'ewc': True, 'ewc_strategy': 'ewc', 'ewc_lambda': 0.0005, 'replay': True, 'replay_strategy': 'random', 'repaly_num_samples': 100, 'path': 'log/PEMS/stkec-43', 'logger': <Logger utils.initialize (INFO)>}
2025-05-09 13:29:18,233 - [*] Year 2011 load from /data/weichen/TrafficStream_data/PEMS/FastData/2011.npz
2025-05-09 13:29:19,080 - [*] load from log/PEMS/stkec-43/2011/16.071.pkl
2025-05-09 13:30:16,718 - [*] year 2011, testing
2025-05-09 13:30:17,190 - T:3	MAE	12.6988	RMSE	19.3853	MAPE	16.5609
2025-05-09 13:30:17,961 - T:6	MAE	13.6928	RMSE	21.1151	MAPE	17.5893
2025-05-09 13:30:20,174 - T:12	MAE	15.7277	RMSE	24.5371	MAPE	20.8601
2025-05-09 13:30:20,174 - T:Avg	MAE	13.8430	RMSE	21.3394	MAPE	18.0248
2025-05-09 13:30:20,193 - [*] Year 2012 load from /data/weichen/TrafficStream_data/PEMS/FastData/2012.npz
2025-05-09 13:30:20,204 - [*] load from log/PEMS/stkec-43/2011/16.071.pkl
2025-05-09 13:30:20,226 - [*] detect strategy feature
2025-05-09 13:30:23,917 - number of increase nodes:78, nodes after 2 hop:torch.Size([243]), total nodes this year 715
2025-05-09 13:34:35,312 - [*] load from log/PEMS/stkec-43/2012/14.5589.pkl
2025-05-09 13:35:27,378 - [*] year 2012, testing
2025-05-09 13:35:27,768 - T:3	MAE	12.1799	RMSE	18.9949	MAPE	18.3439
2025-05-09 13:35:28,548 - T:6	MAE	13.2103	RMSE	20.8010	MAPE	19.4972
2025-05-09 13:35:30,988 - T:12	MAE	15.3793	RMSE	24.5195	MAPE	22.7973
2025-05-09 13:35:30,988 - T:Avg	MAE	13.3925	RMSE	21.0932	MAPE	19.9765
2025-05-09 13:35:31,008 - [*] Year 2013 load from /data/weichen/TrafficStream_data/PEMS/FastData/2013.npz
2025-05-09 13:35:31,014 - [*] load from log/PEMS/stkec-43/2012/14.5589.pkl
2025-05-09 13:35:31,041 - [*] detect strategy feature
2025-05-09 13:35:34,878 - number of increase nodes:91, nodes after 2 hop:torch.Size([194]), total nodes this year 786
2025-05-09 13:35:34,878 - [*] load from log/PEMS/stkec-43/2013/12.8269.pkl
2025-05-09 13:36:26,051 - [*] year 2013, testing
2025-05-09 13:36:26,480 - T:3	MAE	12.2230	RMSE	19.5386	MAPE	17.4524
2025-05-09 13:36:27,293 - T:6	MAE	13.3923	RMSE	21.6564	MAPE	18.4857
2025-05-09 13:36:29,893 - T:12	MAE	15.7163	RMSE	25.7019	MAPE	21.7730
2025-05-09 13:36:29,893 - T:Avg	MAE	13.5538	RMSE	21.8995	MAPE	18.9352
2025-05-09 13:36:29,915 - [*] Year 2014 load from /data/weichen/TrafficStream_data/PEMS/FastData/2014.npz
2025-05-09 13:36:29,922 - [*] load from log/PEMS/stkec-43/2013/12.8269.pkl
2025-05-09 13:36:29,950 - [*] detect strategy feature
2025-05-09 13:36:34,276 - number of increase nodes:82, nodes after 2 hop:torch.Size([283]), total nodes this year 822
2025-05-09 13:36:34,276 - [*] load from log/PEMS/stkec-43/2014/15.2989.pkl
2025-05-09 13:37:14,057 - [*] year 2014, testing
2025-05-09 13:37:14,407 - T:3	MAE	13.0472	RMSE	20.9365	MAPE	18.2575
2025-05-09 13:37:15,170 - T:6	MAE	14.1371	RMSE	22.8750	MAPE	19.6982
2025-05-09 13:37:17,716 - T:12	MAE	16.4751	RMSE	26.9557	MAPE	22.4620
2025-05-09 13:37:17,716 - T:Avg	MAE	14.3259	RMSE	23.1789	MAPE	19.8654
2025-05-09 13:37:17,738 - [*] Year 2015 load from /data/weichen/TrafficStream_data/PEMS/FastData/2015.npz
2025-05-09 13:37:17,744 - [*] load from log/PEMS/stkec-43/2014/15.2989.pkl
2025-05-09 13:37:17,756 - [*] detect strategy feature
2025-05-09 13:37:22,049 - number of increase nodes:82, nodes after 2 hop:torch.Size([274]), total nodes this year 834
2025-05-09 13:37:22,049 - [*] load from log/PEMS/stkec-43/2015/17.447.pkl
2025-05-09 13:37:44,946 - [*] year 2015, testing
2025-05-09 13:37:45,329 - T:3	MAE	12.7125	RMSE	20.4309	MAPE	17.2870
2025-05-09 13:37:46,086 - T:6	MAE	13.8826	RMSE	22.6392	MAPE	18.8783
2025-05-09 13:37:48,231 - T:12	MAE	16.1019	RMSE	26.5494	MAPE	21.7104
2025-05-09 13:37:48,232 - T:Avg	MAE	14.0197	RMSE	22.8190	MAPE	19.0449
2025-05-09 13:37:48,251 - [*] Year 2016 load from /data/weichen/TrafficStream_data/PEMS/FastData/2016.npz
2025-05-09 13:37:48,257 - [*] load from log/PEMS/stkec-43/2015/17.447.pkl
2025-05-09 13:37:48,268 - [*] detect strategy feature
2025-05-09 13:37:52,344 - number of increase nodes:85, nodes after 2 hop:torch.Size([243]), total nodes this year 850
2025-05-09 13:37:52,344 - [*] load from log/PEMS/stkec-43/2016/13.4975.pkl
2025-05-09 13:38:16,584 - [*] year 2016, testing
2025-05-09 13:38:16,942 - T:3	MAE	12.1047	RMSE	21.4621	MAPE	15.5170
2025-05-09 13:38:17,662 - T:6	MAE	13.2490	RMSE	23.7321	MAPE	16.6442
2025-05-09 13:38:19,858 - T:12	MAE	15.4909	RMSE	27.6586	MAPE	19.6097
2025-05-09 13:38:19,858 - T:Avg	MAE	13.4023	RMSE	23.8791	MAPE	16.9658
2025-05-09 13:38:19,877 - [*] Year 2017 load from /data/weichen/TrafficStream_data/PEMS/FastData/2017.npz
2025-05-09 13:38:19,882 - [*] load from log/PEMS/stkec-43/2016/13.4975.pkl
2025-05-09 13:38:19,894 - [*] detect strategy feature
2025-05-09 13:38:23,832 - number of increase nodes:85, nodes after 2 hop:torch.Size([271]), total nodes this year 871
2025-05-09 13:38:23,833 - [*] load from log/PEMS/stkec-43/2017/18.3368.pkl
2025-05-09 13:38:47,472 - [*] year 2017, testing
2025-05-09 13:38:47,818 - T:3	MAE	13.3996	RMSE	21.9747	MAPE	19.0348
2025-05-09 13:38:48,539 - T:6	MAE	14.6538	RMSE	24.1324	MAPE	20.5421
2025-05-09 13:38:50,735 - T:12	MAE	17.0149	RMSE	28.0181	MAPE	23.6185
2025-05-09 13:38:50,735 - T:Avg	MAE	14.7918	RMSE	24.3237	MAPE	20.7208
2025-05-09 13:38:50,738 - 


2025-05-09 13:38:50,738 - 3   	 MAE	     12.70	     12.18	     12.22	     13.05	     12.71	     12.10	     13.40		   12.62
2025-05-09 13:38:50,738 - 3   	RMSE	     19.39	     18.99	     19.54	     20.94	     20.43	     21.46	     21.97		   20.39
2025-05-09 13:38:50,738 - 3   	MAPE	     16.56	     18.34	     17.45	     18.26	     17.29	     15.52	     19.03		   17.49
2025-05-09 13:38:50,738 - 6   	 MAE	     13.69	     13.21	     13.39	     14.14	     13.88	     13.25	     14.65		   13.75
2025-05-09 13:38:50,738 - 6   	RMSE	     21.12	     20.80	     21.66	     22.88	     22.64	     23.73	     24.13		   22.42
2025-05-09 13:38:50,738 - 6   	MAPE	     17.59	     19.50	     18.49	     19.70	     18.88	     16.64	     20.54		   18.76
2025-05-09 13:38:50,738 - 12  	 MAE	     15.73	     15.38	     15.72	     16.48	     16.10	     15.49	     17.01		   15.99
2025-05-09 13:38:50,739 - 12  	RMSE	     24.54	     24.52	     25.70	     26.96	     26.55	     27.66	     28.02		   26.28
2025-05-09 13:38:50,739 - 12  	MAPE	     20.86	     22.80	     21.77	     22.46	     21.71	     19.61	     23.62		   21.83
2025-05-09 13:38:50,739 - Avg 	 MAE	     13.84	     13.39	     13.55	     14.33	     14.02	     13.40	     14.79		   13.90
2025-05-09 13:38:50,739 - Avg 	RMSE	     21.34	     21.09	     21.90	     23.18	     22.82	     23.88	     24.32		   22.65
2025-05-09 13:38:50,739 - Avg 	MAPE	     18.02	     19.98	     18.94	     19.87	     19.04	     16.97	     20.72		   19.08
2025-05-09 13:38:50,739 - total time: 0.0000
