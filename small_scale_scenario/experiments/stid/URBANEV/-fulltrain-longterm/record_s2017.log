2025-05-08 20:11:53,427 - Namespace(device='cuda:1', dataset='URBANEV', fewshot=100, eval_method='norm', use_long=False, years='2022', seed=2017, bs=64, seq_len=24, horizon=24, input_dim=3, output_dim=1, mode='train', max_epochs=100, patience=10, model_name='stid', init_dim=32, hid_dim=64, end_dim=512, layer=2, lrate=0.001, wdecay=0.0001, dropout=0.1, clip_grad_value=5)
2025-05-08 20:11:53,476 - Data shape: (4344, 275, 3)
2025-05-08 20:11:53,524 - Sample num: 2578, Batch num: 40
2025-05-08 20:11:53,570 - Sample num: 859, Batch num: 13
2025-05-08 20:11:53,616 - Sample num: 860, Batch num: 13
2025-05-08 20:11:54,619 - The arc of model:
STID(
  (time_series_emb_layer): Conv2d(72, 32, kernel_size=(1, 1), stride=(1, 1))
  (encoder): Sequential(
    (0): MultiLayerPerceptron(
      (fc1): Conv2d(96, 96, kernel_size=(1, 1), stride=(1, 1))
      (fc2): Conv2d(96, 96, kernel_size=(1, 1), stride=(1, 1))
      (act): ReLU()
      (drop): Dropout(p=0.15, inplace=False)
    )
    (1): MultiLayerPerceptron(
      (fc1): Conv2d(96, 96, kernel_size=(1, 1), stride=(1, 1))
      (fc2): Conv2d(96, 96, kernel_size=(1, 1), stride=(1, 1))
      (act): ReLU()
      (drop): Dropout(p=0.15, inplace=False)
    )
    (2): MultiLayerPerceptron(
      (fc1): Conv2d(96, 96, kernel_size=(1, 1), stride=(1, 1))
      (fc2): Conv2d(96, 96, kernel_size=(1, 1), stride=(1, 1))
      (act): ReLU()
      (drop): Dropout(p=0.15, inplace=False)
    )
  )
  (regression_layer): Conv2d(96, 24, kernel_size=(1, 1), stride=(1, 1))
)
2025-05-08 20:11:54,619 - Number of total parameters: 70104, tunable parameters: 70104
2025-05-08 20:11:54,620 - The number of parameters: 70104
2025-05-08 20:11:54,620 - Start training!
2025-05-08 20:11:56,687 - Epoch: 001, Train Loss: 7.1280, Train RMSE: 11.5413, Train MAPE: 0.8558, Valid Loss: 3.5979, Valid RMSE: 5.9437, Valid MAPE: 0.3722, Train Time: 1.7209s/epoch, Valid Time: 0.3465s, LR: 1.0000e-03
2025-05-08 20:11:56,689 - Val loss decrease from inf to 3.5979
2025-05-08 20:11:57,830 - Epoch: 002, Train Loss: 3.9052, Train RMSE: 6.8236, Train MAPE: 0.3816, Valid Loss: 2.9482, Valid RMSE: 4.9073, Valid MAPE: 0.3020, Train Time: 0.7982s/epoch, Valid Time: 0.3418s, LR: 1.0000e-03
2025-05-08 20:11:57,832 - Val loss decrease from 3.5979 to 2.9482
2025-05-08 20:11:59,002 - Epoch: 003, Train Loss: 3.5579, Train RMSE: 6.3866, Train MAPE: 0.3373, Valid Loss: 2.8566, Valid RMSE: 4.8076, Valid MAPE: 0.2898, Train Time: 0.8295s/epoch, Valid Time: 0.3407s, LR: 1.0000e-03
2025-05-08 20:11:59,005 - Val loss decrease from 2.9482 to 2.8566
2025-05-08 20:12:00,126 - Epoch: 004, Train Loss: 3.4326, Train RMSE: 6.2475, Train MAPE: 0.3212, Valid Loss: 2.8074, Valid RMSE: 4.7524, Valid MAPE: 0.2848, Train Time: 0.7999s/epoch, Valid Time: 0.3212s, LR: 1.0000e-03
2025-05-08 20:12:00,129 - Val loss decrease from 2.8566 to 2.8074
2025-05-08 20:12:01,286 - Epoch: 005, Train Loss: 3.3634, Train RMSE: 6.1648, Train MAPE: 0.3121, Valid Loss: 2.7924, Valid RMSE: 4.7478, Valid MAPE: 0.2846, Train Time: 0.8160s/epoch, Valid Time: 0.3411s, LR: 1.0000e-03
2025-05-08 20:12:01,289 - Val loss decrease from 2.8074 to 2.7924
2025-05-08 20:12:02,438 - Epoch: 006, Train Loss: 3.2987, Train RMSE: 6.0694, Train MAPE: 0.3057, Valid Loss: 2.7511, Valid RMSE: 4.6597, Valid MAPE: 0.2824, Train Time: 0.8152s/epoch, Valid Time: 0.3342s, LR: 1.0000e-03
2025-05-08 20:12:02,441 - Val loss decrease from 2.7924 to 2.7511
2025-05-08 20:12:03,565 - Epoch: 007, Train Loss: 3.2424, Train RMSE: 5.9916, Train MAPE: 0.3001, Valid Loss: 2.7306, Valid RMSE: 4.6228, Valid MAPE: 0.2789, Train Time: 0.7914s/epoch, Valid Time: 0.3322s, LR: 1.0000e-03
2025-05-08 20:12:03,567 - Val loss decrease from 2.7511 to 2.7306
2025-05-08 20:12:04,757 - Epoch: 008, Train Loss: 3.2099, Train RMSE: 5.9375, Train MAPE: 0.2975, Valid Loss: 2.7320, Valid RMSE: 4.6047, Valid MAPE: 0.2889, Train Time: 0.8156s/epoch, Valid Time: 0.3743s, LR: 1.0000e-03
2025-05-08 20:12:05,897 - Epoch: 009, Train Loss: 3.1837, Train RMSE: 5.8907, Train MAPE: 0.2954, Valid Loss: 2.7249, Valid RMSE: 4.5835, Valid MAPE: 0.2857, Train Time: 0.8231s/epoch, Valid Time: 0.3162s, LR: 1.0000e-03
2025-05-08 20:12:05,899 - Val loss decrease from 2.7306 to 2.7249
2025-05-08 20:12:07,000 - Epoch: 010, Train Loss: 3.1546, Train RMSE: 5.8438, Train MAPE: 0.2923, Valid Loss: 2.7104, Valid RMSE: 4.5776, Valid MAPE: 0.2811, Train Time: 0.7723s/epoch, Valid Time: 0.3281s, LR: 1.0000e-03
2025-05-08 20:12:07,002 - Val loss decrease from 2.7249 to 2.7104
2025-05-08 20:12:08,133 - Epoch: 011, Train Loss: 3.1231, Train RMSE: 5.7973, Train MAPE: 0.2901, Valid Loss: 2.7147, Valid RMSE: 4.5912, Valid MAPE: 0.2754, Train Time: 0.7993s/epoch, Valid Time: 0.3318s, LR: 1.0000e-03
2025-05-08 20:12:09,252 - Epoch: 012, Train Loss: 3.0989, Train RMSE: 5.7534, Train MAPE: 0.2881, Valid Loss: 2.6896, Valid RMSE: 4.5555, Valid MAPE: 0.2752, Train Time: 0.8072s/epoch, Valid Time: 0.3113s, LR: 1.0000e-03
2025-05-08 20:12:09,255 - Val loss decrease from 2.7104 to 2.6896
2025-05-08 20:12:10,396 - Epoch: 013, Train Loss: 3.0829, Train RMSE: 5.7316, Train MAPE: 0.2865, Valid Loss: 2.6995, Valid RMSE: 4.5590, Valid MAPE: 0.2775, Train Time: 0.8028s/epoch, Valid Time: 0.3382s, LR: 1.0000e-03
2025-05-08 20:12:11,492 - Epoch: 014, Train Loss: 3.0682, Train RMSE: 5.7047, Train MAPE: 0.2854, Valid Loss: 2.6862, Valid RMSE: 4.5414, Valid MAPE: 0.2695, Train Time: 0.7701s/epoch, Valid Time: 0.3258s, LR: 1.0000e-03
2025-05-08 20:12:11,495 - Val loss decrease from 2.6896 to 2.6862
2025-05-08 20:12:12,637 - Epoch: 015, Train Loss: 3.0468, Train RMSE: 5.6757, Train MAPE: 0.2834, Valid Loss: 2.6836, Valid RMSE: 4.5361, Valid MAPE: 0.2772, Train Time: 0.8074s/epoch, Valid Time: 0.3346s, LR: 1.0000e-03
2025-05-08 20:12:12,639 - Val loss decrease from 2.6862 to 2.6836
2025-05-08 20:12:13,802 - Epoch: 016, Train Loss: 3.0307, Train RMSE: 5.6502, Train MAPE: 0.2822, Valid Loss: 2.6782, Valid RMSE: 4.5389, Valid MAPE: 0.2686, Train Time: 0.7860s/epoch, Valid Time: 0.3765s, LR: 1.0000e-03
2025-05-08 20:12:13,805 - Val loss decrease from 2.6836 to 2.6782
2025-05-08 20:12:14,963 - Epoch: 017, Train Loss: 3.0159, Train RMSE: 5.6204, Train MAPE: 0.2807, Valid Loss: 2.6903, Valid RMSE: 4.5553, Valid MAPE: 0.2763, Train Time: 0.8273s/epoch, Valid Time: 0.3313s, LR: 1.0000e-03
2025-05-08 20:12:16,122 - Epoch: 018, Train Loss: 3.0044, Train RMSE: 5.6059, Train MAPE: 0.2794, Valid Loss: 2.6651, Valid RMSE: 4.5282, Valid MAPE: 0.2711, Train Time: 0.8241s/epoch, Valid Time: 0.3346s, LR: 1.0000e-03
2025-05-08 20:12:16,125 - Val loss decrease from 2.6782 to 2.6651
2025-05-08 20:12:17,261 - Epoch: 019, Train Loss: 2.9911, Train RMSE: 5.5847, Train MAPE: 0.2779, Valid Loss: 2.6907, Valid RMSE: 4.5567, Valid MAPE: 0.2858, Train Time: 0.7885s/epoch, Valid Time: 0.3475s, LR: 1.0000e-03
2025-05-08 20:12:18,392 - Epoch: 020, Train Loss: 2.9738, Train RMSE: 5.5554, Train MAPE: 0.2765, Valid Loss: 2.6611, Valid RMSE: 4.5243, Valid MAPE: 0.2710, Train Time: 0.7844s/epoch, Valid Time: 0.3464s, LR: 1.0000e-03
2025-05-08 20:12:18,394 - Val loss decrease from 2.6651 to 2.6611
2025-05-08 20:12:19,595 - Epoch: 021, Train Loss: 2.9639, Train RMSE: 5.5424, Train MAPE: 0.2756, Valid Loss: 2.6856, Valid RMSE: 4.5497, Valid MAPE: 0.2857, Train Time: 0.8530s/epoch, Valid Time: 0.3480s, LR: 1.0000e-03
2025-05-08 20:12:20,780 - Epoch: 022, Train Loss: 2.9458, Train RMSE: 5.5088, Train MAPE: 0.2740, Valid Loss: 2.7045, Valid RMSE: 4.5953, Valid MAPE: 0.2779, Train Time: 0.8499s/epoch, Valid Time: 0.3342s, LR: 1.0000e-03
2025-05-08 20:12:21,922 - Epoch: 023, Train Loss: 2.9431, Train RMSE: 5.5025, Train MAPE: 0.2742, Valid Loss: 2.6397, Valid RMSE: 4.4919, Valid MAPE: 0.2657, Train Time: 0.8028s/epoch, Valid Time: 0.3392s, LR: 1.0000e-03
2025-05-08 20:12:21,925 - Val loss decrease from 2.6611 to 2.6397
2025-05-08 20:12:23,061 - Epoch: 024, Train Loss: 2.9342, Train RMSE: 5.4885, Train MAPE: 0.2731, Valid Loss: 2.6568, Valid RMSE: 4.5106, Valid MAPE: 0.2756, Train Time: 0.7950s/epoch, Valid Time: 0.3416s, LR: 1.0000e-03
2025-05-08 20:12:24,173 - Epoch: 025, Train Loss: 2.9237, Train RMSE: 5.4707, Train MAPE: 0.2721, Valid Loss: 2.6570, Valid RMSE: 4.5121, Valid MAPE: 0.2752, Train Time: 0.7645s/epoch, Valid Time: 0.3467s, LR: 1.0000e-03
2025-05-08 20:12:25,317 - Epoch: 026, Train Loss: 2.9174, Train RMSE: 5.4553, Train MAPE: 0.2723, Valid Loss: 2.6383, Valid RMSE: 4.4960, Valid MAPE: 0.2673, Train Time: 0.7928s/epoch, Valid Time: 0.3513s, LR: 1.0000e-03
2025-05-08 20:12:25,320 - Val loss decrease from 2.6397 to 2.6383
2025-05-08 20:12:26,454 - Epoch: 027, Train Loss: 2.9057, Train RMSE: 5.4406, Train MAPE: 0.2705, Valid Loss: 2.6600, Valid RMSE: 4.5273, Valid MAPE: 0.2782, Train Time: 0.8037s/epoch, Valid Time: 0.3302s, LR: 1.0000e-03
2025-05-08 20:12:27,620 - Epoch: 028, Train Loss: 2.9051, Train RMSE: 5.4411, Train MAPE: 0.2699, Valid Loss: 2.6706, Valid RMSE: 4.5226, Valid MAPE: 0.2868, Train Time: 0.8236s/epoch, Valid Time: 0.3421s, LR: 1.0000e-03
2025-05-08 20:12:28,742 - Epoch: 029, Train Loss: 2.8967, Train RMSE: 5.4218, Train MAPE: 0.2693, Valid Loss: 2.6701, Valid RMSE: 4.5397, Valid MAPE: 0.2776, Train Time: 0.8004s/epoch, Valid Time: 0.3217s, LR: 1.0000e-03
2025-05-08 20:12:29,866 - Epoch: 030, Train Loss: 2.8896, Train RMSE: 5.4082, Train MAPE: 0.2689, Valid Loss: 2.6729, Valid RMSE: 4.5395, Valid MAPE: 0.2837, Train Time: 0.7834s/epoch, Valid Time: 0.3400s, LR: 1.0000e-03
2025-05-08 20:12:30,986 - Epoch: 031, Train Loss: 2.8815, Train RMSE: 5.3996, Train MAPE: 0.2680, Valid Loss: 2.6837, Valid RMSE: 4.5840, Valid MAPE: 0.2745, Train Time: 0.7808s/epoch, Valid Time: 0.3391s, LR: 1.0000e-03
2025-05-08 20:12:32,122 - Epoch: 032, Train Loss: 2.8759, Train RMSE: 5.3898, Train MAPE: 0.2674, Valid Loss: 2.6662, Valid RMSE: 4.5510, Valid MAPE: 0.2732, Train Time: 0.8130s/epoch, Valid Time: 0.3227s, LR: 1.0000e-03
2025-05-08 20:12:33,281 - Epoch: 033, Train Loss: 2.8678, Train RMSE: 5.3756, Train MAPE: 0.2671, Valid Loss: 2.6390, Valid RMSE: 4.5029, Valid MAPE: 0.2720, Train Time: 0.8269s/epoch, Valid Time: 0.3319s, LR: 1.0000e-03
2025-05-08 20:12:34,429 - Epoch: 034, Train Loss: 2.8614, Train RMSE: 5.3635, Train MAPE: 0.2668, Valid Loss: 2.6548, Valid RMSE: 4.5311, Valid MAPE: 0.2706, Train Time: 0.7782s/epoch, Valid Time: 0.3697s, LR: 1.0000e-03
2025-05-08 20:12:35,624 - Epoch: 035, Train Loss: 2.8580, Train RMSE: 5.3550, Train MAPE: 0.2657, Valid Loss: 2.6734, Valid RMSE: 4.5269, Valid MAPE: 0.2902, Train Time: 0.8501s/epoch, Valid Time: 0.3443s, LR: 1.0000e-03
2025-05-08 20:12:36,764 - Epoch: 036, Train Loss: 2.8540, Train RMSE: 5.3443, Train MAPE: 0.2674, Valid Loss: 2.6489, Valid RMSE: 4.5159, Valid MAPE: 0.2640, Train Time: 0.7872s/epoch, Valid Time: 0.3529s, LR: 1.0000e-03
2025-05-08 20:12:36,764 - Early stop at epoch 36, loss = 2.638278
2025-05-08 20:12:36,984 - --------------------------------------------------Norm Test Time Results:--------------------------------------------------
2025-05-08 20:12:36,986 - Horizon 1, Test MAE: 1.1946, Test RMSE: 2.3208, Test MAPE: 0.1106
2025-05-08 20:12:36,988 - Horizon 2, Test MAE: 1.5708, Test RMSE: 2.8976, Test MAPE: 0.1506
2025-05-08 20:12:36,991 - Horizon 3, Test MAE: 1.8203, Test RMSE: 3.2589, Test MAPE: 0.1800
2025-05-08 20:12:36,993 - Horizon 4, Test MAE: 2.0154, Test RMSE: 3.5181, Test MAPE: 0.1990
2025-05-08 20:12:36,995 - Horizon 5, Test MAE: 2.1632, Test RMSE: 3.7147, Test MAPE: 0.2188
2025-05-08 20:12:36,997 - Horizon 6, Test MAE: 2.3052, Test RMSE: 3.8924, Test MAPE: 0.2344
2025-05-08 20:12:36,999 - Horizon 7, Test MAE: 2.4258, Test RMSE: 4.0569, Test MAPE: 0.2455
2025-05-08 20:12:37,001 - Horizon 8, Test MAE: 2.5200, Test RMSE: 4.1918, Test MAPE: 0.2562
2025-05-08 20:12:37,004 - Horizon 9, Test MAE: 2.6410, Test RMSE: 4.3670, Test MAPE: 0.2763
2025-05-08 20:12:37,006 - Horizon 10, Test MAE: 2.7116, Test RMSE: 4.4881, Test MAPE: 0.2886
2025-05-08 20:12:37,008 - Horizon 11, Test MAE: 2.7651, Test RMSE: 4.5820, Test MAPE: 0.2906
2025-05-08 20:12:37,010 - Horizon 12, Test MAE: 2.7962, Test RMSE: 4.6411, Test MAPE: 0.2914
2025-05-08 20:12:37,010 - Average Test MAE: 2.2441, Test RMSE: 3.8274, Test MAPE: 0.2285
2025-05-08 20:12:37,010 - Norm Test Time: 0.2119s
