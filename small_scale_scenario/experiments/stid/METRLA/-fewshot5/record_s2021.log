2023-11-27 00:03:10,519 - Namespace(device='cuda:2', dataset='METRLA', fewshot=5, prompt=False, years='2012', seed=2021, bs=64, seq_len=12, horizon=12, input_dim=3, output_dim=1, mode='train', max_epochs=100, patience=10, model_name='stid', init_dim=32, hid_dim=64, end_dim=512, layer=2, lrate=0.001, wdecay=0.0001, dropout=0.1, clip_grad_value=5)
2023-11-27 00:03:11,036 - Data shape: (34272, 207, 3)
2023-11-27 00:03:11,706 - Sample num: 1712, Batch num: 26
2023-11-27 00:03:12,223 - Sample num: 3425, Batch num: 53
2023-11-27 00:03:12,732 - Sample num: 6850, Batch num: 107
2023-11-27 00:03:13,936 - The arc of model:
STID(
  (time_series_emb_layer): Conv2d(36, 32, kernel_size=(1, 1), stride=(1, 1))
  (encoder): Sequential(
    (0): MultiLayerPerceptron(
      (fc1): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1))
      (fc2): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1))
      (act): ReLU()
      (drop): Dropout(p=0.15, inplace=False)
    )
    (1): MultiLayerPerceptron(
      (fc1): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1))
      (fc2): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1))
      (act): ReLU()
      (drop): Dropout(p=0.15, inplace=False)
    )
    (2): MultiLayerPerceptron(
      (fc1): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1))
      (fc2): Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1))
      (act): ReLU()
      (drop): Dropout(p=0.15, inplace=False)
    )
  )
  (regression_layer): Conv2d(128, 12, kernel_size=(1, 1), stride=(1, 1))
)
2023-11-27 00:03:13,936 - The number of parameters: 117868
2023-11-27 00:03:13,936 - Start training!
2023-11-27 00:03:19,203 - Epoch: 001, Train Loss: 6.0685, Train RMSE: 10.1438, Train MAPE: 0.1760, Valid Loss: 4.9109, Valid RMSE: 9.0481, Valid MAPE: 0.1526, Train Time: 3.2378s/epoch, Valid Time: 2.0290s, LR: 1.0000e-03
2023-11-27 00:03:19,206 - Val loss decrease from inf to 4.9109
2023-11-27 00:03:23,695 - Epoch: 002, Train Loss: 4.4221, Train RMSE: 8.4011, Train MAPE: 0.1230, Valid Loss: 4.3716, Valid RMSE: 8.6688, Valid MAPE: 0.1311, Train Time: 2.4184s/epoch, Valid Time: 2.0706s, LR: 1.0000e-03
2023-11-27 00:03:23,698 - Val loss decrease from 4.9109 to 4.3716
2023-11-27 00:03:27,927 - Epoch: 003, Train Loss: 4.0435, Train RMSE: 7.9083, Train MAPE: 0.1151, Valid Loss: 4.0922, Valid RMSE: 8.3146, Valid MAPE: 0.1238, Train Time: 2.2303s/epoch, Valid Time: 1.9982s, LR: 1.0000e-03
2023-11-27 00:03:27,929 - Val loss decrease from 4.3716 to 4.0922
2023-11-27 00:03:31,741 - Epoch: 004, Train Loss: 3.7719, Train RMSE: 7.4397, Train MAPE: 0.1100, Valid Loss: 3.9601, Valid RMSE: 7.8127, Valid MAPE: 0.1290, Train Time: 2.4212s/epoch, Valid Time: 1.3901s, LR: 1.0000e-03
2023-11-27 00:03:31,744 - Val loss decrease from 4.0922 to 3.9601
2023-11-27 00:03:35,967 - Epoch: 005, Train Loss: 3.5912, Train RMSE: 7.0970, Train MAPE: 0.1035, Valid Loss: 3.7957, Valid RMSE: 7.6586, Valid MAPE: 0.1167, Train Time: 2.1965s/epoch, Valid Time: 2.0269s, LR: 1.0000e-03
2023-11-27 00:03:35,970 - Val loss decrease from 3.9601 to 3.7957
2023-11-27 00:03:40,465 - Epoch: 006, Train Loss: 3.4970, Train RMSE: 6.9792, Train MAPE: 0.1000, Valid Loss: 3.7449, Valid RMSE: 7.5648, Valid MAPE: 0.1146, Train Time: 2.4961s/epoch, Valid Time: 1.9981s, LR: 1.0000e-03
2023-11-27 00:03:40,468 - Val loss decrease from 3.7957 to 3.7449
2023-11-27 00:03:44,944 - Epoch: 007, Train Loss: 3.4251, Train RMSE: 6.8746, Train MAPE: 0.0971, Valid Loss: 3.7495, Valid RMSE: 7.5561, Valid MAPE: 0.1206, Train Time: 2.3363s/epoch, Valid Time: 2.1398s, LR: 1.0000e-03
2023-11-27 00:03:48,521 - Epoch: 008, Train Loss: 3.3708, Train RMSE: 6.7944, Train MAPE: 0.0958, Valid Loss: 3.6654, Valid RMSE: 7.5371, Valid MAPE: 0.1159, Train Time: 2.2626s/epoch, Valid Time: 1.3134s, LR: 1.0000e-03
2023-11-27 00:03:48,527 - Val loss decrease from 3.7449 to 3.6654
2023-11-27 00:03:52,886 - Epoch: 009, Train Loss: 3.3236, Train RMSE: 6.7264, Train MAPE: 0.0938, Valid Loss: 3.6347, Valid RMSE: 7.5075, Valid MAPE: 0.1144, Train Time: 2.3242s/epoch, Valid Time: 2.0344s, LR: 1.0000e-03
2023-11-27 00:03:52,889 - Val loss decrease from 3.6654 to 3.6347
2023-11-27 00:03:57,064 - Epoch: 010, Train Loss: 3.2944, Train RMSE: 6.6686, Train MAPE: 0.0934, Valid Loss: 3.6095, Valid RMSE: 7.5251, Valid MAPE: 0.1114, Train Time: 2.3086s/epoch, Valid Time: 1.8653s, LR: 1.0000e-03
2023-11-27 00:03:57,066 - Val loss decrease from 3.6347 to 3.6095
2023-11-27 00:04:01,284 - Epoch: 011, Train Loss: 3.2827, Train RMSE: 6.6676, Train MAPE: 0.0935, Valid Loss: 3.5950, Valid RMSE: 7.5281, Valid MAPE: 0.1096, Train Time: 2.2063s/epoch, Valid Time: 2.0111s, LR: 1.0000e-03
2023-11-27 00:04:01,287 - Val loss decrease from 3.6095 to 3.5950
2023-11-27 00:04:04,677 - Epoch: 012, Train Loss: 3.2320, Train RMSE: 6.5645, Train MAPE: 0.0916, Valid Loss: 3.5974, Valid RMSE: 7.5389, Valid MAPE: 0.1148, Train Time: 1.6221s/epoch, Valid Time: 1.7677s, LR: 1.0000e-03
2023-11-27 00:04:08,942 - Epoch: 013, Train Loss: 3.1926, Train RMSE: 6.5333, Train MAPE: 0.0905, Valid Loss: 3.5790, Valid RMSE: 7.4579, Valid MAPE: 0.1135, Train Time: 2.3314s/epoch, Valid Time: 1.9328s, LR: 1.0000e-03
2023-11-27 00:04:08,945 - Val loss decrease from 3.5950 to 3.5790
2023-11-27 00:04:13,134 - Epoch: 014, Train Loss: 3.1668, Train RMSE: 6.4817, Train MAPE: 0.0895, Valid Loss: 3.5784, Valid RMSE: 7.4644, Valid MAPE: 0.1137, Train Time: 2.3742s/epoch, Valid Time: 1.8148s, LR: 1.0000e-03
2023-11-27 00:04:13,137 - Val loss decrease from 3.5790 to 3.5784
2023-11-27 00:04:17,303 - Epoch: 015, Train Loss: 3.1525, Train RMSE: 6.4421, Train MAPE: 0.0891, Valid Loss: 3.5588, Valid RMSE: 7.4659, Valid MAPE: 0.1129, Train Time: 2.2808s/epoch, Valid Time: 1.8847s, LR: 1.0000e-03
2023-11-27 00:04:17,306 - Val loss decrease from 3.5784 to 3.5588
2023-11-27 00:04:21,388 - Epoch: 016, Train Loss: 3.1306, Train RMSE: 6.4177, Train MAPE: 0.0885, Valid Loss: 3.5620, Valid RMSE: 7.4827, Valid MAPE: 0.1145, Train Time: 2.0670s/epoch, Valid Time: 2.0144s, LR: 1.0000e-03
2023-11-27 00:04:25,970 - Epoch: 017, Train Loss: 3.1033, Train RMSE: 6.3510, Train MAPE: 0.0877, Valid Loss: 3.5207, Valid RMSE: 7.3607, Valid MAPE: 0.1093, Train Time: 2.5069s/epoch, Valid Time: 2.0746s, LR: 1.0000e-03
2023-11-27 00:04:25,977 - Val loss decrease from 3.5588 to 3.5207
2023-11-27 00:04:30,389 - Epoch: 018, Train Loss: 3.0650, Train RMSE: 6.2549, Train MAPE: 0.0856, Valid Loss: 3.5653, Valid RMSE: 7.5037, Valid MAPE: 0.1164, Train Time: 2.4762s/epoch, Valid Time: 1.9357s, LR: 1.0000e-03
2023-11-27 00:04:34,171 - Epoch: 019, Train Loss: 3.0388, Train RMSE: 6.1949, Train MAPE: 0.0851, Valid Loss: 3.5463, Valid RMSE: 7.4369, Valid MAPE: 0.1137, Train Time: 2.0455s/epoch, Valid Time: 1.7364s, LR: 1.0000e-03
2023-11-27 00:04:38,163 - Epoch: 020, Train Loss: 3.0111, Train RMSE: 6.1206, Train MAPE: 0.0839, Valid Loss: 3.5345, Valid RMSE: 7.3512, Valid MAPE: 0.1147, Train Time: 1.9640s/epoch, Valid Time: 2.0281s, LR: 1.0000e-03
2023-11-27 00:04:42,363 - Epoch: 021, Train Loss: 2.9649, Train RMSE: 5.9970, Train MAPE: 0.0821, Valid Loss: 3.5280, Valid RMSE: 7.3695, Valid MAPE: 0.1135, Train Time: 2.2603s/epoch, Valid Time: 1.9391s, LR: 1.0000e-03
2023-11-27 00:04:46,244 - Epoch: 022, Train Loss: 2.9449, Train RMSE: 5.9421, Train MAPE: 0.0813, Valid Loss: 3.5697, Valid RMSE: 7.4609, Valid MAPE: 0.1167, Train Time: 1.9943s/epoch, Valid Time: 1.8859s, LR: 1.0000e-03
2023-11-27 00:04:50,027 - Epoch: 023, Train Loss: 2.9105, Train RMSE: 5.8680, Train MAPE: 0.0802, Valid Loss: 3.5830, Valid RMSE: 7.4619, Valid MAPE: 0.1169, Train Time: 1.8168s/epoch, Valid Time: 1.9658s, LR: 1.0000e-03
2023-11-27 00:04:54,088 - Epoch: 024, Train Loss: 2.8931, Train RMSE: 5.8115, Train MAPE: 0.0792, Valid Loss: 3.5717, Valid RMSE: 7.4681, Valid MAPE: 0.1156, Train Time: 2.0134s/epoch, Valid Time: 2.0472s, LR: 1.0000e-03
2023-11-27 00:04:57,487 - Epoch: 025, Train Loss: 2.8702, Train RMSE: 5.7499, Train MAPE: 0.0784, Valid Loss: 3.5056, Valid RMSE: 7.3363, Valid MAPE: 0.1117, Train Time: 1.6706s/epoch, Valid Time: 1.7272s, LR: 1.0000e-03
2023-11-27 00:04:57,492 - Val loss decrease from 3.5207 to 3.5056
2023-11-27 00:05:01,113 - Epoch: 026, Train Loss: 2.8386, Train RMSE: 5.6824, Train MAPE: 0.0771, Valid Loss: 3.5702, Valid RMSE: 7.4973, Valid MAPE: 0.1144, Train Time: 2.0021s/epoch, Valid Time: 1.6187s, LR: 1.0000e-03
2023-11-27 00:05:05,508 - Epoch: 027, Train Loss: 2.8233, Train RMSE: 5.6377, Train MAPE: 0.0766, Valid Loss: 3.5946, Valid RMSE: 7.5505, Valid MAPE: 0.1164, Train Time: 2.3668s/epoch, Valid Time: 2.0270s, LR: 1.0000e-03
2023-11-27 00:05:09,492 - Epoch: 028, Train Loss: 2.8064, Train RMSE: 5.6061, Train MAPE: 0.0760, Valid Loss: 3.6326, Valid RMSE: 7.6746, Valid MAPE: 0.1193, Train Time: 2.1726s/epoch, Valid Time: 1.8114s, LR: 1.0000e-03
2023-11-27 00:05:13,369 - Epoch: 029, Train Loss: 2.7770, Train RMSE: 5.5344, Train MAPE: 0.0748, Valid Loss: 3.6269, Valid RMSE: 7.6987, Valid MAPE: 0.1186, Train Time: 2.0442s/epoch, Valid Time: 1.8324s, LR: 1.0000e-03
2023-11-27 00:05:16,362 - Epoch: 030, Train Loss: 2.7694, Train RMSE: 5.5230, Train MAPE: 0.0748, Valid Loss: 3.6959, Valid RMSE: 7.8293, Valid MAPE: 0.1231, Train Time: 1.5083s/epoch, Valid Time: 1.4840s, LR: 1.0000e-03
2023-11-27 00:05:20,425 - Epoch: 031, Train Loss: 2.7634, Train RMSE: 5.4958, Train MAPE: 0.0745, Valid Loss: 3.6350, Valid RMSE: 7.6581, Valid MAPE: 0.1170, Train Time: 2.0952s/epoch, Valid Time: 1.9681s, LR: 1.0000e-03
2023-11-27 00:05:24,566 - Epoch: 032, Train Loss: 2.7395, Train RMSE: 5.4454, Train MAPE: 0.0735, Valid Loss: 3.6963, Valid RMSE: 7.8385, Valid MAPE: 0.1214, Train Time: 2.3415s/epoch, Valid Time: 1.7993s, LR: 1.0000e-03
2023-11-27 00:05:28,881 - Epoch: 033, Train Loss: 2.7253, Train RMSE: 5.3971, Train MAPE: 0.0727, Valid Loss: 3.7088, Valid RMSE: 7.8420, Valid MAPE: 0.1235, Train Time: 2.3039s/epoch, Valid Time: 2.0104s, LR: 1.0000e-03
2023-11-27 00:05:32,166 - Epoch: 034, Train Loss: 2.7110, Train RMSE: 5.3733, Train MAPE: 0.0723, Valid Loss: 3.7157, Valid RMSE: 7.8982, Valid MAPE: 0.1233, Train Time: 1.8065s/epoch, Valid Time: 1.4787s, LR: 1.0000e-03
2023-11-27 00:05:36,918 - Epoch: 035, Train Loss: 2.7055, Train RMSE: 5.3623, Train MAPE: 0.0723, Valid Loss: 3.7318, Valid RMSE: 7.9206, Valid MAPE: 0.1236, Train Time: 2.6573s/epoch, Valid Time: 2.0944s, LR: 1.0000e-03
2023-11-27 00:05:36,918 - Early stop at epoch 35, loss = 3.505597
2023-11-27 00:05:40,631 - Horizon 1, Test MAE: 2.7274, Test RMSE: 5.1824, Test MAPE: 0.0789
2023-11-27 00:05:40,643 - Horizon 2, Test MAE: 3.0666, Test RMSE: 5.9613, Test MAPE: 0.0896
2023-11-27 00:05:40,652 - Horizon 3, Test MAE: 3.2954, Test RMSE: 6.5417, Test MAPE: 0.0988
2023-11-27 00:05:40,661 - Horizon 4, Test MAE: 3.5113, Test RMSE: 7.0059, Test MAPE: 0.1067
2023-11-27 00:05:40,670 - Horizon 5, Test MAE: 3.6730, Test RMSE: 7.4347, Test MAPE: 0.1140
2023-11-27 00:05:40,678 - Horizon 6, Test MAE: 3.8444, Test RMSE: 7.8010, Test MAPE: 0.1211
2023-11-27 00:05:40,686 - Horizon 7, Test MAE: 3.9679, Test RMSE: 8.1340, Test MAPE: 0.1266
2023-11-27 00:05:40,694 - Horizon 8, Test MAE: 4.0927, Test RMSE: 8.4061, Test MAPE: 0.1317
2023-11-27 00:05:40,702 - Horizon 9, Test MAE: 4.1683, Test RMSE: 8.5703, Test MAPE: 0.1345
2023-11-27 00:05:40,710 - Horizon 10, Test MAE: 4.2758, Test RMSE: 8.7677, Test MAPE: 0.1386
2023-11-27 00:05:40,718 - Horizon 11, Test MAE: 4.3392, Test RMSE: 8.8743, Test MAPE: 0.1412
2023-11-27 00:05:40,726 - Horizon 12, Test MAE: 4.4290, Test RMSE: 9.0514, Test MAPE: 0.1446
2023-11-27 00:05:40,726 - Average Test MAE: 3.7826, Test RMSE: 7.6442, Test MAPE: 0.1189
