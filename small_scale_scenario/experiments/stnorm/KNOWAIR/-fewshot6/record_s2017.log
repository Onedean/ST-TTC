2025-05-08 02:01:35,383 - Namespace(device='cuda:2', dataset='KNOWAIR', fewshot=6, eval_method='norm', years='2015', seed=2017, bs=64, seq_len=12, horizon=12, input_dim=3, output_dim=1, mode='train', max_epochs=100, patience=10, model_name='stnorm', tnorm_bool=True, snorm_bool=True, channels=32, kernel_size=2, blocks=4, layers=2, lrate=0.001, wdecay=0.0001, dropout=0.1, clip_grad_value=5)
2025-05-08 02:01:35,549 - Data shape: (11688, 184, 3)
2025-05-08 02:01:35,669 - Sample num: 700, Batch num: 10
2025-05-08 02:01:35,759 - Sample num: 2333, Batch num: 36
2025-05-08 02:01:35,849 - Sample num: 2333, Batch num: 36
2025-05-08 02:01:37,083 - The arc of model:
STNORM(
  (filter_convs): ModuleList(
    (0): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1))
    (1): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (2): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1))
    (3): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (4): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1))
    (5): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (6): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1))
    (7): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
  )
  (gate_convs): ModuleList(
    (0): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1))
    (1): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (2): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1))
    (3): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (4): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1))
    (5): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (6): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1))
    (7): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
  )
  (residual_convs): ModuleList(
    (0-7): 8 x Conv2d(32, 32, kernel_size=(1, 1), stride=(1, 1))
  )
  (skip_convs): ModuleList(
    (0-7): 8 x Conv2d(32, 32, kernel_size=(1, 1), stride=(1, 1))
  )
  (sn): ModuleList(
    (0-7): 8 x SNorm()
  )
  (tn): ModuleList(
    (0-7): 8 x TNorm()
  )
  (start_conv): Conv2d(3, 32, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_1): Conv2d(32, 32, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_2): Conv2d(32, 12, kernel_size=(1, 1), stride=(1, 1))
)
2025-05-08 02:01:37,084 - Number of total parameters: 212012, tunable parameters: 212012
2025-05-08 02:01:37,084 - The number of parameters: 212012
2025-05-08 02:01:37,084 - Start training!
2025-05-08 02:01:41,916 - Epoch: 001, Train Loss: 37.9088, Train RMSE: 53.8730, Train MAPE: 0.8002, Valid Loss: 27.9181, Valid RMSE: 38.2299, Valid MAPE: 1.0947, Train Time: 2.4133s/epoch, Valid Time: 2.4186s, LR: 1.0000e-03
2025-05-08 02:01:41,927 - Val loss decrease from inf to 27.9181
2025-05-08 02:01:47,018 - Epoch: 002, Train Loss: 33.1137, Train RMSE: 49.8417, Train MAPE: 0.5983, Valid Loss: 23.6053, Valid RMSE: 34.3133, Valid MAPE: 0.8646, Train Time: 2.6717s/epoch, Valid Time: 2.4197s, LR: 1.0000e-03
2025-05-08 02:01:47,029 - Val loss decrease from 27.9181 to 23.6053
2025-05-08 02:01:51,891 - Epoch: 003, Train Loss: 31.0839, Train RMSE: 46.5747, Train MAPE: 0.5981, Valid Loss: 22.3847, Valid RMSE: 32.5923, Valid MAPE: 0.8275, Train Time: 2.5152s/epoch, Valid Time: 2.3459s, LR: 1.0000e-03
2025-05-08 02:01:51,902 - Val loss decrease from 23.6053 to 22.3847
2025-05-08 02:01:57,004 - Epoch: 004, Train Loss: 29.9340, Train RMSE: 44.5704, Train MAPE: 0.5842, Valid Loss: 21.0359, Valid RMSE: 31.7093, Valid MAPE: 0.7145, Train Time: 2.6534s/epoch, Valid Time: 2.4483s, LR: 1.0000e-03
2025-05-08 02:01:57,015 - Val loss decrease from 22.3847 to 21.0359
2025-05-08 02:02:01,852 - Epoch: 005, Train Loss: 29.4200, Train RMSE: 43.6367, Train MAPE: 0.5803, Valid Loss: 21.3132, Valid RMSE: 31.6279, Valid MAPE: 0.7492, Train Time: 2.5190s/epoch, Valid Time: 2.3181s, LR: 1.0000e-03
2025-05-08 02:02:06,864 - Epoch: 006, Train Loss: 28.6448, Train RMSE: 42.5953, Train MAPE: 0.5670, Valid Loss: 21.2129, Valid RMSE: 31.6551, Valid MAPE: 0.7305, Train Time: 2.6103s/epoch, Valid Time: 2.4008s, LR: 1.0000e-03
2025-05-08 02:02:11,849 - Epoch: 007, Train Loss: 28.4350, Train RMSE: 42.2841, Train MAPE: 0.5673, Valid Loss: 22.9480, Valid RMSE: 32.4829, Valid MAPE: 0.8727, Train Time: 2.7093s/epoch, Valid Time: 2.2756s, LR: 1.0000e-03
2025-05-08 02:02:16,897 - Epoch: 008, Train Loss: 27.9916, Train RMSE: 41.4534, Train MAPE: 0.5643, Valid Loss: 22.3197, Valid RMSE: 32.3275, Valid MAPE: 0.8268, Train Time: 2.6276s/epoch, Valid Time: 2.4205s, LR: 1.0000e-03
2025-05-08 02:02:21,898 - Epoch: 009, Train Loss: 27.8255, Train RMSE: 41.4246, Train MAPE: 0.5499, Valid Loss: 22.6350, Valid RMSE: 32.7853, Valid MAPE: 0.8370, Train Time: 2.7183s/epoch, Valid Time: 2.2829s, LR: 1.0000e-03
2025-05-08 02:02:26,842 - Epoch: 010, Train Loss: 27.3394, Train RMSE: 40.8185, Train MAPE: 0.5420, Valid Loss: 21.9187, Valid RMSE: 32.2135, Valid MAPE: 0.7853, Train Time: 2.5773s/epoch, Valid Time: 2.3664s, LR: 1.0000e-03
2025-05-08 02:02:31,816 - Epoch: 011, Train Loss: 27.0472, Train RMSE: 40.5345, Train MAPE: 0.5286, Valid Loss: 21.9672, Valid RMSE: 32.2976, Valid MAPE: 0.7795, Train Time: 2.6986s/epoch, Valid Time: 2.2745s, LR: 1.0000e-03
2025-05-08 02:02:36,778 - Epoch: 012, Train Loss: 27.1795, Train RMSE: 40.7446, Train MAPE: 0.5290, Valid Loss: 20.8349, Valid RMSE: 31.7227, Valid MAPE: 0.6898, Train Time: 2.6221s/epoch, Valid Time: 2.3401s, LR: 1.0000e-03
2025-05-08 02:02:36,789 - Val loss decrease from 21.0359 to 20.8349
2025-05-08 02:02:41,828 - Epoch: 013, Train Loss: 26.7899, Train RMSE: 40.0719, Train MAPE: 0.5330, Valid Loss: 20.7947, Valid RMSE: 31.9890, Valid MAPE: 0.6644, Train Time: 2.7360s/epoch, Valid Time: 2.3028s, LR: 1.0000e-03
2025-05-08 02:02:41,839 - Val loss decrease from 20.8349 to 20.7947
2025-05-08 02:02:46,771 - Epoch: 014, Train Loss: 26.8348, Train RMSE: 40.3679, Train MAPE: 0.5197, Valid Loss: 22.1750, Valid RMSE: 32.5896, Valid MAPE: 0.7956, Train Time: 2.6079s/epoch, Valid Time: 2.3241s, LR: 1.0000e-03
2025-05-08 02:02:51,893 - Epoch: 015, Train Loss: 26.6539, Train RMSE: 39.9501, Train MAPE: 0.5171, Valid Loss: 23.9728, Valid RMSE: 33.9395, Valid MAPE: 0.9221, Train Time: 2.7257s/epoch, Valid Time: 2.3953s, LR: 1.0000e-03
2025-05-08 02:02:56,679 - Epoch: 016, Train Loss: 26.2201, Train RMSE: 39.4363, Train MAPE: 0.5015, Valid Loss: 22.0825, Valid RMSE: 32.7313, Valid MAPE: 0.7799, Train Time: 2.4650s/epoch, Valid Time: 2.3206s, LR: 1.0000e-03
2025-05-08 02:03:01,801 - Epoch: 017, Train Loss: 25.9667, Train RMSE: 38.9530, Train MAPE: 0.5010, Valid Loss: 21.7697, Valid RMSE: 32.5267, Valid MAPE: 0.7464, Train Time: 2.7364s/epoch, Valid Time: 2.3862s, LR: 1.0000e-03
2025-05-08 02:03:06,631 - Epoch: 018, Train Loss: 25.6196, Train RMSE: 38.5544, Train MAPE: 0.4944, Valid Loss: 22.0179, Valid RMSE: 32.9271, Valid MAPE: 0.7364, Train Time: 2.5144s/epoch, Valid Time: 2.3148s, LR: 1.0000e-03
2025-05-08 02:03:11,755 - Epoch: 019, Train Loss: 25.3535, Train RMSE: 38.2517, Train MAPE: 0.4909, Valid Loss: 23.5817, Valid RMSE: 34.4775, Valid MAPE: 0.8591, Train Time: 2.7014s/epoch, Valid Time: 2.4225s, LR: 1.0000e-03
2025-05-08 02:03:16,604 - Epoch: 020, Train Loss: 25.7239, Train RMSE: 38.6377, Train MAPE: 0.4925, Valid Loss: 22.9587, Valid RMSE: 33.6434, Valid MAPE: 0.8336, Train Time: 2.5430s/epoch, Valid Time: 2.3060s, LR: 1.0000e-03
2025-05-08 02:03:21,678 - Epoch: 021, Train Loss: 25.1461, Train RMSE: 37.8187, Train MAPE: 0.4897, Valid Loss: 21.8515, Valid RMSE: 32.9904, Valid MAPE: 0.7105, Train Time: 2.6712s/epoch, Valid Time: 2.4024s, LR: 1.0000e-03
2025-05-08 02:03:25,989 - Epoch: 022, Train Loss: 24.9729, Train RMSE: 37.5064, Train MAPE: 0.4896, Valid Loss: 22.5740, Valid RMSE: 33.7100, Valid MAPE: 0.7799, Train Time: 2.2644s/epoch, Valid Time: 2.0467s, LR: 1.0000e-03
2025-05-08 02:03:29,582 - Epoch: 023, Train Loss: 24.7517, Train RMSE: 37.5588, Train MAPE: 0.4586, Valid Loss: 25.4184, Valid RMSE: 36.3046, Valid MAPE: 0.9485, Train Time: 1.8711s/epoch, Valid Time: 1.7217s, LR: 1.0000e-03
2025-05-08 02:03:29,583 - Early stop at epoch 23, loss = 20.794718
2025-05-08 02:03:31,419 - --------------------------------------------------Norm Test Time Results:--------------------------------------------------
2025-05-08 02:03:31,424 - Horizon 1, Test MAE: 9.4625, Test RMSE: 15.1445, Test MAPE: 0.3013
2025-05-08 02:03:31,428 - Horizon 2, Test MAE: 12.3572, Test RMSE: 19.4361, Test MAPE: 0.4216
2025-05-08 02:03:31,432 - Horizon 3, Test MAE: 14.6253, Test RMSE: 22.3028, Test MAPE: 0.5159
2025-05-08 02:03:31,436 - Horizon 4, Test MAE: 16.0251, Test RMSE: 24.0461, Test MAPE: 0.5718
2025-05-08 02:03:31,439 - Horizon 5, Test MAE: 16.9120, Test RMSE: 25.0641, Test MAPE: 0.6341
2025-05-08 02:03:31,443 - Horizon 6, Test MAE: 17.6345, Test RMSE: 25.8621, Test MAPE: 0.6804
2025-05-08 02:03:31,446 - Horizon 7, Test MAE: 18.1321, Test RMSE: 26.4412, Test MAPE: 0.7159
2025-05-08 02:03:31,450 - Horizon 8, Test MAE: 18.4504, Test RMSE: 26.8474, Test MAPE: 0.7329
2025-05-08 02:03:31,453 - Horizon 9, Test MAE: 19.4268, Test RMSE: 27.5705, Test MAPE: 0.7992
2025-05-08 02:03:31,457 - Horizon 10, Test MAE: 20.2709, Test RMSE: 28.4278, Test MAPE: 0.8420
2025-05-08 02:03:31,460 - Horizon 11, Test MAE: 21.0957, Test RMSE: 29.3029, Test MAPE: 0.8900
2025-05-08 02:03:31,463 - Horizon 12, Test MAE: 21.8184, Test RMSE: 29.8561, Test MAPE: 0.9449
2025-05-08 02:03:31,464 - Average Test MAE: 17.1842, Test RMSE: 25.0251, Test MAPE: 0.6708
2025-05-08 02:03:31,464 - Norm Test Time: 1.4097s
