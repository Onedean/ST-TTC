2025-05-07 23:38:02,995 - Namespace(device='cuda:2', dataset='KNOWAIR', fewshot=100, eval_method='norm', years='2015', seed=2019, bs=64, seq_len=12, horizon=12, input_dim=3, output_dim=1, mode='train', max_epochs=100, patience=10, model_name='stnorm', tnorm_bool=True, snorm_bool=True, channels=32, kernel_size=2, blocks=4, layers=2, lrate=0.001, wdecay=0.0001, dropout=0.1, clip_grad_value=5)
2025-05-07 23:38:03,097 - Data shape: (11688, 184, 3)
2025-05-07 23:38:03,214 - Sample num: 6999, Batch num: 109
2025-05-07 23:38:03,331 - Sample num: 2333, Batch num: 36
2025-05-07 23:38:03,424 - Sample num: 2333, Batch num: 36
2025-05-07 23:38:04,657 - The arc of model:
STNORM(
  (filter_convs): ModuleList(
    (0): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1))
    (1): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (2): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1))
    (3): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (4): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1))
    (5): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (6): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1))
    (7): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
  )
  (gate_convs): ModuleList(
    (0): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1))
    (1): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (2): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1))
    (3): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (4): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1))
    (5): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (6): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1))
    (7): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
  )
  (residual_convs): ModuleList(
    (0-7): 8 x Conv2d(32, 32, kernel_size=(1, 1), stride=(1, 1))
  )
  (skip_convs): ModuleList(
    (0-7): 8 x Conv2d(32, 32, kernel_size=(1, 1), stride=(1, 1))
  )
  (sn): ModuleList(
    (0-7): 8 x SNorm()
  )
  (tn): ModuleList(
    (0-7): 8 x TNorm()
  )
  (start_conv): Conv2d(3, 32, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_1): Conv2d(32, 32, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_2): Conv2d(32, 12, kernel_size=(1, 1), stride=(1, 1))
)
2025-05-07 23:38:04,658 - Number of total parameters: 212012, tunable parameters: 212012
2025-05-07 23:38:04,658 - The number of parameters: 212012
2025-05-07 23:38:04,658 - Start training!
2025-05-07 23:38:35,732 - Epoch: 001, Train Loss: 24.2762, Train RMSE: 38.6121, Train MAPE: 0.6452, Valid Loss: 19.4895, Valid RMSE: 30.7138, Valid MAPE: 0.5684, Train Time: 28.7667s/epoch, Valid Time: 2.3071s, LR: 1.0000e-03
2025-05-07 23:38:35,742 - Val loss decrease from inf to 19.4895
2025-05-07 23:39:07,027 - Epoch: 002, Train Loss: 21.9864, Train RMSE: 35.5695, Train MAPE: 0.5519, Valid Loss: 19.1457, Valid RMSE: 30.2671, Valid MAPE: 0.5606, Train Time: 28.9920s/epoch, Valid Time: 2.2931s, LR: 1.0000e-03
2025-05-07 23:39:07,038 - Val loss decrease from 19.4895 to 19.1457
2025-05-07 23:39:38,340 - Epoch: 003, Train Loss: 21.6180, Train RMSE: 35.0614, Train MAPE: 0.5391, Valid Loss: 18.8331, Valid RMSE: 29.7140, Valid MAPE: 0.5874, Train Time: 29.0008s/epoch, Valid Time: 2.3005s, LR: 1.0000e-03
2025-05-07 23:39:38,350 - Val loss decrease from 19.1457 to 18.8331
2025-05-07 23:40:09,698 - Epoch: 004, Train Loss: 21.2706, Train RMSE: 34.4809, Train MAPE: 0.5298, Valid Loss: 18.8641, Valid RMSE: 29.6029, Valid MAPE: 0.6086, Train Time: 29.0655s/epoch, Valid Time: 2.2820s, LR: 1.0000e-03
2025-05-07 23:40:41,044 - Epoch: 005, Train Loss: 20.9757, Train RMSE: 33.9907, Train MAPE: 0.5230, Valid Loss: 18.8768, Valid RMSE: 31.5269, Valid MAPE: 0.5118, Train Time: 29.0403s/epoch, Valid Time: 2.3061s, LR: 1.0000e-03
2025-05-07 23:41:12,350 - Epoch: 006, Train Loss: 20.7634, Train RMSE: 33.5969, Train MAPE: 0.5167, Valid Loss: 18.3376, Valid RMSE: 29.3655, Valid MAPE: 0.5561, Train Time: 29.0065s/epoch, Valid Time: 2.2991s, LR: 1.0000e-03
2025-05-07 23:41:12,360 - Val loss decrease from 18.8331 to 18.3376
2025-05-07 23:41:43,616 - Epoch: 007, Train Loss: 20.4988, Train RMSE: 33.1867, Train MAPE: 0.5082, Valid Loss: 18.3271, Valid RMSE: 28.9674, Valid MAPE: 0.5758, Train Time: 28.9243s/epoch, Valid Time: 2.3317s, LR: 1.0000e-03
2025-05-07 23:41:43,627 - Val loss decrease from 18.3376 to 18.3271
2025-05-07 23:42:14,902 - Epoch: 008, Train Loss: 20.2580, Train RMSE: 32.7938, Train MAPE: 0.4996, Valid Loss: 18.5577, Valid RMSE: 29.2239, Valid MAPE: 0.5838, Train Time: 28.9807s/epoch, Valid Time: 2.2942s, LR: 1.0000e-03
2025-05-07 23:42:46,152 - Epoch: 009, Train Loss: 20.0048, Train RMSE: 32.3571, Train MAPE: 0.4935, Valid Loss: 18.6653, Valid RMSE: 29.1595, Valid MAPE: 0.6038, Train Time: 28.9745s/epoch, Valid Time: 2.2751s, LR: 1.0000e-03
2025-05-07 23:43:17,440 - Epoch: 010, Train Loss: 19.7771, Train RMSE: 31.9815, Train MAPE: 0.4859, Valid Loss: 18.4729, Valid RMSE: 31.1822, Valid MAPE: 0.5058, Train Time: 29.0144s/epoch, Valid Time: 2.2737s, LR: 1.0000e-03
2025-05-07 23:43:48,683 - Epoch: 011, Train Loss: 19.6127, Train RMSE: 31.7004, Train MAPE: 0.4799, Valid Loss: 18.2372, Valid RMSE: 29.8610, Valid MAPE: 0.4953, Train Time: 28.8692s/epoch, Valid Time: 2.3732s, LR: 1.0000e-03
2025-05-07 23:43:48,693 - Val loss decrease from 18.3271 to 18.2372
2025-05-07 23:44:19,846 - Epoch: 012, Train Loss: 19.3424, Train RMSE: 31.3088, Train MAPE: 0.4715, Valid Loss: 18.3951, Valid RMSE: 29.9317, Valid MAPE: 0.5497, Train Time: 28.8521s/epoch, Valid Time: 2.3015s, LR: 1.0000e-03
2025-05-07 23:44:51,192 - Epoch: 013, Train Loss: 19.1320, Train RMSE: 30.9289, Train MAPE: 0.4650, Valid Loss: 18.3152, Valid RMSE: 30.2977, Valid MAPE: 0.5010, Train Time: 29.0681s/epoch, Valid Time: 2.2769s, LR: 1.0000e-03
2025-05-07 23:45:22,324 - Epoch: 014, Train Loss: 18.9236, Train RMSE: 30.6437, Train MAPE: 0.4582, Valid Loss: 17.9309, Valid RMSE: 28.8892, Valid MAPE: 0.5309, Train Time: 28.8720s/epoch, Valid Time: 2.2597s, LR: 1.0000e-03
2025-05-07 23:45:22,334 - Val loss decrease from 18.2372 to 17.9309
2025-05-07 23:45:53,586 - Epoch: 015, Train Loss: 18.8279, Train RMSE: 30.4139, Train MAPE: 0.4556, Valid Loss: 18.2777, Valid RMSE: 28.8910, Valid MAPE: 0.5819, Train Time: 28.9572s/epoch, Valid Time: 2.2947s, LR: 1.0000e-03
2025-05-07 23:46:24,657 - Epoch: 016, Train Loss: 18.5985, Train RMSE: 30.0863, Train MAPE: 0.4493, Valid Loss: 18.3568, Valid RMSE: 30.8760, Valid MAPE: 0.4820, Train Time: 28.8249s/epoch, Valid Time: 2.2459s, LR: 1.0000e-03
2025-05-07 23:46:55,829 - Epoch: 017, Train Loss: 18.4525, Train RMSE: 29.8590, Train MAPE: 0.4443, Valid Loss: 18.3534, Valid RMSE: 30.2573, Valid MAPE: 0.4852, Train Time: 28.9130s/epoch, Valid Time: 2.2590s, LR: 1.0000e-03
2025-05-07 23:47:27,001 - Epoch: 018, Train Loss: 18.3269, Train RMSE: 29.6373, Train MAPE: 0.4414, Valid Loss: 18.3040, Valid RMSE: 29.4996, Valid MAPE: 0.5510, Train Time: 28.8539s/epoch, Valid Time: 2.3176s, LR: 1.0000e-03
2025-05-07 23:47:53,826 - Epoch: 019, Train Loss: 18.1901, Train RMSE: 29.4229, Train MAPE: 0.4359, Valid Loss: 18.1723, Valid RMSE: 29.7153, Valid MAPE: 0.5257, Train Time: 24.8375s/epoch, Valid Time: 1.9871s, LR: 1.0000e-03
2025-05-07 23:48:20,079 - Epoch: 020, Train Loss: 18.0694, Train RMSE: 29.2427, Train MAPE: 0.4326, Valid Loss: 19.0495, Valid RMSE: 30.0755, Valid MAPE: 0.5871, Train Time: 24.2561s/epoch, Valid Time: 1.9969s, LR: 1.0000e-03
2025-05-07 23:48:46,307 - Epoch: 021, Train Loss: 17.9845, Train RMSE: 29.0560, Train MAPE: 0.4311, Valid Loss: 18.8518, Valid RMSE: 30.2531, Valid MAPE: 0.5965, Train Time: 24.2780s/epoch, Valid Time: 1.9497s, LR: 1.0000e-03
2025-05-07 23:49:12,660 - Epoch: 022, Train Loss: 17.8417, Train RMSE: 28.8901, Train MAPE: 0.4249, Valid Loss: 18.6178, Valid RMSE: 29.9923, Valid MAPE: 0.5580, Train Time: 24.3785s/epoch, Valid Time: 1.9745s, LR: 1.0000e-03
2025-05-07 23:49:39,019 - Epoch: 023, Train Loss: 17.6851, Train RMSE: 28.6086, Train MAPE: 0.4230, Valid Loss: 18.6679, Valid RMSE: 30.8542, Valid MAPE: 0.5086, Train Time: 24.3915s/epoch, Valid Time: 1.9675s, LR: 1.0000e-03
2025-05-07 23:50:00,997 - Epoch: 024, Train Loss: 17.6133, Train RMSE: 28.4723, Train MAPE: 0.4207, Valid Loss: 18.6293, Valid RMSE: 29.9640, Valid MAPE: 0.5573, Train Time: 20.2670s/epoch, Valid Time: 1.7101s, LR: 1.0000e-03
2025-05-07 23:50:00,997 - Early stop at epoch 24, loss = 17.930862
2025-05-07 23:50:03,369 - --------------------------------------------------Norm Test Time Results:--------------------------------------------------
2025-05-07 23:50:03,373 - Horizon 1, Test MAE: 8.1878, Test RMSE: 13.7394, Test MAPE: 0.2803
2025-05-07 23:50:03,377 - Horizon 2, Test MAE: 11.0993, Test RMSE: 17.9421, Test MAPE: 0.3831
2025-05-07 23:50:03,380 - Horizon 3, Test MAE: 12.6046, Test RMSE: 20.1100, Test MAPE: 0.4341
2025-05-07 23:50:03,384 - Horizon 4, Test MAE: 13.6128, Test RMSE: 21.4863, Test MAPE: 0.4765
2025-05-07 23:50:03,387 - Horizon 5, Test MAE: 14.3660, Test RMSE: 22.5316, Test MAPE: 0.5102
2025-05-07 23:50:03,391 - Horizon 6, Test MAE: 14.8715, Test RMSE: 23.3840, Test MAPE: 0.5233
2025-05-07 23:50:03,394 - Horizon 7, Test MAE: 15.2170, Test RMSE: 23.9450, Test MAPE: 0.5319
2025-05-07 23:50:03,398 - Horizon 8, Test MAE: 15.5063, Test RMSE: 24.3725, Test MAPE: 0.5457
2025-05-07 23:50:03,402 - Horizon 9, Test MAE: 16.0478, Test RMSE: 25.1475, Test MAPE: 0.5674
2025-05-07 23:50:03,406 - Horizon 10, Test MAE: 16.5098, Test RMSE: 25.7616, Test MAPE: 0.5872
2025-05-07 23:50:03,409 - Horizon 11, Test MAE: 16.8100, Test RMSE: 26.2739, Test MAPE: 0.5942
2025-05-07 23:50:03,413 - Horizon 12, Test MAE: 17.0798, Test RMSE: 26.5929, Test MAPE: 0.6100
2025-05-07 23:50:03,413 - Average Test MAE: 14.3261, Test RMSE: 22.6072, Test MAPE: 0.5037
2025-05-07 23:50:03,413 - Norm Test Time: 1.6577s
