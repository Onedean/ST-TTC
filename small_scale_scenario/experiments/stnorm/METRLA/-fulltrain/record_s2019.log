2023-11-30 11:11:33,943 - Namespace(device='cuda:2', dataset='METRLA', fewshot=100, prompt=False, years='2012', seed=2019, bs=64, seq_len=12, horizon=12, input_dim=3, output_dim=1, mode='train', max_epochs=100, patience=10, model_name='stnorm', tnorm_bool=True, snorm_bool=True, channels=32, kernel_size=2, blocks=4, layers=2, lrate=0.001, wdecay=0.0001, dropout=0.1, clip_grad_value=5)
2023-11-30 11:11:34,185 - Data shape: (34272, 207, 3)
2023-11-30 11:11:34,421 - Sample num: 23974, Batch num: 374
2023-11-30 11:11:34,658 - Sample num: 3425, Batch num: 53
2023-11-30 11:11:34,895 - Sample num: 6850, Batch num: 107
2023-11-30 11:11:36,351 - The arc of model:
STNORM(
  (filter_convs): ModuleList(
    (0): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1))
    (1): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (2): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1))
    (3): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (4): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1))
    (5): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (6): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1))
    (7): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
  )
  (gate_convs): ModuleList(
    (0): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1))
    (1): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (2): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1))
    (3): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (4): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1))
    (5): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (6): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1))
    (7): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
  )
  (residual_convs): ModuleList(
    (0-7): 8 x Conv2d(32, 32, kernel_size=(1, 1), stride=(1, 1))
  )
  (skip_convs): ModuleList(
    (0-7): 8 x Conv2d(32, 32, kernel_size=(1, 1), stride=(1, 1))
  )
  (sn): ModuleList(
    (0-7): 8 x SNorm()
  )
  (tn): ModuleList(
    (0-7): 8 x TNorm()
  )
  (start_conv): Conv2d(3, 32, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_1): Conv2d(32, 32, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_2): Conv2d(32, 12, kernel_size=(1, 1), stride=(1, 1))
)
2023-11-30 11:11:36,352 - The number of parameters: 223788
2023-11-30 11:11:36,352 - Start training!
2023-11-30 11:12:19,247 - Epoch: 001, Train Loss: 4.0171, Train RMSE: 7.6447, Train MAPE: 0.1144, Valid Loss: 3.2129, Valid RMSE: 6.7031, Valid MAPE: 0.0918, Train Time: 40.9382s/epoch, Valid Time: 1.9574s, LR: 1.0000e-03
2023-11-30 11:12:19,258 - Val loss decrease from inf to 3.2129
2023-11-30 11:13:03,553 - Epoch: 002, Train Loss: 3.2593, Train RMSE: 6.5928, Train MAPE: 0.0915, Valid Loss: 3.0819, Valid RMSE: 6.3600, Valid MAPE: 0.0885, Train Time: 42.4396s/epoch, Valid Time: 1.8555s, LR: 1.0000e-03
2023-11-30 11:13:03,563 - Val loss decrease from 3.2129 to 3.0819
2023-11-30 11:13:48,168 - Epoch: 003, Train Loss: 3.1237, Train RMSE: 6.3154, Train MAPE: 0.0865, Valid Loss: 3.0546, Valid RMSE: 6.2392, Valid MAPE: 0.0863, Train Time: 42.7576s/epoch, Valid Time: 1.8471s, LR: 1.0000e-03
2023-11-30 11:13:48,176 - Val loss decrease from 3.0819 to 3.0546
2023-11-30 11:14:32,023 - Epoch: 004, Train Loss: 3.0630, Train RMSE: 6.2128, Train MAPE: 0.0845, Valid Loss: 2.9781, Valid RMSE: 6.2222, Valid MAPE: 0.0886, Train Time: 42.0318s/epoch, Valid Time: 1.8149s, LR: 1.0000e-03
2023-11-30 11:14:32,031 - Val loss decrease from 3.0546 to 2.9781
2023-11-30 11:15:13,197 - Epoch: 005, Train Loss: 3.0163, Train RMSE: 6.1411, Train MAPE: 0.0830, Valid Loss: 2.9626, Valid RMSE: 6.1390, Valid MAPE: 0.0844, Train Time: 39.2241s/epoch, Valid Time: 1.9417s, LR: 1.0000e-03
2023-11-30 11:15:13,206 - Val loss decrease from 2.9781 to 2.9626
2023-11-30 11:15:57,682 - Epoch: 006, Train Loss: 2.9869, Train RMSE: 6.0839, Train MAPE: 0.0820, Valid Loss: 2.9545, Valid RMSE: 6.2072, Valid MAPE: 0.0861, Train Time: 42.6035s/epoch, Valid Time: 1.8720s, LR: 1.0000e-03
2023-11-30 11:15:57,692 - Val loss decrease from 2.9626 to 2.9545
2023-11-30 11:16:42,315 - Epoch: 007, Train Loss: 2.9711, Train RMSE: 6.0588, Train MAPE: 0.0815, Valid Loss: 2.9506, Valid RMSE: 6.1740, Valid MAPE: 0.0840, Train Time: 42.6893s/epoch, Valid Time: 1.9336s, LR: 1.0000e-03
2023-11-30 11:16:42,323 - Val loss decrease from 2.9545 to 2.9506
2023-11-30 11:17:24,692 - Epoch: 008, Train Loss: 2.9445, Train RMSE: 6.0022, Train MAPE: 0.0805, Valid Loss: 2.9754, Valid RMSE: 6.0680, Valid MAPE: 0.0857, Train Time: 40.5633s/epoch, Valid Time: 1.8051s, LR: 1.0000e-03
2023-11-30 11:18:08,395 - Epoch: 009, Train Loss: 2.9282, Train RMSE: 5.9723, Train MAPE: 0.0799, Valid Loss: 2.9270, Valid RMSE: 6.0854, Valid MAPE: 0.0850, Train Time: 41.8396s/epoch, Valid Time: 1.8630s, LR: 1.0000e-03
2023-11-30 11:18:08,403 - Val loss decrease from 2.9506 to 2.9270
2023-11-30 11:18:51,888 - Epoch: 010, Train Loss: 2.9077, Train RMSE: 5.9302, Train MAPE: 0.0792, Valid Loss: 2.9009, Valid RMSE: 6.0950, Valid MAPE: 0.0823, Train Time: 41.6114s/epoch, Valid Time: 1.8728s, LR: 1.0000e-03
2023-11-30 11:18:51,897 - Val loss decrease from 2.9270 to 2.9009
2023-11-30 11:19:36,093 - Epoch: 011, Train Loss: 2.8959, Train RMSE: 5.9035, Train MAPE: 0.0788, Valid Loss: 2.8986, Valid RMSE: 6.1318, Valid MAPE: 0.0828, Train Time: 42.3494s/epoch, Valid Time: 1.8456s, LR: 1.0000e-03
2023-11-30 11:19:36,103 - Val loss decrease from 2.9009 to 2.8986
2023-11-30 11:20:17,520 - Epoch: 012, Train Loss: 2.8779, Train RMSE: 5.8644, Train MAPE: 0.0782, Valid Loss: 2.9169, Valid RMSE: 6.1620, Valid MAPE: 0.0846, Train Time: 39.5714s/epoch, Valid Time: 1.8451s, LR: 1.0000e-03
2023-11-30 11:21:02,213 - Epoch: 013, Train Loss: 2.8645, Train RMSE: 5.8329, Train MAPE: 0.0777, Valid Loss: 2.9090, Valid RMSE: 6.1320, Valid MAPE: 0.0853, Train Time: 42.8808s/epoch, Valid Time: 1.8123s, LR: 1.0000e-03
2023-11-30 11:21:46,443 - Epoch: 014, Train Loss: 2.8516, Train RMSE: 5.8042, Train MAPE: 0.0772, Valid Loss: 2.9124, Valid RMSE: 6.1140, Valid MAPE: 0.0810, Train Time: 42.3712s/epoch, Valid Time: 1.8581s, LR: 1.0000e-03
2023-11-30 11:22:30,528 - Epoch: 015, Train Loss: 2.8441, Train RMSE: 5.7810, Train MAPE: 0.0769, Valid Loss: 2.9172, Valid RMSE: 6.1901, Valid MAPE: 0.0859, Train Time: 42.2794s/epoch, Valid Time: 1.8050s, LR: 1.0000e-03
2023-11-30 11:23:11,618 - Epoch: 016, Train Loss: 2.8274, Train RMSE: 5.7439, Train MAPE: 0.0764, Valid Loss: 2.9089, Valid RMSE: 6.0892, Valid MAPE: 0.0817, Train Time: 39.2526s/epoch, Valid Time: 1.8369s, LR: 1.0000e-03
2023-11-30 11:23:56,120 - Epoch: 017, Train Loss: 2.8125, Train RMSE: 5.7058, Train MAPE: 0.0759, Valid Loss: 2.8753, Valid RMSE: 6.0714, Valid MAPE: 0.0807, Train Time: 42.5971s/epoch, Valid Time: 1.9052s, LR: 1.0000e-03
2023-11-30 11:23:56,128 - Val loss decrease from 2.8986 to 2.8753
2023-11-30 11:24:40,491 - Epoch: 018, Train Loss: 2.8047, Train RMSE: 5.6873, Train MAPE: 0.0755, Valid Loss: 2.9229, Valid RMSE: 6.1116, Valid MAPE: 0.0808, Train Time: 42.5136s/epoch, Valid Time: 1.8492s, LR: 1.0000e-03
2023-11-30 11:25:22,870 - Epoch: 019, Train Loss: 2.7963, Train RMSE: 5.6640, Train MAPE: 0.0752, Valid Loss: 2.9087, Valid RMSE: 6.1024, Valid MAPE: 0.0810, Train Time: 40.6902s/epoch, Valid Time: 1.6883s, LR: 1.0000e-03
2023-11-30 11:26:06,506 - Epoch: 020, Train Loss: 2.7806, Train RMSE: 5.6239, Train MAPE: 0.0746, Valid Loss: 2.8988, Valid RMSE: 6.0764, Valid MAPE: 0.0823, Train Time: 41.7842s/epoch, Valid Time: 1.8516s, LR: 1.0000e-03
2023-11-30 11:26:50,270 - Epoch: 021, Train Loss: 2.7680, Train RMSE: 5.5913, Train MAPE: 0.0742, Valid Loss: 2.9037, Valid RMSE: 6.1320, Valid MAPE: 0.0825, Train Time: 41.8155s/epoch, Valid Time: 1.9484s, LR: 1.0000e-03
2023-11-30 11:27:34,861 - Epoch: 022, Train Loss: 2.7601, Train RMSE: 5.5676, Train MAPE: 0.0738, Valid Loss: 2.9040, Valid RMSE: 6.1655, Valid MAPE: 0.0823, Train Time: 42.7290s/epoch, Valid Time: 1.8612s, LR: 1.0000e-03
2023-11-30 11:28:17,055 - Epoch: 023, Train Loss: 2.7481, Train RMSE: 5.5382, Train MAPE: 0.0734, Valid Loss: 2.8744, Valid RMSE: 6.0544, Valid MAPE: 0.0810, Train Time: 40.3436s/epoch, Valid Time: 1.8501s, LR: 1.0000e-03
2023-11-30 11:28:17,066 - Val loss decrease from 2.8753 to 2.8744
2023-11-30 11:29:01,876 - Epoch: 024, Train Loss: 2.7421, Train RMSE: 5.5232, Train MAPE: 0.0732, Valid Loss: 2.9036, Valid RMSE: 6.1604, Valid MAPE: 0.0826, Train Time: 42.7238s/epoch, Valid Time: 2.0856s, LR: 1.0000e-03
2023-11-30 11:29:46,112 - Epoch: 025, Train Loss: 2.7276, Train RMSE: 5.4844, Train MAPE: 0.0727, Valid Loss: 2.9296, Valid RMSE: 6.1976, Valid MAPE: 0.0801, Train Time: 42.2973s/epoch, Valid Time: 1.9375s, LR: 1.0000e-03
2023-11-30 11:30:30,033 - Epoch: 026, Train Loss: 2.7217, Train RMSE: 5.4653, Train MAPE: 0.0724, Valid Loss: 2.9164, Valid RMSE: 6.1809, Valid MAPE: 0.0842, Train Time: 42.0056s/epoch, Valid Time: 1.9153s, LR: 1.0000e-03
2023-11-30 11:31:11,902 - Epoch: 027, Train Loss: 2.7092, Train RMSE: 5.4355, Train MAPE: 0.0720, Valid Loss: 2.8973, Valid RMSE: 6.1209, Valid MAPE: 0.0826, Train Time: 39.9060s/epoch, Valid Time: 1.9629s, LR: 1.0000e-03
2023-11-30 11:31:56,149 - Epoch: 028, Train Loss: 2.7014, Train RMSE: 5.4090, Train MAPE: 0.0716, Valid Loss: 2.9005, Valid RMSE: 6.1522, Valid MAPE: 0.0809, Train Time: 42.2828s/epoch, Valid Time: 1.9632s, LR: 1.0000e-03
2023-11-30 11:32:40,683 - Epoch: 029, Train Loss: 2.6892, Train RMSE: 5.3789, Train MAPE: 0.0712, Valid Loss: 2.9170, Valid RMSE: 6.1409, Valid MAPE: 0.0824, Train Time: 42.6917s/epoch, Valid Time: 1.8422s, LR: 1.0000e-03
2023-11-30 11:33:24,002 - Epoch: 030, Train Loss: 2.6853, Train RMSE: 5.3668, Train MAPE: 0.0711, Valid Loss: 2.9187, Valid RMSE: 6.2020, Valid MAPE: 0.0857, Train Time: 41.6094s/epoch, Valid Time: 1.7090s, LR: 1.0000e-03
2023-11-30 11:34:05,994 - Epoch: 031, Train Loss: 2.6770, Train RMSE: 5.3430, Train MAPE: 0.0707, Valid Loss: 2.8911, Valid RMSE: 6.0912, Valid MAPE: 0.0820, Train Time: 40.0225s/epoch, Valid Time: 1.9695s, LR: 1.0000e-03
2023-11-30 11:34:50,258 - Epoch: 032, Train Loss: 2.6656, Train RMSE: 5.3171, Train MAPE: 0.0704, Valid Loss: 2.9310, Valid RMSE: 6.1844, Valid MAPE: 0.0833, Train Time: 42.3875s/epoch, Valid Time: 1.8762s, LR: 1.0000e-03
2023-11-30 11:35:34,904 - Epoch: 033, Train Loss: 2.6578, Train RMSE: 5.2947, Train MAPE: 0.0701, Valid Loss: 2.9275, Valid RMSE: 6.2135, Valid MAPE: 0.0820, Train Time: 42.7587s/epoch, Valid Time: 1.8865s, LR: 1.0000e-03
2023-11-30 11:35:34,904 - Early stop at epoch 33, loss = 2.874366
2023-11-30 11:35:38,664 - Horizon 1, Test MAE: 2.3037, Test RMSE: 4.0797, Test MAPE: 0.0560
2023-11-30 11:35:38,671 - Horizon 2, Test MAE: 2.5939, Test RMSE: 4.9441, Test MAPE: 0.0661
2023-11-30 11:35:38,678 - Horizon 3, Test MAE: 2.7893, Test RMSE: 5.5197, Test MAPE: 0.0737
2023-11-30 11:35:38,685 - Horizon 4, Test MAE: 2.9394, Test RMSE: 5.9446, Test MAPE: 0.0799
2023-11-30 11:35:38,692 - Horizon 5, Test MAE: 3.0630, Test RMSE: 6.2712, Test MAPE: 0.0848
2023-11-30 11:35:38,699 - Horizon 6, Test MAE: 3.1622, Test RMSE: 6.5441, Test MAPE: 0.0888
2023-11-30 11:35:38,706 - Horizon 7, Test MAE: 3.2427, Test RMSE: 6.7691, Test MAPE: 0.0922
2023-11-30 11:35:38,712 - Horizon 8, Test MAE: 3.3103, Test RMSE: 6.9384, Test MAPE: 0.0948
2023-11-30 11:35:38,719 - Horizon 9, Test MAE: 3.3716, Test RMSE: 7.0796, Test MAPE: 0.0976
2023-11-30 11:35:38,726 - Horizon 10, Test MAE: 3.4264, Test RMSE: 7.2185, Test MAPE: 0.1001
2023-11-30 11:35:38,733 - Horizon 11, Test MAE: 3.4847, Test RMSE: 7.3518, Test MAPE: 0.1026
2023-11-30 11:35:38,740 - Horizon 12, Test MAE: 3.5454, Test RMSE: 7.4763, Test MAPE: 0.1047
2023-11-30 11:35:38,740 - Average Test MAE: 3.1027, Test RMSE: 6.3448, Test MAPE: 0.0868
