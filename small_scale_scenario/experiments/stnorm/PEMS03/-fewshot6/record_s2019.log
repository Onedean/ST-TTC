2025-05-08 16:50:36,740 - Namespace(device='cuda:2', dataset='PEMS03', fewshot=6, eval_method='norm', years='2018', seed=2019, bs=64, seq_len=12, horizon=12, input_dim=3, output_dim=1, mode='train', max_epochs=100, patience=10, model_name='stnorm', tnorm_bool=True, snorm_bool=True, channels=32, kernel_size=2, blocks=4, layers=2, lrate=0.001, wdecay=0.0001, dropout=0.1, clip_grad_value=5)
2025-05-08 16:50:37,151 - Data shape: (26208, 358, 3)
2025-05-08 16:50:37,549 - Sample num: 1571, Batch num: 24
2025-05-08 16:50:37,949 - Sample num: 5237, Batch num: 81
2025-05-08 16:50:38,347 - Sample num: 5237, Batch num: 81
2025-05-08 16:50:39,342 - The arc of model:
STNORM(
  (filter_convs): ModuleList(
    (0): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1))
    (1): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (2): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1))
    (3): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (4): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1))
    (5): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (6): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1))
    (7): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
  )
  (gate_convs): ModuleList(
    (0): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1))
    (1): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (2): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1))
    (3): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (4): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1))
    (5): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (6): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1))
    (7): Conv2d(96, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
  )
  (residual_convs): ModuleList(
    (0-7): 8 x Conv2d(32, 32, kernel_size=(1, 1), stride=(1, 1))
  )
  (skip_convs): ModuleList(
    (0-7): 8 x Conv2d(32, 32, kernel_size=(1, 1), stride=(1, 1))
  )
  (sn): ModuleList(
    (0-7): 8 x SNorm()
  )
  (tn): ModuleList(
    (0-7): 8 x TNorm()
  )
  (start_conv): Conv2d(3, 32, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_1): Conv2d(32, 32, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_2): Conv2d(32, 12, kernel_size=(1, 1), stride=(1, 1))
)
2025-05-08 16:50:39,343 - Number of total parameters: 301100, tunable parameters: 301100
2025-05-08 16:50:39,343 - The number of parameters: 301100
2025-05-08 16:50:39,343 - Start training!
2025-05-08 16:50:52,609 - Epoch: 001, Train Loss: 87.4334, Train RMSE: 114.3189, Train MAPE: 2.9476, Valid Loss: 56.6279, Valid RMSE: 85.9349, Valid MAPE: 1.5897, Train Time: 6.4365s/epoch, Valid Time: 6.8297s, LR: 1.0000e-03
2025-05-08 16:50:52,621 - Val loss decrease from inf to 56.6279
2025-05-08 16:51:04,830 - Epoch: 002, Train Loss: 36.8670, Train RMSE: 57.7425, Train MAPE: 0.9007, Valid Loss: 27.1724, Valid RMSE: 42.7830, Valid MAPE: 0.4193, Train Time: 5.8157s/epoch, Valid Time: 6.3926s, LR: 1.0000e-03
2025-05-08 16:51:04,850 - Val loss decrease from 56.6279 to 27.1724
2025-05-08 16:51:17,185 - Epoch: 003, Train Loss: 21.8549, Train RMSE: 33.5560, Train MAPE: 0.2882, Valid Loss: 21.4822, Valid RMSE: 32.7935, Valid MAPE: 0.2611, Train Time: 5.8932s/epoch, Valid Time: 6.4419s, LR: 1.0000e-03
2025-05-08 16:51:17,203 - Val loss decrease from 27.1724 to 21.4822
2025-05-08 16:51:29,086 - Epoch: 004, Train Loss: 19.6717, Train RMSE: 30.2913, Train MAPE: 0.2492, Valid Loss: 20.0842, Valid RMSE: 31.1954, Valid MAPE: 0.2169, Train Time: 5.8421s/epoch, Valid Time: 6.0409s, LR: 1.0000e-03
2025-05-08 16:51:29,104 - Val loss decrease from 21.4822 to 20.0842
2025-05-08 16:51:41,231 - Epoch: 005, Train Loss: 18.9799, Train RMSE: 29.6246, Train MAPE: 0.2261, Valid Loss: 20.4711, Valid RMSE: 31.6842, Valid MAPE: 0.2073, Train Time: 5.8694s/epoch, Valid Time: 6.2567s, LR: 1.0000e-03
2025-05-08 16:51:53,480 - Epoch: 006, Train Loss: 18.8424, Train RMSE: 29.2001, Train MAPE: 0.2349, Valid Loss: 21.2166, Valid RMSE: 32.3304, Valid MAPE: 0.2047, Train Time: 5.7037s/epoch, Valid Time: 6.5455s, LR: 1.0000e-03
2025-05-08 16:52:05,365 - Epoch: 007, Train Loss: 18.7169, Train RMSE: 28.8598, Train MAPE: 0.2489, Valid Loss: 19.7360, Valid RMSE: 30.3742, Valid MAPE: 0.2684, Train Time: 5.6871s/epoch, Valid Time: 6.1972s, LR: 1.0000e-03
2025-05-08 16:52:05,377 - Val loss decrease from 20.0842 to 19.7360
2025-05-08 16:52:17,367 - Epoch: 008, Train Loss: 18.2826, Train RMSE: 28.4080, Train MAPE: 0.2349, Valid Loss: 19.8679, Valid RMSE: 30.1596, Valid MAPE: 0.2689, Train Time: 5.6009s/epoch, Valid Time: 6.3887s, LR: 1.0000e-03
2025-05-08 16:52:29,426 - Epoch: 009, Train Loss: 17.5971, Train RMSE: 27.5387, Train MAPE: 0.2062, Valid Loss: 19.3940, Valid RMSE: 29.7395, Valid MAPE: 0.2433, Train Time: 5.6078s/epoch, Valid Time: 6.4515s, LR: 1.0000e-03
2025-05-08 16:52:29,439 - Val loss decrease from 19.7360 to 19.3940
2025-05-08 16:52:42,021 - Epoch: 010, Train Loss: 17.6814, Train RMSE: 27.7319, Train MAPE: 0.2112, Valid Loss: 18.9755, Valid RMSE: 29.3871, Valid MAPE: 0.2076, Train Time: 5.7682s/epoch, Valid Time: 6.8138s, LR: 1.0000e-03
2025-05-08 16:52:42,037 - Val loss decrease from 19.3940 to 18.9755
2025-05-08 16:52:54,204 - Epoch: 011, Train Loss: 17.4795, Train RMSE: 27.3742, Train MAPE: 0.1972, Valid Loss: 20.4188, Valid RMSE: 31.2408, Valid MAPE: 0.2026, Train Time: 5.8477s/epoch, Valid Time: 6.3193s, LR: 1.0000e-03
2025-05-08 16:53:06,578 - Epoch: 012, Train Loss: 17.1827, Train RMSE: 26.9815, Train MAPE: 0.1966, Valid Loss: 19.4515, Valid RMSE: 30.1959, Valid MAPE: 0.1837, Train Time: 5.8659s/epoch, Valid Time: 6.5080s, LR: 1.0000e-03
2025-05-08 16:53:18,666 - Epoch: 013, Train Loss: 17.0603, Train RMSE: 26.7998, Train MAPE: 0.1902, Valid Loss: 18.3119, Valid RMSE: 28.6428, Valid MAPE: 0.1792, Train Time: 5.8416s/epoch, Valid Time: 6.2459s, LR: 1.0000e-03
2025-05-08 16:53:18,679 - Val loss decrease from 18.9755 to 18.3119
2025-05-08 16:53:30,729 - Epoch: 014, Train Loss: 16.7841, Train RMSE: 26.3417, Train MAPE: 0.1880, Valid Loss: 19.2987, Valid RMSE: 29.8476, Valid MAPE: 0.2043, Train Time: 5.8124s/epoch, Valid Time: 6.2371s, LR: 1.0000e-03
2025-05-08 16:53:42,710 - Epoch: 015, Train Loss: 16.8169, Train RMSE: 26.4341, Train MAPE: 0.1904, Valid Loss: 18.2210, Valid RMSE: 28.2254, Valid MAPE: 0.1775, Train Time: 5.7006s/epoch, Valid Time: 6.2797s, LR: 1.0000e-03
2025-05-08 16:53:42,722 - Val loss decrease from 18.3119 to 18.2210
2025-05-08 16:53:54,990 - Epoch: 016, Train Loss: 16.7584, Train RMSE: 26.2649, Train MAPE: 0.2018, Valid Loss: 18.4690, Valid RMSE: 29.2361, Valid MAPE: 0.1749, Train Time: 5.6366s/epoch, Valid Time: 6.6310s, LR: 1.0000e-03
2025-05-08 16:54:07,071 - Epoch: 017, Train Loss: 16.1703, Train RMSE: 25.6657, Train MAPE: 0.1774, Valid Loss: 18.0489, Valid RMSE: 28.3209, Valid MAPE: 0.1878, Train Time: 5.6002s/epoch, Valid Time: 6.4807s, LR: 1.0000e-03
2025-05-08 16:54:07,084 - Val loss decrease from 18.2210 to 18.0489
2025-05-08 16:54:18,962 - Epoch: 018, Train Loss: 16.0133, Train RMSE: 25.3305, Train MAPE: 0.1724, Valid Loss: 18.0686, Valid RMSE: 28.3115, Valid MAPE: 0.1718, Train Time: 5.5438s/epoch, Valid Time: 6.3339s, LR: 1.0000e-03
2025-05-08 16:54:31,011 - Epoch: 019, Train Loss: 16.7910, Train RMSE: 26.2978, Train MAPE: 0.1858, Valid Loss: 18.3595, Valid RMSE: 28.3898, Valid MAPE: 0.2115, Train Time: 5.5999s/epoch, Valid Time: 6.4494s, LR: 1.0000e-03
2025-05-08 16:54:43,194 - Epoch: 020, Train Loss: 17.0878, Train RMSE: 26.2597, Train MAPE: 0.2089, Valid Loss: 18.8218, Valid RMSE: 28.9790, Valid MAPE: 0.1838, Train Time: 5.8123s/epoch, Valid Time: 6.3700s, LR: 1.0000e-03
2025-05-08 16:54:55,132 - Epoch: 021, Train Loss: 16.0243, Train RMSE: 24.9759, Train MAPE: 0.1792, Valid Loss: 17.7187, Valid RMSE: 27.3220, Valid MAPE: 0.2016, Train Time: 5.7562s/epoch, Valid Time: 6.1823s, LR: 1.0000e-03
2025-05-08 16:54:55,145 - Val loss decrease from 18.0489 to 17.7187
2025-05-08 16:55:07,165 - Epoch: 022, Train Loss: 15.8730, Train RMSE: 24.8658, Train MAPE: 0.1799, Valid Loss: 17.7229, Valid RMSE: 27.5479, Valid MAPE: 0.1687, Train Time: 5.7963s/epoch, Valid Time: 6.2234s, LR: 1.0000e-03
2025-05-08 16:55:19,316 - Epoch: 023, Train Loss: 15.6797, Train RMSE: 24.6081, Train MAPE: 0.1781, Valid Loss: 17.3577, Valid RMSE: 26.9085, Valid MAPE: 0.1623, Train Time: 5.8403s/epoch, Valid Time: 6.3109s, LR: 1.0000e-03
2025-05-08 16:55:19,331 - Val loss decrease from 17.7187 to 17.3577
2025-05-08 16:55:31,531 - Epoch: 024, Train Loss: 15.2778, Train RMSE: 24.1973, Train MAPE: 0.1634, Valid Loss: 18.2224, Valid RMSE: 28.0231, Valid MAPE: 0.1726, Train Time: 5.7024s/epoch, Valid Time: 6.4974s, LR: 1.0000e-03
2025-05-08 16:55:43,599 - Epoch: 025, Train Loss: 15.3494, Train RMSE: 24.0332, Train MAPE: 0.1806, Valid Loss: 17.6577, Valid RMSE: 26.8654, Valid MAPE: 0.2370, Train Time: 5.5107s/epoch, Valid Time: 6.5572s, LR: 1.0000e-03
2025-05-08 16:55:55,838 - Epoch: 026, Train Loss: 15.5188, Train RMSE: 24.3651, Train MAPE: 0.1734, Valid Loss: 17.8477, Valid RMSE: 27.5027, Valid MAPE: 0.1746, Train Time: 5.6763s/epoch, Valid Time: 6.5630s, LR: 1.0000e-03
2025-05-08 16:56:07,792 - Epoch: 027, Train Loss: 15.6303, Train RMSE: 24.4404, Train MAPE: 0.1705, Valid Loss: 18.6151, Valid RMSE: 27.7832, Valid MAPE: 0.2093, Train Time: 5.5493s/epoch, Valid Time: 6.4043s, LR: 1.0000e-03
2025-05-08 16:56:19,778 - Epoch: 028, Train Loss: 15.3223, Train RMSE: 24.0466, Train MAPE: 0.1731, Valid Loss: 17.9087, Valid RMSE: 27.8833, Valid MAPE: 0.1752, Train Time: 5.5187s/epoch, Valid Time: 6.4670s, LR: 1.0000e-03
2025-05-08 16:56:31,624 - Epoch: 029, Train Loss: 15.1356, Train RMSE: 23.7361, Train MAPE: 0.1619, Valid Loss: 17.9966, Valid RMSE: 27.6195, Valid MAPE: 0.1671, Train Time: 5.6928s/epoch, Valid Time: 6.1526s, LR: 1.0000e-03
2025-05-08 16:56:43,332 - Epoch: 030, Train Loss: 14.8539, Train RMSE: 23.4666, Train MAPE: 0.1617, Valid Loss: 18.0487, Valid RMSE: 28.2361, Valid MAPE: 0.1843, Train Time: 5.5856s/epoch, Valid Time: 6.1226s, LR: 1.0000e-03
2025-05-08 16:56:55,255 - Epoch: 031, Train Loss: 14.9484, Train RMSE: 23.6303, Train MAPE: 0.1579, Valid Loss: 17.7459, Valid RMSE: 27.6371, Valid MAPE: 0.1652, Train Time: 5.7283s/epoch, Valid Time: 6.1948s, LR: 1.0000e-03
2025-05-08 16:57:07,125 - Epoch: 032, Train Loss: 14.7404, Train RMSE: 23.2962, Train MAPE: 0.1572, Valid Loss: 17.5167, Valid RMSE: 27.1609, Valid MAPE: 0.1687, Train Time: 5.6899s/epoch, Valid Time: 6.1795s, LR: 1.0000e-03
2025-05-08 16:57:18,817 - Epoch: 033, Train Loss: 14.7293, Train RMSE: 23.2342, Train MAPE: 0.1547, Valid Loss: 17.4053, Valid RMSE: 27.0639, Valid MAPE: 0.1738, Train Time: 5.5115s/epoch, Valid Time: 6.1799s, LR: 1.0000e-03
2025-05-08 16:57:18,817 - Early stop at epoch 33, loss = 17.357677
2025-05-08 16:57:24,000 - --------------------------------------------------Norm Test Time Results:--------------------------------------------------
2025-05-08 16:57:24,016 - Horizon 1, Test MAE: 13.5901, Test RMSE: 21.8564, Test MAPE: 0.1392
2025-05-08 16:57:24,030 - Horizon 2, Test MAE: 14.6769, Test RMSE: 23.7638, Test MAPE: 0.1447
2025-05-08 16:57:24,045 - Horizon 3, Test MAE: 15.6808, Test RMSE: 25.4041, Test MAPE: 0.1573
2025-05-08 16:57:24,059 - Horizon 4, Test MAE: 16.3175, Test RMSE: 26.4360, Test MAPE: 0.1647
2025-05-08 16:57:24,076 - Horizon 5, Test MAE: 17.0391, Test RMSE: 27.5335, Test MAPE: 0.1680
2025-05-08 16:57:24,091 - Horizon 6, Test MAE: 17.5896, Test RMSE: 28.5008, Test MAPE: 0.1694
2025-05-08 16:57:24,105 - Horizon 7, Test MAE: 18.3118, Test RMSE: 29.4450, Test MAPE: 0.1773
2025-05-08 16:57:24,122 - Horizon 8, Test MAE: 18.7734, Test RMSE: 30.0756, Test MAPE: 0.1825
2025-05-08 16:57:24,136 - Horizon 9, Test MAE: 19.1431, Test RMSE: 30.6501, Test MAPE: 0.1862
2025-05-08 16:57:24,151 - Horizon 10, Test MAE: 19.5508, Test RMSE: 31.5579, Test MAPE: 0.1976
2025-05-08 16:57:24,169 - Horizon 11, Test MAE: 20.1228, Test RMSE: 32.1714, Test MAPE: 0.2025
2025-05-08 16:57:24,184 - Horizon 12, Test MAE: 20.7008, Test RMSE: 33.1886, Test MAPE: 0.1994
2025-05-08 16:57:24,184 - Average Test MAE: 17.6247, Test RMSE: 28.3819, Test MAPE: 0.1740
2025-05-08 16:57:24,184 - Norm Test Time: 5.0435s
