2023-11-28 02:29:04,323 - Namespace(device='cuda:2', dataset='METRLA', fewshot=10, prompt=False, years='2012', seed=2018, bs=64, seq_len=12, horizon=12, input_dim=3, output_dim=1, mode='train', max_epochs=100, patience=10, model_name='stgcn', Kt=3, Ks=3, block_num=2, step_size=10, gamma=0.95, lrate=0.001, wdecay=0.0005, dropout=0.5, clip_grad_value=0)
2023-11-28 02:29:04,324 - Adj path: /home/yuxuan/weichen/llm4stg/LargeST/data/metrla/metrla_rn_adj.npy
2023-11-28 02:29:05,384 - Data shape: (34272, 207, 3)
2023-11-28 02:29:05,622 - Sample num: 3425, Batch num: 53
2023-11-28 02:29:05,862 - Sample num: 3425, Batch num: 53
2023-11-28 02:29:06,424 - Sample num: 6850, Batch num: 107
2023-11-28 02:29:06,945 - The arc of model:
STGCN(
  (st_blocks): Sequential(
    (0): STConvBlock(
      (tmp_conv1): TemporalConvLayer(
        (align): Align(
          (align_conv): Conv2d(3, 64, kernel_size=(1, 1), stride=(1, 1))
        )
        (sigmoid): Sigmoid()
        (causal_conv): CausalConv2d(3, 128, kernel_size=(3, 1), stride=(1, 1))
      )
      (graph_conv): GraphConvLayer(
        (align): Align(
          (align_conv): Conv2d(64, 16, kernel_size=(1, 1), stride=(1, 1))
        )
        (cheb_graph_conv): ChebGraphConv()
      )
      (tmp_conv2): TemporalConvLayer(
        (align): Align(
          (align_conv): Conv2d(16, 64, kernel_size=(1, 1), stride=(1, 1))
        )
        (sigmoid): Sigmoid()
        (causal_conv): CausalConv2d(16, 128, kernel_size=(3, 1), stride=(1, 1))
      )
      (tc2_ln): LayerNorm((207, 64), eps=1e-05, elementwise_affine=True)
      (relu): ReLU()
      (dropout): Dropout(p=0.5, inplace=False)
    )
    (1): STConvBlock(
      (tmp_conv1): TemporalConvLayer(
        (align): Align(
          (align_conv): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1))
        )
        (sigmoid): Sigmoid()
        (causal_conv): CausalConv2d(64, 128, kernel_size=(3, 1), stride=(1, 1))
      )
      (graph_conv): GraphConvLayer(
        (align): Align(
          (align_conv): Conv2d(64, 16, kernel_size=(1, 1), stride=(1, 1))
        )
        (cheb_graph_conv): ChebGraphConv()
      )
      (tmp_conv2): TemporalConvLayer(
        (align): Align(
          (align_conv): Conv2d(16, 64, kernel_size=(1, 1), stride=(1, 1))
        )
        (sigmoid): Sigmoid()
        (causal_conv): CausalConv2d(16, 128, kernel_size=(3, 1), stride=(1, 1))
      )
      (tc2_ln): LayerNorm((207, 64), eps=1e-05, elementwise_affine=True)
      (relu): ReLU()
      (dropout): Dropout(p=0.5, inplace=False)
    )
  )
  (output): OutputBlock(
    (tmp_conv1): TemporalConvLayer(
      (align): Align(
        (align_conv): Conv2d(64, 128, kernel_size=(1, 1), stride=(1, 1))
      )
      (sigmoid): Sigmoid()
      (causal_conv): CausalConv2d(64, 256, kernel_size=(4, 1), stride=(1, 1))
    )
    (fc1): Linear(in_features=128, out_features=128, bias=True)
    (fc2): Linear(in_features=128, out_features=12, bias=True)
    (tc1_ln): LayerNorm((207, 128), eps=1e-05, elementwise_affine=True)
    (relu): ReLU()
  )
)
2023-11-28 02:29:06,946 - The number of parameters: 246924
2023-11-28 02:29:06,946 - Start training!
2023-11-28 02:29:18,521 - Epoch: 001, Train Loss: 6.0869, Train RMSE: 10.5196, Train MAPE: 0.1913, Valid Loss: 4.1735, Valid RMSE: 8.0190, Valid MAPE: 0.1298, Train Time: 8.5684s/epoch, Valid Time: 3.0064s, LR: 1.0000e-03
2023-11-28 02:29:18,525 - Val loss decrease from inf to 4.1735
2023-11-28 02:29:28,490 - Epoch: 002, Train Loss: 4.0451, Train RMSE: 7.8793, Train MAPE: 0.1178, Valid Loss: 3.7549, Valid RMSE: 7.7242, Valid MAPE: 0.1140, Train Time: 7.4502s/epoch, Valid Time: 2.5148s, LR: 1.0000e-03
2023-11-28 02:29:28,495 - Val loss decrease from 4.1735 to 3.7549
2023-11-28 02:29:38,396 - Epoch: 003, Train Loss: 3.7740, Train RMSE: 7.4828, Train MAPE: 0.1088, Valid Loss: 3.7304, Valid RMSE: 7.5937, Valid MAPE: 0.1041, Train Time: 7.0148s/epoch, Valid Time: 2.8855s, LR: 1.0000e-03
2023-11-28 02:29:38,401 - Val loss decrease from 3.7549 to 3.7304
2023-11-28 02:29:50,081 - Epoch: 004, Train Loss: 3.6128, Train RMSE: 7.2648, Train MAPE: 0.1024, Valid Loss: 3.5393, Valid RMSE: 7.2369, Valid MAPE: 0.1074, Train Time: 8.6213s/epoch, Valid Time: 3.0582s, LR: 1.0000e-03
2023-11-28 02:29:50,085 - Val loss decrease from 3.7304 to 3.5393
2023-11-28 02:30:01,298 - Epoch: 005, Train Loss: 3.5294, Train RMSE: 7.1452, Train MAPE: 0.0992, Valid Loss: 3.5215, Valid RMSE: 7.3048, Valid MAPE: 0.1034, Train Time: 8.2057s/epoch, Valid Time: 3.0070s, LR: 1.0000e-03
2023-11-28 02:30:01,303 - Val loss decrease from 3.5393 to 3.5215
2023-11-28 02:30:12,214 - Epoch: 006, Train Loss: 3.4884, Train RMSE: 7.0768, Train MAPE: 0.0978, Valid Loss: 3.5044, Valid RMSE: 7.1008, Valid MAPE: 0.1072, Train Time: 7.9235s/epoch, Valid Time: 2.9876s, LR: 1.0000e-03
2023-11-28 02:30:12,219 - Val loss decrease from 3.5215 to 3.5044
2023-11-28 02:30:23,172 - Epoch: 007, Train Loss: 3.4749, Train RMSE: 7.0378, Train MAPE: 0.0972, Valid Loss: 3.4230, Valid RMSE: 7.0670, Valid MAPE: 0.1001, Train Time: 8.0138s/epoch, Valid Time: 2.9387s, LR: 1.0000e-03
2023-11-28 02:30:23,176 - Val loss decrease from 3.5044 to 3.4230
2023-11-28 02:30:34,173 - Epoch: 008, Train Loss: 3.4228, Train RMSE: 6.9516, Train MAPE: 0.0952, Valid Loss: 3.4047, Valid RMSE: 7.0130, Valid MAPE: 0.0999, Train Time: 8.0238s/epoch, Valid Time: 2.9727s, LR: 1.0000e-03
2023-11-28 02:30:34,177 - Val loss decrease from 3.4230 to 3.4047
2023-11-28 02:30:45,647 - Epoch: 009, Train Loss: 3.3873, Train RMSE: 6.8959, Train MAPE: 0.0940, Valid Loss: 3.4092, Valid RMSE: 7.0180, Valid MAPE: 0.1018, Train Time: 8.4771s/epoch, Valid Time: 2.9924s, LR: 1.0000e-03
2023-11-28 02:30:57,366 - Epoch: 010, Train Loss: 3.3642, Train RMSE: 6.8451, Train MAPE: 0.0932, Valid Loss: 3.4101, Valid RMSE: 7.0047, Valid MAPE: 0.1031, Train Time: 8.6849s/epoch, Valid Time: 3.0340s, LR: 1.0000e-03
2023-11-28 02:31:08,898 - Epoch: 011, Train Loss: 3.3456, Train RMSE: 6.8169, Train MAPE: 0.0928, Valid Loss: 3.3767, Valid RMSE: 7.0160, Valid MAPE: 0.0963, Train Time: 8.4891s/epoch, Valid Time: 3.0422s, LR: 9.5000e-04
2023-11-28 02:31:08,903 - Val loss decrease from 3.4047 to 3.3767
2023-11-28 02:31:19,181 - Epoch: 012, Train Loss: 3.3273, Train RMSE: 6.7838, Train MAPE: 0.0921, Valid Loss: 3.3768, Valid RMSE: 6.9588, Valid MAPE: 0.0981, Train Time: 7.4954s/epoch, Valid Time: 2.7831s, LR: 9.5000e-04
2023-11-28 02:31:30,085 - Epoch: 013, Train Loss: 3.3147, Train RMSE: 6.7488, Train MAPE: 0.0919, Valid Loss: 3.4422, Valid RMSE: 7.1171, Valid MAPE: 0.0955, Train Time: 8.0620s/epoch, Valid Time: 2.8415s, LR: 9.5000e-04
2023-11-28 02:31:40,994 - Epoch: 014, Train Loss: 3.3020, Train RMSE: 6.7432, Train MAPE: 0.0915, Valid Loss: 3.3930, Valid RMSE: 7.0134, Valid MAPE: 0.0958, Train Time: 7.9618s/epoch, Valid Time: 2.9468s, LR: 9.5000e-04
2023-11-28 02:31:52,555 - Epoch: 015, Train Loss: 3.2841, Train RMSE: 6.6927, Train MAPE: 0.0910, Valid Loss: 3.3273, Valid RMSE: 6.8477, Valid MAPE: 0.0955, Train Time: 8.5970s/epoch, Valid Time: 2.9632s, LR: 9.5000e-04
2023-11-28 02:31:52,560 - Val loss decrease from 3.3767 to 3.3273
2023-11-28 02:32:04,079 - Epoch: 016, Train Loss: 3.2520, Train RMSE: 6.6450, Train MAPE: 0.0900, Valid Loss: 3.3160, Valid RMSE: 6.8137, Valid MAPE: 0.0996, Train Time: 8.4389s/epoch, Valid Time: 3.0805s, LR: 9.5000e-04
2023-11-28 02:32:04,084 - Val loss decrease from 3.3273 to 3.3160
2023-11-28 02:32:15,424 - Epoch: 017, Train Loss: 3.2328, Train RMSE: 6.6127, Train MAPE: 0.0895, Valid Loss: 3.2777, Valid RMSE: 6.8169, Valid MAPE: 0.0970, Train Time: 8.3812s/epoch, Valid Time: 2.9590s, LR: 9.5000e-04
2023-11-28 02:32:15,429 - Val loss decrease from 3.3160 to 3.2777
2023-11-28 02:32:26,301 - Epoch: 018, Train Loss: 3.2101, Train RMSE: 6.5631, Train MAPE: 0.0888, Valid Loss: 3.3190, Valid RMSE: 6.8178, Valid MAPE: 0.0940, Train Time: 7.9215s/epoch, Valid Time: 2.9507s, LR: 9.5000e-04
2023-11-28 02:32:36,281 - Epoch: 019, Train Loss: 3.1962, Train RMSE: 6.5364, Train MAPE: 0.0887, Valid Loss: 3.2732, Valid RMSE: 6.7819, Valid MAPE: 0.0952, Train Time: 7.4401s/epoch, Valid Time: 2.5389s, LR: 9.5000e-04
2023-11-28 02:32:36,286 - Val loss decrease from 3.2777 to 3.2732
2023-11-28 02:32:47,180 - Epoch: 020, Train Loss: 3.1830, Train RMSE: 6.5061, Train MAPE: 0.0881, Valid Loss: 3.2590, Valid RMSE: 6.7636, Valid MAPE: 0.0943, Train Time: 7.7773s/epoch, Valid Time: 3.1169s, LR: 9.5000e-04
2023-11-28 02:32:47,185 - Val loss decrease from 3.2732 to 3.2590
2023-11-28 02:32:58,530 - Epoch: 021, Train Loss: 3.1749, Train RMSE: 6.4947, Train MAPE: 0.0879, Valid Loss: 3.3198, Valid RMSE: 6.8825, Valid MAPE: 0.0964, Train Time: 8.3835s/epoch, Valid Time: 2.9607s, LR: 9.0250e-04
2023-11-28 02:33:10,119 - Epoch: 022, Train Loss: 3.1559, Train RMSE: 6.4368, Train MAPE: 0.0871, Valid Loss: 3.3919, Valid RMSE: 6.8434, Valid MAPE: 0.0958, Train Time: 8.6656s/epoch, Valid Time: 2.9225s, LR: 9.0250e-04
2023-11-28 02:33:21,186 - Epoch: 023, Train Loss: 3.1342, Train RMSE: 6.4039, Train MAPE: 0.0868, Valid Loss: 3.4097, Valid RMSE: 6.8459, Valid MAPE: 0.0937, Train Time: 8.4342s/epoch, Valid Time: 2.6325s, LR: 9.0250e-04
2023-11-28 02:33:31,836 - Epoch: 024, Train Loss: 3.1074, Train RMSE: 6.3382, Train MAPE: 0.0858, Valid Loss: 3.3079, Valid RMSE: 6.7875, Valid MAPE: 0.0957, Train Time: 7.9210s/epoch, Valid Time: 2.7283s, LR: 9.0250e-04
2023-11-28 02:33:42,533 - Epoch: 025, Train Loss: 3.1022, Train RMSE: 6.3276, Train MAPE: 0.0856, Valid Loss: 3.2738, Valid RMSE: 6.7677, Valid MAPE: 0.0972, Train Time: 7.9376s/epoch, Valid Time: 2.7592s, LR: 9.0250e-04
2023-11-28 02:33:53,253 - Epoch: 026, Train Loss: 3.0685, Train RMSE: 6.2409, Train MAPE: 0.0846, Valid Loss: 3.2309, Valid RMSE: 6.6188, Valid MAPE: 0.0939, Train Time: 7.6900s/epoch, Valid Time: 3.0297s, LR: 9.0250e-04
2023-11-28 02:33:53,258 - Val loss decrease from 3.2590 to 3.2309
2023-11-28 02:34:03,696 - Epoch: 027, Train Loss: 3.0700, Train RMSE: 6.2188, Train MAPE: 0.0844, Valid Loss: 3.3032, Valid RMSE: 6.7111, Valid MAPE: 0.0944, Train Time: 7.2641s/epoch, Valid Time: 3.1736s, LR: 9.0250e-04
2023-11-28 02:34:15,225 - Epoch: 028, Train Loss: 3.0283, Train RMSE: 6.1403, Train MAPE: 0.0832, Valid Loss: 3.2835, Valid RMSE: 6.6568, Valid MAPE: 0.0940, Train Time: 8.3974s/epoch, Valid Time: 3.1311s, LR: 9.0250e-04
2023-11-28 02:34:26,384 - Epoch: 029, Train Loss: 3.0095, Train RMSE: 6.0936, Train MAPE: 0.0824, Valid Loss: 3.2856, Valid RMSE: 6.6326, Valid MAPE: 0.0943, Train Time: 8.1471s/epoch, Valid Time: 3.0118s, LR: 9.0250e-04
2023-11-28 02:34:37,264 - Epoch: 030, Train Loss: 2.9978, Train RMSE: 6.0689, Train MAPE: 0.0819, Valid Loss: 3.2412, Valid RMSE: 6.6288, Valid MAPE: 0.0942, Train Time: 7.8930s/epoch, Valid Time: 2.9855s, LR: 9.0250e-04
2023-11-28 02:34:48,121 - Epoch: 031, Train Loss: 2.9804, Train RMSE: 6.0078, Train MAPE: 0.0812, Valid Loss: 3.1944, Valid RMSE: 6.5959, Valid MAPE: 0.0933, Train Time: 8.0631s/epoch, Valid Time: 2.7937s, LR: 8.5737e-04
2023-11-28 02:34:48,126 - Val loss decrease from 3.2309 to 3.1944
2023-11-28 02:34:59,351 - Epoch: 032, Train Loss: 2.9505, Train RMSE: 5.9453, Train MAPE: 0.0802, Valid Loss: 3.2228, Valid RMSE: 6.6664, Valid MAPE: 0.0937, Train Time: 8.2203s/epoch, Valid Time: 3.0041s, LR: 8.5737e-04
2023-11-28 02:35:11,083 - Epoch: 033, Train Loss: 2.9461, Train RMSE: 5.9427, Train MAPE: 0.0802, Valid Loss: 3.2200, Valid RMSE: 6.6655, Valid MAPE: 0.0954, Train Time: 8.6723s/epoch, Valid Time: 3.0588s, LR: 8.5737e-04
2023-11-28 02:35:22,028 - Epoch: 034, Train Loss: 2.9360, Train RMSE: 5.9048, Train MAPE: 0.0796, Valid Loss: 3.1980, Valid RMSE: 6.6149, Valid MAPE: 0.0956, Train Time: 7.8682s/epoch, Valid Time: 3.0767s, LR: 8.5737e-04
2023-11-28 02:35:33,066 - Epoch: 035, Train Loss: 2.9249, Train RMSE: 5.9012, Train MAPE: 0.0794, Valid Loss: 3.2195, Valid RMSE: 6.5661, Valid MAPE: 0.0929, Train Time: 8.0932s/epoch, Valid Time: 2.9443s, LR: 8.5737e-04
2023-11-28 02:35:43,866 - Epoch: 036, Train Loss: 2.9100, Train RMSE: 5.8550, Train MAPE: 0.0790, Valid Loss: 3.2121, Valid RMSE: 6.5988, Valid MAPE: 0.0931, Train Time: 7.8690s/epoch, Valid Time: 2.9302s, LR: 8.5737e-04
2023-11-28 02:35:54,693 - Epoch: 037, Train Loss: 2.9067, Train RMSE: 5.8613, Train MAPE: 0.0786, Valid Loss: 3.1998, Valid RMSE: 6.6268, Valid MAPE: 0.0946, Train Time: 7.9695s/epoch, Valid Time: 2.8578s, LR: 8.5737e-04
2023-11-28 02:36:05,971 - Epoch: 038, Train Loss: 2.8825, Train RMSE: 5.8009, Train MAPE: 0.0779, Valid Loss: 3.2602, Valid RMSE: 6.6456, Valid MAPE: 0.0918, Train Time: 8.2276s/epoch, Valid Time: 3.0497s, LR: 8.5737e-04
2023-11-28 02:36:17,419 - Epoch: 039, Train Loss: 2.8707, Train RMSE: 5.7861, Train MAPE: 0.0774, Valid Loss: 3.3033, Valid RMSE: 6.7774, Valid MAPE: 0.0940, Train Time: 8.4875s/epoch, Valid Time: 2.9602s, LR: 8.5737e-04
2023-11-28 02:36:29,141 - Epoch: 040, Train Loss: 2.8614, Train RMSE: 5.7574, Train MAPE: 0.0770, Valid Loss: 3.2640, Valid RMSE: 6.6879, Valid MAPE: 0.0940, Train Time: 8.7073s/epoch, Valid Time: 3.0139s, LR: 8.5737e-04
2023-11-28 02:36:38,992 - Epoch: 041, Train Loss: 2.8588, Train RMSE: 5.7511, Train MAPE: 0.0770, Valid Loss: 3.2526, Valid RMSE: 6.6885, Valid MAPE: 0.0954, Train Time: 7.4241s/epoch, Valid Time: 2.4265s, LR: 8.1451e-04
2023-11-28 02:36:38,992 - Early stop at epoch 41, loss = 3.194412
2023-11-28 02:36:44,672 - Horizon 1, Test MAE: 2.6066, Test RMSE: 4.6321, Test MAPE: 0.0673
2023-11-28 02:36:44,680 - Horizon 2, Test MAE: 2.8562, Test RMSE: 5.3425, Test MAPE: 0.0759
2023-11-28 02:36:44,688 - Horizon 3, Test MAE: 3.0441, Test RMSE: 5.8637, Test MAPE: 0.0828
2023-11-28 02:36:44,695 - Horizon 4, Test MAE: 3.2142, Test RMSE: 6.3071, Test MAPE: 0.0894
2023-11-28 02:36:44,703 - Horizon 5, Test MAE: 3.3677, Test RMSE: 6.6833, Test MAPE: 0.0954
2023-11-28 02:36:44,711 - Horizon 6, Test MAE: 3.4896, Test RMSE: 6.9950, Test MAPE: 0.1003
2023-11-28 02:36:44,718 - Horizon 7, Test MAE: 3.6019, Test RMSE: 7.2870, Test MAPE: 0.1047
2023-11-28 02:36:44,726 - Horizon 8, Test MAE: 3.7109, Test RMSE: 7.5368, Test MAPE: 0.1091
2023-11-28 02:36:44,733 - Horizon 9, Test MAE: 3.8032, Test RMSE: 7.7519, Test MAPE: 0.1126
2023-11-28 02:36:44,741 - Horizon 10, Test MAE: 3.8955, Test RMSE: 7.9415, Test MAPE: 0.1159
2023-11-28 02:36:44,749 - Horizon 11, Test MAE: 3.9824, Test RMSE: 8.1185, Test MAPE: 0.1192
2023-11-28 02:36:44,757 - Horizon 12, Test MAE: 4.0783, Test RMSE: 8.3062, Test MAPE: 0.1228
2023-11-28 02:36:44,757 - Average Test MAE: 3.4709, Test RMSE: 6.8971, Test MAPE: 0.0996
