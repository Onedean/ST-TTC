2025-05-08 16:57:33,072 - Namespace(device='cuda:1', dataset='PEMS07', fewshot=6, eval_method='norm', years='2017', seed=2018, bs=64, seq_len=12, horizon=12, input_dim=3, output_dim=1, mode='train', max_epochs=100, patience=10, model_name='stgcn', Kt=3, Ks=3, block_num=2, step_size=10, gamma=0.95, lrate=0.001, wdecay=0.0005, dropout=0.5, clip_grad_value=0)
2025-05-08 16:57:33,073 - Adj path: /home/weichen/stg_project/LargeST/data/pems07/pems07_rn_adj.npy
2025-05-08 16:57:34,563 - Data shape: (28224, 883, 3)
2025-05-08 16:57:35,584 - Sample num: 1692, Batch num: 26
2025-05-08 16:57:36,606 - Sample num: 5640, Batch num: 88
2025-05-08 16:57:37,632 - Sample num: 5640, Batch num: 88
2025-05-08 16:57:38,719 - The arc of model:
STGCN(
  (st_blocks): Sequential(
    (0): STConvBlock(
      (tmp_conv1): TemporalConvLayer(
        (align): Align(
          (align_conv): Conv2d(3, 64, kernel_size=(1, 1), stride=(1, 1))
        )
        (sigmoid): Sigmoid()
        (causal_conv): CausalConv2d(3, 128, kernel_size=(3, 1), stride=(1, 1))
      )
      (graph_conv): GraphConvLayer(
        (align): Align(
          (align_conv): Conv2d(64, 16, kernel_size=(1, 1), stride=(1, 1))
        )
        (cheb_graph_conv): ChebGraphConv()
      )
      (tmp_conv2): TemporalConvLayer(
        (align): Align(
          (align_conv): Conv2d(16, 64, kernel_size=(1, 1), stride=(1, 1))
        )
        (sigmoid): Sigmoid()
        (causal_conv): CausalConv2d(16, 128, kernel_size=(3, 1), stride=(1, 1))
      )
      (tc2_ln): LayerNorm((883, 64), eps=1e-05, elementwise_affine=True)
      (relu): ReLU()
      (dropout): Dropout(p=0.5, inplace=False)
    )
    (1): STConvBlock(
      (tmp_conv1): TemporalConvLayer(
        (align): Align(
          (align_conv): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1))
        )
        (sigmoid): Sigmoid()
        (causal_conv): CausalConv2d(64, 128, kernel_size=(3, 1), stride=(1, 1))
      )
      (graph_conv): GraphConvLayer(
        (align): Align(
          (align_conv): Conv2d(64, 16, kernel_size=(1, 1), stride=(1, 1))
        )
        (cheb_graph_conv): ChebGraphConv()
      )
      (tmp_conv2): TemporalConvLayer(
        (align): Align(
          (align_conv): Conv2d(16, 64, kernel_size=(1, 1), stride=(1, 1))
        )
        (sigmoid): Sigmoid()
        (causal_conv): CausalConv2d(16, 128, kernel_size=(3, 1), stride=(1, 1))
      )
      (tc2_ln): LayerNorm((883, 64), eps=1e-05, elementwise_affine=True)
      (relu): ReLU()
      (dropout): Dropout(p=0.5, inplace=False)
    )
  )
  (output): OutputBlock(
    (tmp_conv1): TemporalConvLayer(
      (align): Align(
        (align_conv): Conv2d(64, 128, kernel_size=(1, 1), stride=(1, 1))
      )
      (sigmoid): Sigmoid()
      (causal_conv): CausalConv2d(64, 256, kernel_size=(4, 1), stride=(1, 1))
    )
    (fc1): Linear(in_features=128, out_features=128, bias=True)
    (fc2): Linear(in_features=128, out_features=12, bias=True)
    (tc1_ln): LayerNorm((883, 128), eps=1e-05, elementwise_affine=True)
    (relu): ReLU()
  )
)
2025-05-08 16:57:38,720 - Number of total parameters: 593036, tunable parameters: 593036
2025-05-08 16:57:38,720 - The number of parameters: 593036
2025-05-08 16:57:38,720 - Start training!
2025-05-08 16:58:22,089 - Epoch: 001, Train Loss: 81.2309, Train RMSE: 104.9453, Train MAPE: 0.9284, Valid Loss: 48.0248, Valid RMSE: 67.2510, Valid MAPE: 0.4116, Train Time: 18.8088s/epoch, Valid Time: 24.5602s, LR: 1.0000e-03
2025-05-08 16:58:22,112 - Val loss decrease from inf to 48.0248
2025-05-08 16:59:02,018 - Epoch: 002, Train Loss: 47.7442, Train RMSE: 66.6034, Train MAPE: 0.3877, Valid Loss: 39.4742, Valid RMSE: 57.3615, Valid MAPE: 0.2839, Train Time: 17.5132s/epoch, Valid Time: 22.3924s, LR: 1.0000e-03
2025-05-08 16:59:02,027 - Val loss decrease from 48.0248 to 39.4742
2025-05-08 16:59:41,833 - Epoch: 003, Train Loss: 40.9169, Train RMSE: 58.5059, Train MAPE: 0.2950, Valid Loss: 34.9325, Valid RMSE: 50.7762, Valid MAPE: 0.2374, Train Time: 17.1902s/epoch, Valid Time: 22.6157s, LR: 1.0000e-03
2025-05-08 16:59:41,841 - Val loss decrease from 39.4742 to 34.9325
2025-05-08 17:00:21,592 - Epoch: 004, Train Loss: 38.2025, Train RMSE: 54.9745, Train MAPE: 0.2606, Valid Loss: 35.0784, Valid RMSE: 50.0572, Valid MAPE: 0.2208, Train Time: 16.6590s/epoch, Valid Time: 23.0920s, LR: 1.0000e-03
2025-05-08 17:00:57,733 - Epoch: 005, Train Loss: 35.3914, Train RMSE: 51.7154, Train MAPE: 0.2244, Valid Loss: 33.4044, Valid RMSE: 48.2682, Valid MAPE: 0.2254, Train Time: 16.6987s/epoch, Valid Time: 19.4422s, LR: 1.0000e-03
2025-05-08 17:00:57,741 - Val loss decrease from 34.9325 to 33.4044
2025-05-08 17:01:33,640 - Epoch: 006, Train Loss: 34.3677, Train RMSE: 50.4937, Train MAPE: 0.2105, Valid Loss: 31.5437, Valid RMSE: 46.2680, Valid MAPE: 0.1896, Train Time: 15.6330s/epoch, Valid Time: 20.2650s, LR: 1.0000e-03
2025-05-08 17:01:33,649 - Val loss decrease from 33.4044 to 31.5437
2025-05-08 17:02:08,217 - Epoch: 007, Train Loss: 33.5995, Train RMSE: 49.6032, Train MAPE: 0.2007, Valid Loss: 30.8595, Valid RMSE: 45.3448, Valid MAPE: 0.1898, Train Time: 15.2324s/epoch, Valid Time: 19.3355s, LR: 1.0000e-03
2025-05-08 17:02:08,225 - Val loss decrease from 31.5437 to 30.8595
2025-05-08 17:02:45,111 - Epoch: 008, Train Loss: 32.5466, Train RMSE: 47.9579, Train MAPE: 0.1928, Valid Loss: 31.1088, Valid RMSE: 45.3396, Valid MAPE: 0.2029, Train Time: 16.0777s/epoch, Valid Time: 20.8076s, LR: 1.0000e-03
2025-05-08 17:03:23,269 - Epoch: 009, Train Loss: 31.6370, Train RMSE: 46.7729, Train MAPE: 0.1828, Valid Loss: 31.0069, Valid RMSE: 44.7353, Valid MAPE: 0.2154, Train Time: 16.3752s/epoch, Valid Time: 21.7829s, LR: 1.0000e-03
2025-05-08 17:03:56,295 - Epoch: 010, Train Loss: 31.4671, Train RMSE: 46.4209, Train MAPE: 0.1852, Valid Loss: 29.9112, Valid RMSE: 43.4414, Valid MAPE: 0.2049, Train Time: 14.5356s/epoch, Valid Time: 18.4895s, LR: 1.0000e-03
2025-05-08 17:03:56,303 - Val loss decrease from 30.8595 to 29.9112
2025-05-08 17:04:28,026 - Epoch: 011, Train Loss: 30.6760, Train RMSE: 45.4488, Train MAPE: 0.1799, Valid Loss: 29.2396, Valid RMSE: 43.1606, Valid MAPE: 0.1676, Train Time: 13.9883s/epoch, Valid Time: 17.7344s, LR: 9.5000e-04
2025-05-08 17:04:28,034 - Val loss decrease from 29.9112 to 29.2396
2025-05-08 17:05:00,092 - Epoch: 012, Train Loss: 30.3739, Train RMSE: 45.0865, Train MAPE: 0.1726, Valid Loss: 29.3257, Valid RMSE: 43.1906, Valid MAPE: 0.1689, Train Time: 13.6092s/epoch, Valid Time: 18.4487s, LR: 9.5000e-04
2025-05-08 17:05:32,531 - Epoch: 013, Train Loss: 30.2319, Train RMSE: 44.9193, Train MAPE: 0.1745, Valid Loss: 29.0106, Valid RMSE: 42.7668, Valid MAPE: 0.1647, Train Time: 14.0854s/epoch, Valid Time: 18.3532s, LR: 9.5000e-04
2025-05-08 17:05:32,540 - Val loss decrease from 29.2396 to 29.0106
2025-05-08 17:06:04,620 - Epoch: 014, Train Loss: 30.0732, Train RMSE: 44.6804, Train MAPE: 0.1707, Valid Loss: 28.9759, Valid RMSE: 42.7321, Valid MAPE: 0.1878, Train Time: 13.3891s/epoch, Valid Time: 18.6911s, LR: 9.5000e-04
2025-05-08 17:06:04,634 - Val loss decrease from 29.0106 to 28.9759
2025-05-08 17:06:38,784 - Epoch: 015, Train Loss: 29.7778, Train RMSE: 44.3949, Train MAPE: 0.1702, Valid Loss: 28.5354, Valid RMSE: 42.2862, Valid MAPE: 0.1608, Train Time: 14.2531s/epoch, Valid Time: 19.8968s, LR: 9.5000e-04
2025-05-08 17:06:38,793 - Val loss decrease from 28.9759 to 28.5354
2025-05-08 17:07:07,947 - Epoch: 016, Train Loss: 29.7385, Train RMSE: 44.3525, Train MAPE: 0.1681, Valid Loss: 28.9684, Valid RMSE: 42.8374, Valid MAPE: 0.1728, Train Time: 11.5221s/epoch, Valid Time: 17.6323s, LR: 9.5000e-04
2025-05-08 17:07:38,213 - Epoch: 017, Train Loss: 29.7296, Train RMSE: 44.2597, Train MAPE: 0.1706, Valid Loss: 28.5936, Valid RMSE: 42.4805, Valid MAPE: 0.1638, Train Time: 11.6781s/epoch, Valid Time: 18.5879s, LR: 9.5000e-04
2025-05-08 17:08:05,141 - Epoch: 018, Train Loss: 29.0481, Train RMSE: 43.5001, Train MAPE: 0.1577, Valid Loss: 28.2911, Valid RMSE: 42.0040, Valid MAPE: 0.1635, Train Time: 10.1580s/epoch, Valid Time: 16.7698s, LR: 9.5000e-04
2025-05-08 17:08:05,149 - Val loss decrease from 28.5354 to 28.2911
2025-05-08 17:08:28,664 - Epoch: 019, Train Loss: 29.0214, Train RMSE: 43.4093, Train MAPE: 0.1598, Valid Loss: 28.8863, Valid RMSE: 42.7194, Valid MAPE: 0.1780, Train Time: 8.3015s/epoch, Valid Time: 15.2128s, LR: 9.5000e-04
2025-05-08 17:08:50,159 - Epoch: 020, Train Loss: 28.7907, Train RMSE: 43.1434, Train MAPE: 0.1575, Valid Loss: 28.5317, Valid RMSE: 42.4382, Valid MAPE: 0.1678, Train Time: 7.2760s/epoch, Valid Time: 14.2187s, LR: 9.5000e-04
2025-05-08 17:09:13,537 - Epoch: 021, Train Loss: 28.7756, Train RMSE: 43.0940, Train MAPE: 0.1613, Valid Loss: 28.6419, Valid RMSE: 42.5550, Valid MAPE: 0.1629, Train Time: 8.0061s/epoch, Valid Time: 15.3725s, LR: 9.0250e-04
2025-05-08 17:09:37,686 - Epoch: 022, Train Loss: 28.3341, Train RMSE: 42.6733, Train MAPE: 0.1558, Valid Loss: 28.5533, Valid RMSE: 42.3531, Valid MAPE: 0.1874, Train Time: 8.3751s/epoch, Valid Time: 15.7734s, LR: 9.0250e-04
2025-05-08 17:10:01,000 - Epoch: 023, Train Loss: 28.0412, Train RMSE: 42.3243, Train MAPE: 0.1506, Valid Loss: 28.8344, Valid RMSE: 42.9908, Valid MAPE: 0.1671, Train Time: 8.4287s/epoch, Valid Time: 14.8849s, LR: 9.0250e-04
2025-05-08 17:10:23,847 - Epoch: 024, Train Loss: 28.2319, Train RMSE: 42.4443, Train MAPE: 0.1554, Valid Loss: 28.9957, Valid RMSE: 42.8774, Valid MAPE: 0.1923, Train Time: 8.4250s/epoch, Valid Time: 14.4214s, LR: 9.0250e-04
2025-05-08 17:10:48,181 - Epoch: 025, Train Loss: 28.4928, Train RMSE: 42.7460, Train MAPE: 0.1568, Valid Loss: 30.6010, Valid RMSE: 44.4702, Valid MAPE: 0.1925, Train Time: 8.7536s/epoch, Valid Time: 15.5808s, LR: 9.0250e-04
2025-05-08 17:11:11,358 - Epoch: 026, Train Loss: 27.8859, Train RMSE: 42.0543, Train MAPE: 0.1486, Valid Loss: 28.4034, Valid RMSE: 42.6116, Valid MAPE: 0.1577, Train Time: 8.8800s/epoch, Valid Time: 14.2965s, LR: 9.0250e-04
2025-05-08 17:11:36,711 - Epoch: 027, Train Loss: 27.3817, Train RMSE: 41.5514, Train MAPE: 0.1441, Valid Loss: 28.6865, Valid RMSE: 42.8975, Valid MAPE: 0.1601, Train Time: 9.3052s/epoch, Valid Time: 16.0475s, LR: 9.0250e-04
2025-05-08 17:12:00,409 - Epoch: 028, Train Loss: 27.4477, Train RMSE: 41.5999, Train MAPE: 0.1453, Valid Loss: 29.2950, Valid RMSE: 43.4570, Valid MAPE: 0.1541, Train Time: 8.7380s/epoch, Valid Time: 14.9598s, LR: 9.0250e-04
2025-05-08 17:12:00,409 - Early stop at epoch 28, loss = 28.291100
2025-05-08 17:12:14,701 - --------------------------------------------------Norm Test Time Results:--------------------------------------------------
2025-05-08 17:12:14,740 - Horizon 1, Test MAE: 22.5600, Test RMSE: 33.2092, Test MAPE: 0.1319
2025-05-08 17:12:14,779 - Horizon 2, Test MAE: 24.0087, Test RMSE: 35.6898, Test MAPE: 0.1332
2025-05-08 17:12:14,818 - Horizon 3, Test MAE: 25.4279, Test RMSE: 37.6634, Test MAPE: 0.1421
2025-05-08 17:12:14,856 - Horizon 4, Test MAE: 26.3728, Test RMSE: 39.1585, Test MAPE: 0.1437
2025-05-08 17:12:14,895 - Horizon 5, Test MAE: 27.4245, Test RMSE: 40.6124, Test MAPE: 0.1521
2025-05-08 17:12:14,933 - Horizon 6, Test MAE: 28.3648, Test RMSE: 41.9141, Test MAPE: 0.1543
2025-05-08 17:12:14,970 - Horizon 7, Test MAE: 29.1139, Test RMSE: 42.9961, Test MAPE: 0.1537
2025-05-08 17:12:15,008 - Horizon 8, Test MAE: 30.0653, Test RMSE: 44.1108, Test MAPE: 0.1612
2025-05-08 17:12:15,045 - Horizon 9, Test MAE: 30.6573, Test RMSE: 44.9558, Test MAPE: 0.1599
2025-05-08 17:12:15,085 - Horizon 10, Test MAE: 31.4679, Test RMSE: 45.9218, Test MAPE: 0.1683
2025-05-08 17:12:15,123 - Horizon 11, Test MAE: 32.4093, Test RMSE: 47.0404, Test MAPE: 0.1757
2025-05-08 17:12:15,163 - Horizon 12, Test MAE: 33.5981, Test RMSE: 48.4969, Test MAPE: 0.1898
2025-05-08 17:12:15,163 - Average Test MAE: 28.4559, Test RMSE: 41.8141, Test MAPE: 0.1555
2025-05-08 17:12:15,163 - Norm Test Time: 14.1557s
