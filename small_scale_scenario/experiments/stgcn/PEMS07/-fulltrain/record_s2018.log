2023-11-28 13:39:24,873 - Namespace(device='cuda:2', dataset='PEMS07', fewshot=100, prompt=False, years='2017', seed=2018, bs=64, seq_len=12, horizon=12, input_dim=3, output_dim=1, mode='train', max_epochs=100, patience=10, model_name='stgcn', Kt=3, Ks=3, block_num=2, step_size=10, gamma=0.95, lrate=0.001, wdecay=0.0005, dropout=0.5, clip_grad_value=0)
2023-11-28 13:39:24,874 - Adj path: /home/yuxuan/weichen/llm4stg/LargeST/data/pems07/pems07_rn_adj.npy
2023-11-28 13:39:27,708 - Data shape: (28224, 883, 3)
2023-11-28 13:39:29,529 - Sample num: 16921, Batch num: 264
2023-11-28 13:39:31,347 - Sample num: 5640, Batch num: 88
2023-11-28 13:39:35,810 - Sample num: 5640, Batch num: 88
2023-11-28 13:39:36,323 - The arc of model:
STGCN(
  (st_blocks): Sequential(
    (0): STConvBlock(
      (tmp_conv1): TemporalConvLayer(
        (align): Align(
          (align_conv): Conv2d(3, 64, kernel_size=(1, 1), stride=(1, 1))
        )
        (sigmoid): Sigmoid()
        (causal_conv): CausalConv2d(3, 128, kernel_size=(3, 1), stride=(1, 1))
      )
      (graph_conv): GraphConvLayer(
        (align): Align(
          (align_conv): Conv2d(64, 16, kernel_size=(1, 1), stride=(1, 1))
        )
        (cheb_graph_conv): ChebGraphConv()
      )
      (tmp_conv2): TemporalConvLayer(
        (align): Align(
          (align_conv): Conv2d(16, 64, kernel_size=(1, 1), stride=(1, 1))
        )
        (sigmoid): Sigmoid()
        (causal_conv): CausalConv2d(16, 128, kernel_size=(3, 1), stride=(1, 1))
      )
      (tc2_ln): LayerNorm((883, 64), eps=1e-05, elementwise_affine=True)
      (relu): ReLU()
      (dropout): Dropout(p=0.5, inplace=False)
    )
    (1): STConvBlock(
      (tmp_conv1): TemporalConvLayer(
        (align): Align(
          (align_conv): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1))
        )
        (sigmoid): Sigmoid()
        (causal_conv): CausalConv2d(64, 128, kernel_size=(3, 1), stride=(1, 1))
      )
      (graph_conv): GraphConvLayer(
        (align): Align(
          (align_conv): Conv2d(64, 16, kernel_size=(1, 1), stride=(1, 1))
        )
        (cheb_graph_conv): ChebGraphConv()
      )
      (tmp_conv2): TemporalConvLayer(
        (align): Align(
          (align_conv): Conv2d(16, 64, kernel_size=(1, 1), stride=(1, 1))
        )
        (sigmoid): Sigmoid()
        (causal_conv): CausalConv2d(16, 128, kernel_size=(3, 1), stride=(1, 1))
      )
      (tc2_ln): LayerNorm((883, 64), eps=1e-05, elementwise_affine=True)
      (relu): ReLU()
      (dropout): Dropout(p=0.5, inplace=False)
    )
  )
  (output): OutputBlock(
    (tmp_conv1): TemporalConvLayer(
      (align): Align(
        (align_conv): Conv2d(64, 128, kernel_size=(1, 1), stride=(1, 1))
      )
      (sigmoid): Sigmoid()
      (causal_conv): CausalConv2d(64, 256, kernel_size=(4, 1), stride=(1, 1))
    )
    (fc1): Linear(in_features=128, out_features=128, bias=True)
    (fc2): Linear(in_features=128, out_features=12, bias=True)
    (tc1_ln): LayerNorm((883, 128), eps=1e-05, elementwise_affine=True)
    (relu): ReLU()
  )
)
2023-11-28 13:39:36,324 - The number of parameters: 593036
2023-11-28 13:39:36,324 - Start training!
2023-11-28 13:41:59,439 - Epoch: 001, Train Loss: 40.3541, Train RMSE: 57.1028, Train MAPE: 0.3184, Valid Loss: 28.7187, Valid RMSE: 42.4303, Valid MAPE: 0.1832, Train Time: 126.7550s/epoch, Valid Time: 16.3602s, LR: 1.0000e-03
2023-11-28 13:41:59,471 - Val loss decrease from inf to 28.7187
2023-11-28 13:44:21,752 - Epoch: 002, Train Loss: 28.9980, Train RMSE: 43.1038, Train MAPE: 0.1663, Valid Loss: 27.0035, Valid RMSE: 40.4033, Valid MAPE: 0.1564, Train Time: 126.3860s/epoch, Valid Time: 15.8947s, LR: 1.0000e-03
2023-11-28 13:44:21,765 - Val loss decrease from 28.7187 to 27.0035
2023-11-28 13:46:46,451 - Epoch: 003, Train Loss: 27.5461, Train RMSE: 41.2861, Train MAPE: 0.1528, Valid Loss: 26.6178, Valid RMSE: 39.8368, Valid MAPE: 0.1947, Train Time: 127.7430s/epoch, Valid Time: 16.9422s, LR: 1.0000e-03
2023-11-28 13:46:46,464 - Val loss decrease from 27.0035 to 26.6178
2023-11-28 13:49:10,041 - Epoch: 004, Train Loss: 26.5900, Train RMSE: 40.0964, Train MAPE: 0.1441, Valid Loss: 25.9503, Valid RMSE: 39.1461, Valid MAPE: 0.1439, Train Time: 126.2741s/epoch, Valid Time: 17.3020s, LR: 1.0000e-03
2023-11-28 13:49:10,065 - Val loss decrease from 26.6178 to 25.9503
2023-11-28 13:51:31,718 - Epoch: 005, Train Loss: 25.7464, Train RMSE: 39.0646, Train MAPE: 0.1367, Valid Loss: 25.5867, Valid RMSE: 38.7531, Valid MAPE: 0.1345, Train Time: 125.8122s/epoch, Valid Time: 15.8405s, LR: 1.0000e-03
2023-11-28 13:51:31,727 - Val loss decrease from 25.9503 to 25.5867
2023-11-28 13:53:43,657 - Epoch: 006, Train Loss: 25.1500, Train RMSE: 38.3462, Train MAPE: 0.1320, Valid Loss: 25.1570, Valid RMSE: 38.4791, Valid MAPE: 0.1337, Train Time: 117.1345s/epoch, Valid Time: 14.7955s, LR: 1.0000e-03
2023-11-28 13:53:43,684 - Val loss decrease from 25.5867 to 25.1570
2023-11-28 13:56:05,065 - Epoch: 007, Train Loss: 24.6042, Train RMSE: 37.6895, Train MAPE: 0.1280, Valid Loss: 25.6262, Valid RMSE: 39.0595, Valid MAPE: 0.1341, Train Time: 125.7884s/epoch, Valid Time: 15.5920s, LR: 1.0000e-03
2023-11-28 13:58:27,902 - Epoch: 008, Train Loss: 24.1856, Train RMSE: 37.2042, Train MAPE: 0.1244, Valid Loss: 25.4836, Valid RMSE: 38.6518, Valid MAPE: 0.1373, Train Time: 126.0807s/epoch, Valid Time: 16.7557s, LR: 1.0000e-03
2023-11-28 14:00:54,272 - Epoch: 009, Train Loss: 23.9253, Train RMSE: 36.8649, Train MAPE: 0.1223, Valid Loss: 24.4291, Valid RMSE: 37.5099, Valid MAPE: 0.1265, Train Time: 129.5899s/epoch, Valid Time: 16.7800s, LR: 1.0000e-03
2023-11-28 14:00:54,288 - Val loss decrease from 25.1570 to 24.4291
2023-11-28 14:03:17,711 - Epoch: 010, Train Loss: 23.6205, Train RMSE: 36.5095, Train MAPE: 0.1193, Valid Loss: 24.7586, Valid RMSE: 38.0664, Valid MAPE: 0.1221, Train Time: 127.4062s/epoch, Valid Time: 16.0166s, LR: 1.0000e-03
2023-11-28 14:05:40,404 - Epoch: 011, Train Loss: 23.3169, Train RMSE: 36.1650, Train MAPE: 0.1162, Valid Loss: 24.0514, Valid RMSE: 37.6123, Valid MAPE: 0.1142, Train Time: 126.5205s/epoch, Valid Time: 16.1723s, LR: 9.5000e-04
2023-11-28 14:05:40,412 - Val loss decrease from 24.4291 to 24.0514
2023-11-28 14:07:48,940 - Epoch: 012, Train Loss: 23.1508, Train RMSE: 35.9614, Train MAPE: 0.1154, Valid Loss: 24.7613, Valid RMSE: 37.9884, Valid MAPE: 0.1517, Train Time: 112.0796s/epoch, Valid Time: 16.4480s, LR: 9.5000e-04
2023-11-28 14:10:11,839 - Epoch: 013, Train Loss: 23.0469, Train RMSE: 35.8230, Train MAPE: 0.1146, Valid Loss: 24.2073, Valid RMSE: 37.1060, Valid MAPE: 0.1411, Train Time: 127.0446s/epoch, Valid Time: 15.8543s, LR: 9.5000e-04
2023-11-28 14:12:34,926 - Epoch: 014, Train Loss: 22.7869, Train RMSE: 35.5413, Train MAPE: 0.1118, Valid Loss: 24.4405, Valid RMSE: 37.5770, Valid MAPE: 0.1223, Train Time: 126.8778s/epoch, Valid Time: 16.2079s, LR: 9.5000e-04
2023-11-28 14:14:57,074 - Epoch: 015, Train Loss: 22.7049, Train RMSE: 35.4322, Train MAPE: 0.1115, Valid Loss: 23.8490, Valid RMSE: 37.0547, Valid MAPE: 0.1221, Train Time: 126.1535s/epoch, Valid Time: 15.9948s, LR: 9.5000e-04
2023-11-28 14:14:57,087 - Val loss decrease from 24.0514 to 23.8490
2023-11-28 14:17:20,663 - Epoch: 016, Train Loss: 22.5584, Train RMSE: 35.2781, Train MAPE: 0.1102, Valid Loss: 23.4408, Valid RMSE: 36.4282, Valid MAPE: 0.1271, Train Time: 127.4802s/epoch, Valid Time: 16.0954s, LR: 9.5000e-04
2023-11-28 14:17:20,694 - Val loss decrease from 23.8490 to 23.4408
2023-11-28 14:19:43,034 - Epoch: 017, Train Loss: 22.4705, Train RMSE: 35.1732, Train MAPE: 0.1100, Valid Loss: 23.4562, Valid RMSE: 36.4834, Valid MAPE: 0.1339, Train Time: 126.4659s/epoch, Valid Time: 15.8742s, LR: 9.5000e-04
2023-11-28 14:22:06,732 - Epoch: 018, Train Loss: 22.4803, Train RMSE: 35.1686, Train MAPE: 0.1100, Valid Loss: 23.3447, Valid RMSE: 36.6945, Valid MAPE: 0.1122, Train Time: 127.4729s/epoch, Valid Time: 16.2245s, LR: 9.5000e-04
2023-11-28 14:22:06,745 - Val loss decrease from 23.4408 to 23.3447
2023-11-28 14:24:30,604 - Epoch: 019, Train Loss: 22.2593, Train RMSE: 34.9506, Train MAPE: 0.1069, Valid Loss: 23.8103, Valid RMSE: 37.1843, Valid MAPE: 0.1138, Train Time: 127.7836s/epoch, Valid Time: 16.0756s, LR: 9.5000e-04
2023-11-28 14:26:53,911 - Epoch: 020, Train Loss: 22.3123, Train RMSE: 34.9758, Train MAPE: 0.1085, Valid Loss: 23.9704, Valid RMSE: 36.9811, Valid MAPE: 0.1293, Train Time: 127.3774s/epoch, Valid Time: 15.9292s, LR: 9.5000e-04
2023-11-28 14:29:16,469 - Epoch: 021, Train Loss: 22.2811, Train RMSE: 34.9185, Train MAPE: 0.1082, Valid Loss: 23.3343, Valid RMSE: 36.5103, Valid MAPE: 0.1191, Train Time: 126.9834s/epoch, Valid Time: 15.5744s, LR: 9.0250e-04
2023-11-28 14:29:16,481 - Val loss decrease from 23.3447 to 23.3343
2023-11-28 14:31:39,616 - Epoch: 022, Train Loss: 22.0392, Train RMSE: 34.7058, Train MAPE: 0.1046, Valid Loss: 23.4058, Valid RMSE: 36.3452, Valid MAPE: 0.1169, Train Time: 127.5150s/epoch, Valid Time: 15.6201s, LR: 9.0250e-04
2023-11-28 14:34:02,034 - Epoch: 023, Train Loss: 21.9895, Train RMSE: 34.6376, Train MAPE: 0.1047, Valid Loss: 23.4441, Valid RMSE: 36.6951, Valid MAPE: 0.1200, Train Time: 126.7639s/epoch, Valid Time: 15.6531s, LR: 9.0250e-04
2023-11-28 14:36:24,760 - Epoch: 024, Train Loss: 21.9883, Train RMSE: 34.6278, Train MAPE: 0.1046, Valid Loss: 22.8272, Valid RMSE: 36.0290, Valid MAPE: 0.1076, Train Time: 126.9820s/epoch, Valid Time: 15.7443s, LR: 9.0250e-04
2023-11-28 14:36:24,788 - Val loss decrease from 23.3343 to 22.8272
2023-11-28 14:38:50,099 - Epoch: 025, Train Loss: 21.9420, Train RMSE: 34.5655, Train MAPE: 0.1048, Valid Loss: 23.4165, Valid RMSE: 36.6775, Valid MAPE: 0.1178, Train Time: 128.8350s/epoch, Valid Time: 16.4749s, LR: 9.0250e-04
2023-11-28 14:41:15,438 - Epoch: 026, Train Loss: 21.8920, Train RMSE: 34.5170, Train MAPE: 0.1044, Valid Loss: 23.6403, Valid RMSE: 36.7346, Valid MAPE: 0.1149, Train Time: 128.1975s/epoch, Valid Time: 17.1412s, LR: 9.0250e-04
2023-11-28 14:43:40,934 - Epoch: 027, Train Loss: 21.7799, Train RMSE: 34.4043, Train MAPE: 0.1029, Valid Loss: 22.7924, Valid RMSE: 36.1888, Valid MAPE: 0.1124, Train Time: 129.2277s/epoch, Valid Time: 16.2679s, LR: 9.0250e-04
2023-11-28 14:43:40,944 - Val loss decrease from 22.8272 to 22.7924
2023-11-28 14:45:57,697 - Epoch: 028, Train Loss: 21.8044, Train RMSE: 34.4080, Train MAPE: 0.1034, Valid Loss: 22.6043, Valid RMSE: 35.8700, Valid MAPE: 0.1056, Train Time: 120.9009s/epoch, Valid Time: 15.8527s, LR: 9.0250e-04
2023-11-28 14:45:57,710 - Val loss decrease from 22.7924 to 22.6043
2023-11-28 14:48:20,778 - Epoch: 029, Train Loss: 21.7147, Train RMSE: 34.3260, Train MAPE: 0.1026, Valid Loss: 22.9684, Valid RMSE: 36.2469, Valid MAPE: 0.1108, Train Time: 127.1368s/epoch, Valid Time: 15.9312s, LR: 9.0250e-04
2023-11-28 14:50:44,610 - Epoch: 030, Train Loss: 21.6807, Train RMSE: 34.2818, Train MAPE: 0.1018, Valid Loss: 22.9301, Valid RMSE: 36.5210, Valid MAPE: 0.1077, Train Time: 126.1597s/epoch, Valid Time: 17.6723s, LR: 9.0250e-04
2023-11-28 14:52:52,256 - Epoch: 031, Train Loss: 21.6692, Train RMSE: 34.2658, Train MAPE: 0.1018, Valid Loss: 23.0555, Valid RMSE: 36.4762, Valid MAPE: 0.1072, Train Time: 113.5026s/epoch, Valid Time: 14.1431s, LR: 8.5737e-04
2023-11-28 14:55:08,776 - Epoch: 032, Train Loss: 21.5368, Train RMSE: 34.1338, Train MAPE: 0.1008, Valid Loss: 22.9569, Valid RMSE: 36.2124, Valid MAPE: 0.1123, Train Time: 120.7730s/epoch, Valid Time: 15.7455s, LR: 8.5737e-04
2023-11-28 14:57:32,352 - Epoch: 033, Train Loss: 21.5645, Train RMSE: 34.1562, Train MAPE: 0.1007, Valid Loss: 22.5994, Valid RMSE: 35.8138, Valid MAPE: 0.1073, Train Time: 126.9737s/epoch, Valid Time: 16.6016s, LR: 8.5737e-04
2023-11-28 14:57:32,359 - Val loss decrease from 22.6043 to 22.5994
2023-11-28 14:59:47,124 - Epoch: 034, Train Loss: 21.5370, Train RMSE: 34.1124, Train MAPE: 0.1009, Valid Loss: 22.9207, Valid RMSE: 35.9297, Valid MAPE: 0.1168, Train Time: 120.5653s/epoch, Valid Time: 14.1989s, LR: 8.5737e-04
2023-11-28 15:01:52,319 - Epoch: 035, Train Loss: 21.4161, Train RMSE: 34.0093, Train MAPE: 0.0997, Valid Loss: 22.4413, Valid RMSE: 35.8823, Valid MAPE: 0.1029, Train Time: 112.0719s/epoch, Valid Time: 13.1230s, LR: 8.5737e-04
2023-11-28 15:01:52,326 - Val loss decrease from 22.5994 to 22.4413
2023-11-28 15:04:06,915 - Epoch: 036, Train Loss: 21.4333, Train RMSE: 34.0152, Train MAPE: 0.0998, Valid Loss: 22.5293, Valid RMSE: 35.7687, Valid MAPE: 0.1119, Train Time: 118.9636s/epoch, Valid Time: 15.6247s, LR: 8.5737e-04
2023-11-28 15:06:30,465 - Epoch: 037, Train Loss: 21.4557, Train RMSE: 34.0234, Train MAPE: 0.1004, Valid Loss: 22.0877, Valid RMSE: 35.6573, Valid MAPE: 0.0997, Train Time: 127.3102s/epoch, Valid Time: 16.2390s, LR: 8.5737e-04
2023-11-28 15:06:30,472 - Val loss decrease from 22.4413 to 22.0877
2023-11-28 15:08:39,585 - Epoch: 038, Train Loss: 21.4154, Train RMSE: 33.9781, Train MAPE: 0.1000, Valid Loss: 22.1093, Valid RMSE: 35.4261, Valid MAPE: 0.1052, Train Time: 113.7557s/epoch, Valid Time: 15.3571s, LR: 8.5737e-04
2023-11-28 15:10:45,698 - Epoch: 039, Train Loss: 21.4039, Train RMSE: 33.9728, Train MAPE: 0.0998, Valid Loss: 22.5005, Valid RMSE: 36.0232, Valid MAPE: 0.1052, Train Time: 111.9796s/epoch, Valid Time: 14.1333s, LR: 8.5737e-04
2023-11-28 15:12:47,035 - Epoch: 040, Train Loss: 21.3212, Train RMSE: 33.8854, Train MAPE: 0.0990, Valid Loss: 22.6392, Valid RMSE: 36.0053, Valid MAPE: 0.1075, Train Time: 107.2815s/epoch, Valid Time: 14.0550s, LR: 8.5737e-04
2023-11-28 15:15:01,918 - Epoch: 041, Train Loss: 21.2718, Train RMSE: 33.8456, Train MAPE: 0.0985, Valid Loss: 22.2353, Valid RMSE: 35.7056, Valid MAPE: 0.1028, Train Time: 119.0733s/epoch, Valid Time: 15.8096s, LR: 8.1451e-04
2023-11-28 15:17:08,240 - Epoch: 042, Train Loss: 21.2780, Train RMSE: 33.8357, Train MAPE: 0.0988, Valid Loss: 22.1655, Valid RMSE: 35.6265, Valid MAPE: 0.1017, Train Time: 113.0204s/epoch, Valid Time: 13.3012s, LR: 8.1451e-04
2023-11-28 15:19:25,048 - Epoch: 043, Train Loss: 21.2842, Train RMSE: 33.8400, Train MAPE: 0.0987, Valid Loss: 22.6885, Valid RMSE: 35.9909, Valid MAPE: 0.1066, Train Time: 120.2988s/epoch, Valid Time: 16.5087s, LR: 8.1451e-04
2023-11-28 15:21:49,037 - Epoch: 044, Train Loss: 21.1980, Train RMSE: 33.7644, Train MAPE: 0.0979, Valid Loss: 22.5001, Valid RMSE: 35.6658, Valid MAPE: 0.1092, Train Time: 127.2778s/epoch, Valid Time: 16.7103s, LR: 8.1451e-04
2023-11-28 15:23:55,739 - Epoch: 045, Train Loss: 21.1616, Train RMSE: 33.7251, Train MAPE: 0.0977, Valid Loss: 22.8187, Valid RMSE: 36.1386, Valid MAPE: 0.1078, Train Time: 112.0244s/epoch, Valid Time: 14.6768s, LR: 8.1451e-04
2023-11-28 15:26:19,368 - Epoch: 046, Train Loss: 21.2084, Train RMSE: 33.7488, Train MAPE: 0.0983, Valid Loss: 22.4718, Valid RMSE: 35.7981, Valid MAPE: 0.1054, Train Time: 127.0058s/epoch, Valid Time: 16.6226s, LR: 8.1451e-04
2023-11-28 15:28:26,304 - Epoch: 047, Train Loss: 21.1367, Train RMSE: 33.6904, Train MAPE: 0.0979, Valid Loss: 22.4077, Valid RMSE: 35.8938, Valid MAPE: 0.1029, Train Time: 112.7314s/epoch, Valid Time: 14.2049s, LR: 8.1451e-04
2023-11-28 15:28:26,305 - Early stop at epoch 47, loss = 22.087721
2023-11-28 15:28:39,097 - Horizon 1, Test MAE: 19.4372, Test RMSE: 30.3000, Test MAPE: 0.0868
2023-11-28 15:28:39,124 - Horizon 2, Test MAE: 20.3488, Test RMSE: 32.1135, Test MAPE: 0.0915
2023-11-28 15:28:39,150 - Horizon 3, Test MAE: 21.0674, Test RMSE: 33.4368, Test MAPE: 0.0953
2023-11-28 15:28:39,176 - Horizon 4, Test MAE: 21.5793, Test RMSE: 34.4209, Test MAPE: 0.0966
2023-11-28 15:28:39,203 - Horizon 5, Test MAE: 21.9584, Test RMSE: 35.2037, Test MAPE: 0.0959
2023-11-28 15:28:39,229 - Horizon 6, Test MAE: 22.3303, Test RMSE: 35.9125, Test MAPE: 0.0962
2023-11-28 15:28:39,255 - Horizon 7, Test MAE: 22.7347, Test RMSE: 36.5916, Test MAPE: 0.0978
2023-11-28 15:28:39,282 - Horizon 8, Test MAE: 23.1230, Test RMSE: 37.2328, Test MAPE: 0.0995
2023-11-28 15:28:39,308 - Horizon 9, Test MAE: 23.4226, Test RMSE: 37.7924, Test MAPE: 0.1004
2023-11-28 15:28:39,334 - Horizon 10, Test MAE: 23.7318, Test RMSE: 38.3405, Test MAPE: 0.1018
2023-11-28 15:28:39,360 - Horizon 11, Test MAE: 24.0709, Test RMSE: 38.9199, Test MAPE: 0.1035
2023-11-28 15:28:39,387 - Horizon 12, Test MAE: 24.5875, Test RMSE: 39.6671, Test MAPE: 0.1059
2023-11-28 15:28:39,387 - Average Test MAE: 22.3660, Test RMSE: 35.8276, Test MAPE: 0.0976
