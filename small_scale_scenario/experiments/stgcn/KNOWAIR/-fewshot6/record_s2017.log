2025-05-08 02:01:35,601 - Namespace(device='cuda:1', dataset='KNOWAIR', fewshot=6, eval_method='norm', years='2015', seed=2017, bs=64, seq_len=12, horizon=12, input_dim=3, output_dim=1, mode='train', max_epochs=100, patience=10, model_name='stgcn', Kt=3, Ks=3, block_num=2, step_size=10, gamma=0.95, lrate=0.001, wdecay=0.0005, dropout=0.5, clip_grad_value=0)
2025-05-08 02:01:35,605 - Adj path: /home/weichen/stg_project/LargeST/data/knowair/knowair_rn_adj.npy
2025-05-08 02:01:36,114 - Data shape: (11688, 184, 3)
2025-05-08 02:01:36,202 - Sample num: 700, Batch num: 10
2025-05-08 02:01:36,291 - Sample num: 2333, Batch num: 36
2025-05-08 02:01:36,383 - Sample num: 2333, Batch num: 36
2025-05-08 02:01:37,194 - The arc of model:
STGCN(
  (st_blocks): Sequential(
    (0): STConvBlock(
      (tmp_conv1): TemporalConvLayer(
        (align): Align(
          (align_conv): Conv2d(3, 64, kernel_size=(1, 1), stride=(1, 1))
        )
        (sigmoid): Sigmoid()
        (causal_conv): CausalConv2d(3, 128, kernel_size=(3, 1), stride=(1, 1))
      )
      (graph_conv): GraphConvLayer(
        (align): Align(
          (align_conv): Conv2d(64, 16, kernel_size=(1, 1), stride=(1, 1))
        )
        (cheb_graph_conv): ChebGraphConv()
      )
      (tmp_conv2): TemporalConvLayer(
        (align): Align(
          (align_conv): Conv2d(16, 64, kernel_size=(1, 1), stride=(1, 1))
        )
        (sigmoid): Sigmoid()
        (causal_conv): CausalConv2d(16, 128, kernel_size=(3, 1), stride=(1, 1))
      )
      (tc2_ln): LayerNorm((184, 64), eps=1e-05, elementwise_affine=True)
      (relu): ReLU()
      (dropout): Dropout(p=0.5, inplace=False)
    )
    (1): STConvBlock(
      (tmp_conv1): TemporalConvLayer(
        (align): Align(
          (align_conv): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1))
        )
        (sigmoid): Sigmoid()
        (causal_conv): CausalConv2d(64, 128, kernel_size=(3, 1), stride=(1, 1))
      )
      (graph_conv): GraphConvLayer(
        (align): Align(
          (align_conv): Conv2d(64, 16, kernel_size=(1, 1), stride=(1, 1))
        )
        (cheb_graph_conv): ChebGraphConv()
      )
      (tmp_conv2): TemporalConvLayer(
        (align): Align(
          (align_conv): Conv2d(16, 64, kernel_size=(1, 1), stride=(1, 1))
        )
        (sigmoid): Sigmoid()
        (causal_conv): CausalConv2d(16, 128, kernel_size=(3, 1), stride=(1, 1))
      )
      (tc2_ln): LayerNorm((184, 64), eps=1e-05, elementwise_affine=True)
      (relu): ReLU()
      (dropout): Dropout(p=0.5, inplace=False)
    )
  )
  (output): OutputBlock(
    (tmp_conv1): TemporalConvLayer(
      (align): Align(
        (align_conv): Conv2d(64, 128, kernel_size=(1, 1), stride=(1, 1))
      )
      (sigmoid): Sigmoid()
      (causal_conv): CausalConv2d(64, 256, kernel_size=(4, 1), stride=(1, 1))
    )
    (fc1): Linear(in_features=128, out_features=128, bias=True)
    (fc2): Linear(in_features=128, out_features=12, bias=True)
    (tc1_ln): LayerNorm((184, 128), eps=1e-05, elementwise_affine=True)
    (relu): ReLU()
  )
)
2025-05-08 02:01:37,194 - Number of total parameters: 235148, tunable parameters: 235148
2025-05-08 02:01:37,194 - The number of parameters: 235148
2025-05-08 02:01:37,194 - Start training!
2025-05-08 02:01:41,722 - Epoch: 001, Train Loss: 37.8348, Train RMSE: 53.3658, Train MAPE: 0.7954, Valid Loss: 24.5333, Valid RMSE: 35.1550, Valid MAPE: 0.8961, Train Time: 2.4294s/epoch, Valid Time: 2.0985s, LR: 1.0000e-03
2025-05-08 02:01:41,728 - Val loss decrease from inf to 24.5333
2025-05-08 02:01:45,811 - Epoch: 002, Train Loss: 34.0210, Train RMSE: 48.6955, Train MAPE: 0.7147, Valid Loss: 24.5307, Valid RMSE: 34.1240, Valid MAPE: 0.9685, Train Time: 1.9411s/epoch, Valid Time: 2.1423s, LR: 1.0000e-03
2025-05-08 02:01:45,816 - Val loss decrease from 24.5333 to 24.5307
2025-05-08 02:01:49,440 - Epoch: 003, Train Loss: 32.4971, Train RMSE: 47.0085, Train MAPE: 0.6805, Valid Loss: 23.3968, Valid RMSE: 33.1151, Valid MAPE: 0.9034, Train Time: 1.6348s/epoch, Valid Time: 1.9886s, LR: 1.0000e-03
2025-05-08 02:01:49,445 - Val loss decrease from 24.5307 to 23.3968
2025-05-08 02:01:53,358 - Epoch: 004, Train Loss: 31.3217, Train RMSE: 45.5555, Train MAPE: 0.6447, Valid Loss: 22.8716, Valid RMSE: 32.3076, Valid MAPE: 0.8900, Train Time: 1.8945s/epoch, Valid Time: 2.0182s, LR: 1.0000e-03
2025-05-08 02:01:53,363 - Val loss decrease from 23.3968 to 22.8716
2025-05-08 02:01:57,038 - Epoch: 005, Train Loss: 30.8879, Train RMSE: 45.0869, Train MAPE: 0.6167, Valid Loss: 22.7988, Valid RMSE: 32.1773, Valid MAPE: 0.9021, Train Time: 1.8436s/epoch, Valid Time: 1.8313s, LR: 1.0000e-03
2025-05-08 02:01:57,044 - Val loss decrease from 22.8716 to 22.7988
2025-05-08 02:02:01,083 - Epoch: 006, Train Loss: 30.1325, Train RMSE: 43.9809, Train MAPE: 0.6198, Valid Loss: 20.7513, Valid RMSE: 31.6585, Valid MAPE: 0.6615, Train Time: 1.9559s/epoch, Valid Time: 2.0831s, LR: 1.0000e-03
2025-05-08 02:02:01,088 - Val loss decrease from 22.7988 to 20.7513
2025-05-08 02:02:04,862 - Epoch: 007, Train Loss: 29.8053, Train RMSE: 43.7571, Train MAPE: 0.5960, Valid Loss: 21.4597, Valid RMSE: 31.4693, Valid MAPE: 0.7792, Train Time: 1.8721s/epoch, Valid Time: 1.9017s, LR: 1.0000e-03
2025-05-08 02:02:08,617 - Epoch: 008, Train Loss: 29.4063, Train RMSE: 42.9937, Train MAPE: 0.6062, Valid Loss: 20.9756, Valid RMSE: 31.5403, Valid MAPE: 0.7107, Train Time: 1.6572s/epoch, Valid Time: 2.0972s, LR: 1.0000e-03
2025-05-08 02:02:12,607 - Epoch: 009, Train Loss: 29.1318, Train RMSE: 42.7336, Train MAPE: 0.5910, Valid Loss: 21.3106, Valid RMSE: 32.0555, Valid MAPE: 0.7404, Train Time: 1.7462s/epoch, Valid Time: 2.2442s, LR: 1.0000e-03
2025-05-08 02:02:16,152 - Epoch: 010, Train Loss: 28.9555, Train RMSE: 42.4868, Train MAPE: 0.5863, Valid Loss: 22.2707, Valid RMSE: 31.6334, Valid MAPE: 0.8610, Train Time: 1.6140s/epoch, Valid Time: 1.9302s, LR: 1.0000e-03
2025-05-08 02:02:20,098 - Epoch: 011, Train Loss: 28.5341, Train RMSE: 42.1206, Train MAPE: 0.5707, Valid Loss: 20.8132, Valid RMSE: 31.6344, Valid MAPE: 0.6903, Train Time: 1.8401s/epoch, Valid Time: 2.1060s, LR: 9.5000e-04
2025-05-08 02:02:23,681 - Epoch: 012, Train Loss: 28.4849, Train RMSE: 42.0204, Train MAPE: 0.5715, Valid Loss: 20.6456, Valid RMSE: 31.7032, Valid MAPE: 0.6359, Train Time: 1.7867s/epoch, Valid Time: 1.7960s, LR: 9.5000e-04
2025-05-08 02:02:23,687 - Val loss decrease from 20.7513 to 20.6456
2025-05-08 02:02:27,734 - Epoch: 013, Train Loss: 28.4236, Train RMSE: 41.8699, Train MAPE: 0.5653, Valid Loss: 21.2845, Valid RMSE: 31.6037, Valid MAPE: 0.7576, Train Time: 1.9989s/epoch, Valid Time: 2.0479s, LR: 9.5000e-04
2025-05-08 02:02:31,652 - Epoch: 014, Train Loss: 28.2880, Train RMSE: 41.8794, Train MAPE: 0.5596, Valid Loss: 21.0205, Valid RMSE: 31.5382, Valid MAPE: 0.7311, Train Time: 1.7274s/epoch, Valid Time: 2.1909s, LR: 9.5000e-04
2025-05-08 02:02:35,280 - Epoch: 015, Train Loss: 28.0058, Train RMSE: 41.4658, Train MAPE: 0.5536, Valid Loss: 20.7085, Valid RMSE: 31.8625, Valid MAPE: 0.6535, Train Time: 1.7159s/epoch, Valid Time: 1.9121s, LR: 9.5000e-04
2025-05-08 02:02:38,867 - Epoch: 016, Train Loss: 27.8981, Train RMSE: 41.1951, Train MAPE: 0.5499, Valid Loss: 20.7583, Valid RMSE: 31.7106, Valid MAPE: 0.6709, Train Time: 1.5278s/epoch, Valid Time: 2.0585s, LR: 9.5000e-04
2025-05-08 02:02:42,601 - Epoch: 017, Train Loss: 27.7283, Train RMSE: 40.9489, Train MAPE: 0.5423, Valid Loss: 20.9274, Valid RMSE: 31.5433, Valid MAPE: 0.7176, Train Time: 1.5880s/epoch, Valid Time: 2.1455s, LR: 9.5000e-04
2025-05-08 02:02:46,430 - Epoch: 018, Train Loss: 27.5145, Train RMSE: 40.7891, Train MAPE: 0.5416, Valid Loss: 21.0392, Valid RMSE: 31.5420, Valid MAPE: 0.7283, Train Time: 1.7269s/epoch, Valid Time: 2.1023s, LR: 9.5000e-04
2025-05-08 02:02:50,056 - Epoch: 019, Train Loss: 27.4102, Train RMSE: 40.7448, Train MAPE: 0.5358, Valid Loss: 20.7980, Valid RMSE: 31.5950, Valid MAPE: 0.7017, Train Time: 1.8163s/epoch, Valid Time: 1.8089s, LR: 9.5000e-04
2025-05-08 02:02:53,804 - Epoch: 020, Train Loss: 27.4345, Train RMSE: 40.4953, Train MAPE: 0.5410, Valid Loss: 20.5591, Valid RMSE: 31.9700, Valid MAPE: 0.6211, Train Time: 1.9619s/epoch, Valid Time: 1.7860s, LR: 9.5000e-04
2025-05-08 02:02:53,809 - Val loss decrease from 20.6456 to 20.5591
2025-05-08 02:02:57,440 - Epoch: 021, Train Loss: 27.5615, Train RMSE: 40.8231, Train MAPE: 0.5414, Valid Loss: 21.3242, Valid RMSE: 31.8591, Valid MAPE: 0.7442, Train Time: 1.8538s/epoch, Valid Time: 1.7775s, LR: 9.0250e-04
2025-05-08 02:03:01,144 - Epoch: 022, Train Loss: 27.6182, Train RMSE: 40.8045, Train MAPE: 0.5418, Valid Loss: 20.6025, Valid RMSE: 32.1226, Valid MAPE: 0.6313, Train Time: 1.8543s/epoch, Valid Time: 1.8492s, LR: 9.0250e-04
2025-05-08 02:03:04,584 - Epoch: 023, Train Loss: 27.4632, Train RMSE: 40.7220, Train MAPE: 0.5355, Valid Loss: 22.5297, Valid RMSE: 32.1867, Valid MAPE: 0.8689, Train Time: 1.6559s/epoch, Valid Time: 1.7837s, LR: 9.0250e-04
2025-05-08 02:03:08,492 - Epoch: 024, Train Loss: 27.1892, Train RMSE: 40.1177, Train MAPE: 0.5386, Valid Loss: 20.8446, Valid RMSE: 31.4567, Valid MAPE: 0.7120, Train Time: 1.7196s/epoch, Valid Time: 2.1884s, LR: 9.0250e-04
2025-05-08 02:03:11,945 - Epoch: 025, Train Loss: 27.0192, Train RMSE: 40.1535, Train MAPE: 0.5206, Valid Loss: 21.0587, Valid RMSE: 31.4196, Valid MAPE: 0.7412, Train Time: 1.5276s/epoch, Valid Time: 1.9243s, LR: 9.0250e-04
2025-05-08 02:03:15,697 - Epoch: 026, Train Loss: 26.9142, Train RMSE: 39.9885, Train MAPE: 0.5248, Valid Loss: 20.8867, Valid RMSE: 31.6604, Valid MAPE: 0.7063, Train Time: 1.7551s/epoch, Valid Time: 1.9972s, LR: 9.0250e-04
2025-05-08 02:03:19,240 - Epoch: 027, Train Loss: 27.0511, Train RMSE: 40.1194, Train MAPE: 0.5321, Valid Loss: 21.2070, Valid RMSE: 31.5742, Valid MAPE: 0.7573, Train Time: 1.6556s/epoch, Valid Time: 1.8871s, LR: 9.0250e-04
2025-05-08 02:03:23,166 - Epoch: 028, Train Loss: 26.7894, Train RMSE: 39.9031, Train MAPE: 0.5225, Valid Loss: 20.5735, Valid RMSE: 31.2504, Valid MAPE: 0.6802, Train Time: 1.8463s/epoch, Valid Time: 2.0797s, LR: 9.0250e-04
2025-05-08 02:03:27,097 - Epoch: 029, Train Loss: 26.8812, Train RMSE: 39.9403, Train MAPE: 0.5247, Valid Loss: 20.6826, Valid RMSE: 31.4076, Valid MAPE: 0.6767, Train Time: 1.8605s/epoch, Valid Time: 2.0701s, LR: 9.0250e-04
2025-05-08 02:03:31,030 - Epoch: 030, Train Loss: 26.7118, Train RMSE: 39.6115, Train MAPE: 0.5233, Valid Loss: 20.4283, Valid RMSE: 31.4865, Valid MAPE: 0.6437, Train Time: 1.8990s/epoch, Valid Time: 2.0335s, LR: 9.0250e-04
2025-05-08 02:03:31,035 - Val loss decrease from 20.5591 to 20.4283
2025-05-08 02:03:34,762 - Epoch: 031, Train Loss: 26.5002, Train RMSE: 39.4852, Train MAPE: 0.5152, Valid Loss: 20.8187, Valid RMSE: 31.4747, Valid MAPE: 0.6983, Train Time: 1.7587s/epoch, Valid Time: 1.9675s, LR: 8.5737e-04
2025-05-08 02:03:38,606 - Epoch: 032, Train Loss: 26.5692, Train RMSE: 39.6020, Train MAPE: 0.5103, Valid Loss: 21.4685, Valid RMSE: 31.9118, Valid MAPE: 0.7581, Train Time: 1.7097s/epoch, Valid Time: 2.1346s, LR: 8.5737e-04
2025-05-08 02:03:42,476 - Epoch: 033, Train Loss: 26.4985, Train RMSE: 39.4319, Train MAPE: 0.5148, Valid Loss: 20.7528, Valid RMSE: 31.4963, Valid MAPE: 0.6826, Train Time: 1.6999s/epoch, Valid Time: 2.1697s, LR: 8.5737e-04
2025-05-08 02:03:46,013 - Epoch: 034, Train Loss: 26.1588, Train RMSE: 38.8418, Train MAPE: 0.5136, Valid Loss: 20.7240, Valid RMSE: 31.7062, Valid MAPE: 0.6546, Train Time: 1.6890s/epoch, Valid Time: 1.8472s, LR: 8.5737e-04
2025-05-08 02:03:49,903 - Epoch: 035, Train Loss: 26.4082, Train RMSE: 39.2943, Train MAPE: 0.5091, Valid Loss: 21.3619, Valid RMSE: 31.9659, Valid MAPE: 0.7454, Train Time: 1.8126s/epoch, Valid Time: 2.0778s, LR: 8.5737e-04
2025-05-08 02:03:53,649 - Epoch: 036, Train Loss: 26.4347, Train RMSE: 39.4215, Train MAPE: 0.5072, Valid Loss: 21.1887, Valid RMSE: 31.6394, Valid MAPE: 0.7462, Train Time: 1.8183s/epoch, Valid Time: 1.9275s, LR: 8.5737e-04
2025-05-08 02:03:57,584 - Epoch: 037, Train Loss: 26.1804, Train RMSE: 38.9440, Train MAPE: 0.5110, Valid Loss: 20.3788, Valid RMSE: 31.4538, Valid MAPE: 0.6466, Train Time: 1.9165s/epoch, Valid Time: 2.0178s, LR: 8.5737e-04
2025-05-08 02:03:57,589 - Val loss decrease from 20.4283 to 20.3788
2025-05-08 02:04:01,340 - Epoch: 038, Train Loss: 26.1657, Train RMSE: 38.9927, Train MAPE: 0.5107, Valid Loss: 20.6781, Valid RMSE: 31.5474, Valid MAPE: 0.6889, Train Time: 1.6977s/epoch, Valid Time: 2.0532s, LR: 8.5737e-04
2025-05-08 02:04:04,629 - Epoch: 039, Train Loss: 25.9009, Train RMSE: 38.6760, Train MAPE: 0.4991, Valid Loss: 21.1852, Valid RMSE: 31.7860, Valid MAPE: 0.7422, Train Time: 1.5366s/epoch, Valid Time: 1.7524s, LR: 8.5737e-04
2025-05-08 02:04:08,125 - Epoch: 040, Train Loss: 25.9267, Train RMSE: 38.6281, Train MAPE: 0.5018, Valid Loss: 20.5077, Valid RMSE: 31.6618, Valid MAPE: 0.6277, Train Time: 1.5280s/epoch, Valid Time: 1.9672s, LR: 8.5737e-04
2025-05-08 02:04:11,255 - Epoch: 041, Train Loss: 26.1661, Train RMSE: 38.9077, Train MAPE: 0.5062, Valid Loss: 20.8750, Valid RMSE: 31.6917, Valid MAPE: 0.7015, Train Time: 1.4012s/epoch, Valid Time: 1.7284s, LR: 8.1451e-04
2025-05-08 02:04:14,296 - Epoch: 042, Train Loss: 25.8766, Train RMSE: 38.7613, Train MAPE: 0.4926, Valid Loss: 21.4900, Valid RMSE: 32.1295, Valid MAPE: 0.7571, Train Time: 1.2367s/epoch, Valid Time: 1.8043s, LR: 8.1451e-04
2025-05-08 02:04:17,409 - Epoch: 043, Train Loss: 25.9206, Train RMSE: 38.6944, Train MAPE: 0.5039, Valid Loss: 20.5153, Valid RMSE: 31.5581, Valid MAPE: 0.6517, Train Time: 1.3967s/epoch, Valid Time: 1.7164s, LR: 8.1451e-04
2025-05-08 02:04:20,058 - Epoch: 044, Train Loss: 25.7612, Train RMSE: 38.5049, Train MAPE: 0.4965, Valid Loss: 20.8284, Valid RMSE: 31.7306, Valid MAPE: 0.6880, Train Time: 1.0504s/epoch, Valid Time: 1.5978s, LR: 8.1451e-04
2025-05-08 02:04:22,557 - Epoch: 045, Train Loss: 25.6815, Train RMSE: 38.3486, Train MAPE: 0.4916, Valid Loss: 21.7366, Valid RMSE: 32.1101, Valid MAPE: 0.7903, Train Time: 0.9305s/epoch, Valid Time: 1.5688s, LR: 8.1451e-04
2025-05-08 02:04:24,896 - Epoch: 046, Train Loss: 25.7229, Train RMSE: 38.3054, Train MAPE: 0.4973, Valid Loss: 21.8693, Valid RMSE: 32.4382, Valid MAPE: 0.7839, Train Time: 0.8561s/epoch, Valid Time: 1.4826s, LR: 8.1451e-04
2025-05-08 02:04:27,179 - Epoch: 047, Train Loss: 25.5681, Train RMSE: 38.2851, Train MAPE: 0.4879, Valid Loss: 21.6155, Valid RMSE: 32.2207, Valid MAPE: 0.7565, Train Time: 0.8830s/epoch, Valid Time: 1.3995s, LR: 8.1451e-04
2025-05-08 02:04:27,179 - Early stop at epoch 47, loss = 20.378828
2025-05-08 02:04:28,573 - --------------------------------------------------Norm Test Time Results:--------------------------------------------------
2025-05-08 02:04:28,577 - Horizon 1, Test MAE: 9.8421, Test RMSE: 15.6472, Test MAPE: 0.3285
2025-05-08 02:04:28,580 - Horizon 2, Test MAE: 12.4985, Test RMSE: 19.3374, Test MAPE: 0.4408
2025-05-08 02:04:28,583 - Horizon 3, Test MAE: 14.0818, Test RMSE: 21.4400, Test MAPE: 0.4975
2025-05-08 02:04:28,586 - Horizon 4, Test MAE: 15.1980, Test RMSE: 22.9089, Test MAPE: 0.5426
2025-05-08 02:04:28,589 - Horizon 5, Test MAE: 15.9775, Test RMSE: 23.9151, Test MAPE: 0.5903
2025-05-08 02:04:28,592 - Horizon 6, Test MAE: 16.6561, Test RMSE: 24.8503, Test MAPE: 0.6214
2025-05-08 02:04:28,595 - Horizon 7, Test MAE: 17.1553, Test RMSE: 25.4098, Test MAPE: 0.6556
2025-05-08 02:04:28,598 - Horizon 8, Test MAE: 17.7245, Test RMSE: 25.9190, Test MAPE: 0.7022
2025-05-08 02:04:28,601 - Horizon 9, Test MAE: 18.7116, Test RMSE: 27.0016, Test MAPE: 0.7469
2025-05-08 02:04:28,604 - Horizon 10, Test MAE: 19.9323, Test RMSE: 28.2322, Test MAPE: 0.8268
2025-05-08 02:04:28,607 - Horizon 11, Test MAE: 20.5497, Test RMSE: 28.9127, Test MAPE: 0.8544
2025-05-08 02:04:28,610 - Horizon 12, Test MAE: 20.9788, Test RMSE: 29.3223, Test MAPE: 0.8851
2025-05-08 02:04:28,610 - Average Test MAE: 16.6089, Test RMSE: 24.4080, Test MAPE: 0.6410
2025-05-08 02:04:28,610 - Norm Test Time: 1.2455s
