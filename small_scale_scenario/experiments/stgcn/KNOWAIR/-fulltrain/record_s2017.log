2025-05-07 23:38:03,101 - Namespace(device='cuda:1', dataset='KNOWAIR', fewshot=100, eval_method='norm', years='2015', seed=2017, bs=64, seq_len=12, horizon=12, input_dim=3, output_dim=1, mode='train', max_epochs=100, patience=10, model_name='stgcn', Kt=3, Ks=3, block_num=2, step_size=10, gamma=0.95, lrate=0.001, wdecay=0.0005, dropout=0.5, clip_grad_value=0)
2025-05-07 23:38:03,102 - Adj path: /home/weichen/stg_project/LargeST/data/knowair/knowair_rn_adj.npy
2025-05-07 23:38:03,687 - Data shape: (11688, 184, 3)
2025-05-07 23:38:03,776 - Sample num: 6999, Batch num: 109
2025-05-07 23:38:03,865 - Sample num: 2333, Batch num: 36
2025-05-07 23:38:03,953 - Sample num: 2333, Batch num: 36
2025-05-07 23:38:04,760 - The arc of model:
STGCN(
  (st_blocks): Sequential(
    (0): STConvBlock(
      (tmp_conv1): TemporalConvLayer(
        (align): Align(
          (align_conv): Conv2d(3, 64, kernel_size=(1, 1), stride=(1, 1))
        )
        (sigmoid): Sigmoid()
        (causal_conv): CausalConv2d(3, 128, kernel_size=(3, 1), stride=(1, 1))
      )
      (graph_conv): GraphConvLayer(
        (align): Align(
          (align_conv): Conv2d(64, 16, kernel_size=(1, 1), stride=(1, 1))
        )
        (cheb_graph_conv): ChebGraphConv()
      )
      (tmp_conv2): TemporalConvLayer(
        (align): Align(
          (align_conv): Conv2d(16, 64, kernel_size=(1, 1), stride=(1, 1))
        )
        (sigmoid): Sigmoid()
        (causal_conv): CausalConv2d(16, 128, kernel_size=(3, 1), stride=(1, 1))
      )
      (tc2_ln): LayerNorm((184, 64), eps=1e-05, elementwise_affine=True)
      (relu): ReLU()
      (dropout): Dropout(p=0.5, inplace=False)
    )
    (1): STConvBlock(
      (tmp_conv1): TemporalConvLayer(
        (align): Align(
          (align_conv): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1))
        )
        (sigmoid): Sigmoid()
        (causal_conv): CausalConv2d(64, 128, kernel_size=(3, 1), stride=(1, 1))
      )
      (graph_conv): GraphConvLayer(
        (align): Align(
          (align_conv): Conv2d(64, 16, kernel_size=(1, 1), stride=(1, 1))
        )
        (cheb_graph_conv): ChebGraphConv()
      )
      (tmp_conv2): TemporalConvLayer(
        (align): Align(
          (align_conv): Conv2d(16, 64, kernel_size=(1, 1), stride=(1, 1))
        )
        (sigmoid): Sigmoid()
        (causal_conv): CausalConv2d(16, 128, kernel_size=(3, 1), stride=(1, 1))
      )
      (tc2_ln): LayerNorm((184, 64), eps=1e-05, elementwise_affine=True)
      (relu): ReLU()
      (dropout): Dropout(p=0.5, inplace=False)
    )
  )
  (output): OutputBlock(
    (tmp_conv1): TemporalConvLayer(
      (align): Align(
        (align_conv): Conv2d(64, 128, kernel_size=(1, 1), stride=(1, 1))
      )
      (sigmoid): Sigmoid()
      (causal_conv): CausalConv2d(64, 256, kernel_size=(4, 1), stride=(1, 1))
    )
    (fc1): Linear(in_features=128, out_features=128, bias=True)
    (fc2): Linear(in_features=128, out_features=12, bias=True)
    (tc1_ln): LayerNorm((184, 128), eps=1e-05, elementwise_affine=True)
    (relu): ReLU()
  )
)
2025-05-07 23:38:04,760 - Number of total parameters: 235148, tunable parameters: 235148
2025-05-07 23:38:04,760 - The number of parameters: 235148
2025-05-07 23:38:04,760 - Start training!
2025-05-07 23:38:23,883 - Epoch: 001, Train Loss: 24.4407, Train RMSE: 38.8248, Train MAPE: 0.6308, Valid Loss: 19.5412, Valid RMSE: 30.0739, Valid MAPE: 0.6359, Train Time: 17.3407s/epoch, Valid Time: 1.7823s, LR: 1.0000e-03
2025-05-07 23:38:23,888 - Val loss decrease from inf to 19.5412
2025-05-07 23:38:43,278 - Epoch: 002, Train Loss: 22.2638, Train RMSE: 35.5571, Train MAPE: 0.5674, Valid Loss: 18.9341, Valid RMSE: 29.6282, Valid MAPE: 0.5684, Train Time: 17.4807s/epoch, Valid Time: 1.9090s, LR: 1.0000e-03
2025-05-07 23:38:43,283 - Val loss decrease from 19.5412 to 18.9341
2025-05-07 23:39:02,322 - Epoch: 003, Train Loss: 21.7960, Train RMSE: 34.9883, Train MAPE: 0.5493, Valid Loss: 18.6660, Valid RMSE: 29.3987, Valid MAPE: 0.5746, Train Time: 17.1588s/epoch, Valid Time: 1.8805s, LR: 1.0000e-03
2025-05-07 23:39:02,327 - Val loss decrease from 18.9341 to 18.6660
2025-05-07 23:39:21,543 - Epoch: 004, Train Loss: 21.4682, Train RMSE: 34.5425, Train MAPE: 0.5387, Valid Loss: 18.7352, Valid RMSE: 29.6577, Valid MAPE: 0.5262, Train Time: 17.2707s/epoch, Valid Time: 1.9454s, LR: 1.0000e-03
2025-05-07 23:39:40,715 - Epoch: 005, Train Loss: 21.2457, Train RMSE: 34.2137, Train MAPE: 0.5319, Valid Loss: 18.2994, Valid RMSE: 29.0560, Valid MAPE: 0.5422, Train Time: 17.3006s/epoch, Valid Time: 1.8706s, LR: 1.0000e-03
2025-05-07 23:39:40,720 - Val loss decrease from 18.6660 to 18.2994
2025-05-07 23:39:59,822 - Epoch: 006, Train Loss: 21.1088, Train RMSE: 33.9879, Train MAPE: 0.5278, Valid Loss: 18.3445, Valid RMSE: 29.0953, Valid MAPE: 0.5356, Train Time: 17.4356s/epoch, Valid Time: 1.6666s, LR: 1.0000e-03
2025-05-07 23:40:18,812 - Epoch: 007, Train Loss: 20.9243, Train RMSE: 33.7738, Train MAPE: 0.5211, Valid Loss: 18.2891, Valid RMSE: 28.7951, Valid MAPE: 0.5723, Train Time: 17.3503s/epoch, Valid Time: 1.6395s, LR: 1.0000e-03
2025-05-07 23:40:18,817 - Val loss decrease from 18.2994 to 18.2891
2025-05-07 23:40:37,818 - Epoch: 008, Train Loss: 20.8174, Train RMSE: 33.5764, Train MAPE: 0.5175, Valid Loss: 18.0651, Valid RMSE: 28.9372, Valid MAPE: 0.5200, Train Time: 17.3222s/epoch, Valid Time: 1.6783s, LR: 1.0000e-03
2025-05-07 23:40:37,823 - Val loss decrease from 18.2891 to 18.0651
2025-05-07 23:40:56,936 - Epoch: 009, Train Loss: 20.7575, Train RMSE: 33.4799, Train MAPE: 0.5155, Valid Loss: 18.0061, Valid RMSE: 28.7833, Valid MAPE: 0.5385, Train Time: 17.1925s/epoch, Valid Time: 1.9204s, LR: 1.0000e-03
2025-05-07 23:40:56,942 - Val loss decrease from 18.0651 to 18.0061
2025-05-07 23:41:15,880 - Epoch: 010, Train Loss: 20.6152, Train RMSE: 33.3088, Train MAPE: 0.5114, Valid Loss: 18.1356, Valid RMSE: 29.0717, Valid MAPE: 0.5071, Train Time: 17.2426s/epoch, Valid Time: 1.6960s, LR: 1.0000e-03
2025-05-07 23:41:35,078 - Epoch: 011, Train Loss: 20.4930, Train RMSE: 33.0804, Train MAPE: 0.5076, Valid Loss: 17.9521, Valid RMSE: 28.8303, Valid MAPE: 0.5260, Train Time: 17.1716s/epoch, Valid Time: 2.0259s, LR: 9.5000e-04
2025-05-07 23:41:35,083 - Val loss decrease from 18.0061 to 17.9521
2025-05-07 23:41:54,244 - Epoch: 012, Train Loss: 20.4025, Train RMSE: 32.9471, Train MAPE: 0.5046, Valid Loss: 17.9209, Valid RMSE: 28.8785, Valid MAPE: 0.5204, Train Time: 17.2693s/epoch, Valid Time: 1.8919s, LR: 9.5000e-04
2025-05-07 23:41:54,250 - Val loss decrease from 17.9521 to 17.9209
2025-05-07 23:42:13,413 - Epoch: 013, Train Loss: 20.3665, Train RMSE: 32.8587, Train MAPE: 0.5029, Valid Loss: 17.9631, Valid RMSE: 28.7499, Valid MAPE: 0.5417, Train Time: 17.1799s/epoch, Valid Time: 1.9830s, LR: 9.5000e-04
2025-05-07 23:42:32,596 - Epoch: 014, Train Loss: 20.2815, Train RMSE: 32.7674, Train MAPE: 0.5005, Valid Loss: 18.1461, Valid RMSE: 28.9925, Valid MAPE: 0.5253, Train Time: 17.2625s/epoch, Valid Time: 1.9204s, LR: 9.5000e-04
2025-05-07 23:42:51,535 - Epoch: 015, Train Loss: 20.2059, Train RMSE: 32.6010, Train MAPE: 0.4988, Valid Loss: 18.0024, Valid RMSE: 28.9271, Valid MAPE: 0.5278, Train Time: 17.2588s/epoch, Valid Time: 1.6793s, LR: 9.5000e-04
2025-05-07 23:43:10,710 - Epoch: 016, Train Loss: 20.1452, Train RMSE: 32.5267, Train MAPE: 0.4959, Valid Loss: 17.8099, Valid RMSE: 28.7484, Valid MAPE: 0.5259, Train Time: 17.2202s/epoch, Valid Time: 1.9545s, LR: 9.5000e-04
2025-05-07 23:43:10,715 - Val loss decrease from 17.9209 to 17.8099
2025-05-07 23:43:30,130 - Epoch: 017, Train Loss: 20.0244, Train RMSE: 32.2746, Train MAPE: 0.4931, Valid Loss: 17.8561, Valid RMSE: 28.5298, Valid MAPE: 0.5275, Train Time: 17.4054s/epoch, Valid Time: 2.0093s, LR: 9.5000e-04
2025-05-07 23:43:48,882 - Epoch: 018, Train Loss: 19.9804, Train RMSE: 32.2262, Train MAPE: 0.4917, Valid Loss: 17.9153, Valid RMSE: 28.8498, Valid MAPE: 0.5149, Train Time: 17.0152s/epoch, Valid Time: 1.7368s, LR: 9.5000e-04
2025-05-07 23:44:07,954 - Epoch: 019, Train Loss: 19.9380, Train RMSE: 32.1132, Train MAPE: 0.4908, Valid Loss: 17.8180, Valid RMSE: 28.9958, Valid MAPE: 0.5107, Train Time: 17.4063s/epoch, Valid Time: 1.6652s, LR: 9.5000e-04
2025-05-07 23:44:26,877 - Epoch: 020, Train Loss: 19.8323, Train RMSE: 31.9485, Train MAPE: 0.4876, Valid Loss: 17.9579, Valid RMSE: 29.0701, Valid MAPE: 0.5172, Train Time: 17.1540s/epoch, Valid Time: 1.7688s, LR: 9.5000e-04
2025-05-07 23:44:46,161 - Epoch: 021, Train Loss: 19.7874, Train RMSE: 31.8534, Train MAPE: 0.4861, Valid Loss: 17.8893, Valid RMSE: 29.0907, Valid MAPE: 0.5177, Train Time: 17.3416s/epoch, Valid Time: 1.9427s, LR: 9.0250e-04
2025-05-07 23:45:05,297 - Epoch: 022, Train Loss: 19.7288, Train RMSE: 31.7746, Train MAPE: 0.4837, Valid Loss: 17.8081, Valid RMSE: 28.9087, Valid MAPE: 0.5180, Train Time: 17.1588s/epoch, Valid Time: 1.9765s, LR: 9.0250e-04
2025-05-07 23:45:05,302 - Val loss decrease from 17.8099 to 17.8081
2025-05-07 23:45:24,592 - Epoch: 023, Train Loss: 19.7099, Train RMSE: 31.7511, Train MAPE: 0.4842, Valid Loss: 17.8321, Valid RMSE: 28.8414, Valid MAPE: 0.5176, Train Time: 17.3475s/epoch, Valid Time: 1.9430s, LR: 9.0250e-04
2025-05-07 23:45:43,423 - Epoch: 024, Train Loss: 19.6049, Train RMSE: 31.5624, Train MAPE: 0.4805, Valid Loss: 17.7446, Valid RMSE: 28.8169, Valid MAPE: 0.5210, Train Time: 17.1095s/epoch, Valid Time: 1.7209s, LR: 9.0250e-04
2025-05-07 23:45:43,429 - Val loss decrease from 17.8081 to 17.7446
2025-05-07 23:46:02,643 - Epoch: 025, Train Loss: 19.5343, Train RMSE: 31.4505, Train MAPE: 0.4782, Valid Loss: 17.8872, Valid RMSE: 28.8602, Valid MAPE: 0.5280, Train Time: 17.2700s/epoch, Valid Time: 1.9443s, LR: 9.0250e-04
2025-05-07 23:46:21,572 - Epoch: 026, Train Loss: 19.5032, Train RMSE: 31.3880, Train MAPE: 0.4769, Valid Loss: 17.8044, Valid RMSE: 28.8889, Valid MAPE: 0.5123, Train Time: 17.2101s/epoch, Valid Time: 1.7184s, LR: 9.0250e-04
2025-05-07 23:46:40,593 - Epoch: 027, Train Loss: 19.4437, Train RMSE: 31.3016, Train MAPE: 0.4746, Valid Loss: 17.8798, Valid RMSE: 28.9675, Valid MAPE: 0.5270, Train Time: 17.2502s/epoch, Valid Time: 1.7700s, LR: 9.0250e-04
2025-05-07 23:46:59,570 - Epoch: 028, Train Loss: 19.4000, Train RMSE: 31.2169, Train MAPE: 0.4743, Valid Loss: 17.9049, Valid RMSE: 28.6898, Valid MAPE: 0.5327, Train Time: 17.2107s/epoch, Valid Time: 1.7666s, LR: 9.0250e-04
2025-05-07 23:47:18,638 - Epoch: 029, Train Loss: 19.3958, Train RMSE: 31.2195, Train MAPE: 0.4728, Valid Loss: 17.9108, Valid RMSE: 28.9814, Valid MAPE: 0.5198, Train Time: 17.2510s/epoch, Valid Time: 1.8167s, LR: 9.0250e-04
2025-05-07 23:47:37,916 - Epoch: 030, Train Loss: 19.2657, Train RMSE: 31.0165, Train MAPE: 0.4699, Valid Loss: 17.7964, Valid RMSE: 28.8693, Valid MAPE: 0.5170, Train Time: 17.3936s/epoch, Valid Time: 1.8838s, LR: 9.0250e-04
2025-05-07 23:47:56,935 - Epoch: 031, Train Loss: 19.2690, Train RMSE: 31.0157, Train MAPE: 0.4698, Valid Loss: 17.9013, Valid RMSE: 28.8485, Valid MAPE: 0.5464, Train Time: 17.1215s/epoch, Valid Time: 1.8979s, LR: 8.5737e-04
2025-05-07 23:48:16,114 - Epoch: 032, Train Loss: 19.2577, Train RMSE: 30.9989, Train MAPE: 0.4694, Valid Loss: 17.7358, Valid RMSE: 28.8173, Valid MAPE: 0.5218, Train Time: 17.2256s/epoch, Valid Time: 1.9530s, LR: 8.5737e-04
2025-05-07 23:48:16,119 - Val loss decrease from 17.7446 to 17.7358
2025-05-07 23:48:35,077 - Epoch: 033, Train Loss: 19.1448, Train RMSE: 30.8576, Train MAPE: 0.4650, Valid Loss: 18.0513, Valid RMSE: 28.9485, Valid MAPE: 0.5610, Train Time: 17.0518s/epoch, Valid Time: 1.9055s, LR: 8.5737e-04
2025-05-07 23:48:54,163 - Epoch: 034, Train Loss: 19.1521, Train RMSE: 30.8099, Train MAPE: 0.4656, Valid Loss: 17.8487, Valid RMSE: 29.1323, Valid MAPE: 0.5177, Train Time: 17.1746s/epoch, Valid Time: 1.9116s, LR: 8.5737e-04
2025-05-07 23:49:11,280 - Epoch: 035, Train Loss: 19.1318, Train RMSE: 30.8001, Train MAPE: 0.4649, Valid Loss: 17.8127, Valid RMSE: 28.9669, Valid MAPE: 0.5184, Train Time: 15.2637s/epoch, Valid Time: 1.8527s, LR: 8.5737e-04
2025-05-07 23:49:28,152 - Epoch: 036, Train Loss: 19.1246, Train RMSE: 30.7409, Train MAPE: 0.4653, Valid Loss: 17.8963, Valid RMSE: 29.1354, Valid MAPE: 0.5245, Train Time: 15.2990s/epoch, Valid Time: 1.5733s, LR: 8.5737e-04
2025-05-07 23:49:45,042 - Epoch: 037, Train Loss: 19.0357, Train RMSE: 30.6416, Train MAPE: 0.4628, Valid Loss: 17.8587, Valid RMSE: 29.2501, Valid MAPE: 0.5092, Train Time: 15.2435s/epoch, Valid Time: 1.6456s, LR: 8.5737e-04
2025-05-07 23:50:01,620 - Epoch: 038, Train Loss: 19.0293, Train RMSE: 30.6561, Train MAPE: 0.4616, Valid Loss: 18.1938, Valid RMSE: 29.1371, Valid MAPE: 0.5663, Train Time: 15.0413s/epoch, Valid Time: 1.5367s, LR: 8.5737e-04
2025-05-07 23:50:18,627 - Epoch: 039, Train Loss: 19.0039, Train RMSE: 30.5886, Train MAPE: 0.4610, Valid Loss: 18.4717, Valid RMSE: 29.2730, Valid MAPE: 0.5996, Train Time: 15.2046s/epoch, Valid Time: 1.8018s, LR: 8.5737e-04
2025-05-07 23:50:35,340 - Epoch: 040, Train Loss: 18.9574, Train RMSE: 30.4628, Train MAPE: 0.4603, Valid Loss: 17.9451, Valid RMSE: 28.8927, Valid MAPE: 0.5474, Train Time: 15.1921s/epoch, Valid Time: 1.5206s, LR: 8.5737e-04
2025-05-07 23:50:52,385 - Epoch: 041, Train Loss: 18.8807, Train RMSE: 30.4241, Train MAPE: 0.4577, Valid Loss: 17.8130, Valid RMSE: 29.2013, Valid MAPE: 0.5125, Train Time: 15.1984s/epoch, Valid Time: 1.8469s, LR: 8.1451e-04
2025-05-07 23:51:09,606 - Epoch: 042, Train Loss: 18.9571, Train RMSE: 30.4973, Train MAPE: 0.4601, Valid Loss: 17.9878, Valid RMSE: 29.2575, Valid MAPE: 0.5264, Train Time: 15.3583s/epoch, Valid Time: 1.8623s, LR: 8.1451e-04
2025-05-07 23:51:09,606 - Early stop at epoch 42, loss = 17.735823
2025-05-07 23:51:11,586 - --------------------------------------------------Norm Test Time Results:--------------------------------------------------
2025-05-07 23:51:11,589 - Horizon 1, Test MAE: 8.2276, Test RMSE: 13.8775, Test MAPE: 0.2595
2025-05-07 23:51:11,593 - Horizon 2, Test MAE: 10.6517, Test RMSE: 17.4592, Test MAPE: 0.3428
2025-05-07 23:51:11,596 - Horizon 3, Test MAE: 12.0868, Test RMSE: 19.5107, Test MAPE: 0.3945
2025-05-07 23:51:11,600 - Horizon 4, Test MAE: 13.1149, Test RMSE: 21.0016, Test MAPE: 0.4339
2025-05-07 23:51:11,603 - Horizon 5, Test MAE: 13.8552, Test RMSE: 22.0992, Test MAPE: 0.4682
2025-05-07 23:51:11,607 - Horizon 6, Test MAE: 14.4440, Test RMSE: 22.9945, Test MAPE: 0.4967
2025-05-07 23:51:11,610 - Horizon 7, Test MAE: 14.8869, Test RMSE: 23.6375, Test MAPE: 0.5191
2025-05-07 23:51:11,614 - Horizon 8, Test MAE: 15.2948, Test RMSE: 24.1776, Test MAPE: 0.5414
2025-05-07 23:51:11,617 - Horizon 9, Test MAE: 15.8713, Test RMSE: 24.9340, Test MAPE: 0.5685
2025-05-07 23:51:11,620 - Horizon 10, Test MAE: 16.4105, Test RMSE: 25.6165, Test MAPE: 0.5965
2025-05-07 23:51:11,624 - Horizon 11, Test MAE: 16.8066, Test RMSE: 26.0836, Test MAPE: 0.6182
2025-05-07 23:51:11,627 - Horizon 12, Test MAE: 17.1067, Test RMSE: 26.4225, Test MAPE: 0.6341
2025-05-07 23:51:11,628 - Average Test MAE: 14.0631, Test RMSE: 22.3179, Test MAPE: 0.4895
2025-05-07 23:51:11,628 - Norm Test Time: 1.7446s
