2025-05-07 23:38:02,994 - Namespace(device='cuda:1', dataset='KNOWAIR', fewshot=100, eval_method='norm', years='2015', seed=2018, bs=64, seq_len=12, horizon=12, input_dim=3, output_dim=1, mode='train', max_epochs=100, patience=10, model_name='stgcn', Kt=3, Ks=3, block_num=2, step_size=10, gamma=0.95, lrate=0.001, wdecay=0.0005, dropout=0.5, clip_grad_value=0)
2025-05-07 23:38:02,995 - Adj path: /home/weichen/stg_project/LargeST/data/knowair/knowair_rn_adj.npy
2025-05-07 23:38:03,606 - Data shape: (11688, 184, 3)
2025-05-07 23:38:03,695 - Sample num: 6999, Batch num: 109
2025-05-07 23:38:03,783 - Sample num: 2333, Batch num: 36
2025-05-07 23:38:03,870 - Sample num: 2333, Batch num: 36
2025-05-07 23:38:04,692 - The arc of model:
STGCN(
  (st_blocks): Sequential(
    (0): STConvBlock(
      (tmp_conv1): TemporalConvLayer(
        (align): Align(
          (align_conv): Conv2d(3, 64, kernel_size=(1, 1), stride=(1, 1))
        )
        (sigmoid): Sigmoid()
        (causal_conv): CausalConv2d(3, 128, kernel_size=(3, 1), stride=(1, 1))
      )
      (graph_conv): GraphConvLayer(
        (align): Align(
          (align_conv): Conv2d(64, 16, kernel_size=(1, 1), stride=(1, 1))
        )
        (cheb_graph_conv): ChebGraphConv()
      )
      (tmp_conv2): TemporalConvLayer(
        (align): Align(
          (align_conv): Conv2d(16, 64, kernel_size=(1, 1), stride=(1, 1))
        )
        (sigmoid): Sigmoid()
        (causal_conv): CausalConv2d(16, 128, kernel_size=(3, 1), stride=(1, 1))
      )
      (tc2_ln): LayerNorm((184, 64), eps=1e-05, elementwise_affine=True)
      (relu): ReLU()
      (dropout): Dropout(p=0.5, inplace=False)
    )
    (1): STConvBlock(
      (tmp_conv1): TemporalConvLayer(
        (align): Align(
          (align_conv): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1))
        )
        (sigmoid): Sigmoid()
        (causal_conv): CausalConv2d(64, 128, kernel_size=(3, 1), stride=(1, 1))
      )
      (graph_conv): GraphConvLayer(
        (align): Align(
          (align_conv): Conv2d(64, 16, kernel_size=(1, 1), stride=(1, 1))
        )
        (cheb_graph_conv): ChebGraphConv()
      )
      (tmp_conv2): TemporalConvLayer(
        (align): Align(
          (align_conv): Conv2d(16, 64, kernel_size=(1, 1), stride=(1, 1))
        )
        (sigmoid): Sigmoid()
        (causal_conv): CausalConv2d(16, 128, kernel_size=(3, 1), stride=(1, 1))
      )
      (tc2_ln): LayerNorm((184, 64), eps=1e-05, elementwise_affine=True)
      (relu): ReLU()
      (dropout): Dropout(p=0.5, inplace=False)
    )
  )
  (output): OutputBlock(
    (tmp_conv1): TemporalConvLayer(
      (align): Align(
        (align_conv): Conv2d(64, 128, kernel_size=(1, 1), stride=(1, 1))
      )
      (sigmoid): Sigmoid()
      (causal_conv): CausalConv2d(64, 256, kernel_size=(4, 1), stride=(1, 1))
    )
    (fc1): Linear(in_features=128, out_features=128, bias=True)
    (fc2): Linear(in_features=128, out_features=12, bias=True)
    (tc1_ln): LayerNorm((184, 128), eps=1e-05, elementwise_affine=True)
    (relu): ReLU()
  )
)
2025-05-07 23:38:04,692 - Number of total parameters: 235148, tunable parameters: 235148
2025-05-07 23:38:04,692 - The number of parameters: 235148
2025-05-07 23:38:04,692 - Start training!
2025-05-07 23:38:23,778 - Epoch: 001, Train Loss: 24.5862, Train RMSE: 39.0289, Train MAPE: 0.6367, Valid Loss: 19.6080, Valid RMSE: 30.2161, Valid MAPE: 0.6405, Train Time: 17.1784s/epoch, Valid Time: 1.9072s, LR: 1.0000e-03
2025-05-07 23:38:23,783 - Val loss decrease from inf to 19.6080
2025-05-07 23:38:43,029 - Epoch: 002, Train Loss: 22.3887, Train RMSE: 35.7669, Train MAPE: 0.5721, Valid Loss: 19.1164, Valid RMSE: 30.0287, Valid MAPE: 0.5401, Train Time: 17.3728s/epoch, Valid Time: 1.8734s, LR: 1.0000e-03
2025-05-07 23:38:43,034 - Val loss decrease from 19.6080 to 19.1164
2025-05-07 23:39:02,098 - Epoch: 003, Train Loss: 21.8530, Train RMSE: 35.0626, Train MAPE: 0.5527, Valid Loss: 18.6436, Valid RMSE: 29.3420, Valid MAPE: 0.5702, Train Time: 17.1689s/epoch, Valid Time: 1.8951s, LR: 1.0000e-03
2025-05-07 23:39:02,103 - Val loss decrease from 19.1164 to 18.6436
2025-05-07 23:39:21,202 - Epoch: 004, Train Loss: 21.4994, Train RMSE: 34.5697, Train MAPE: 0.5402, Valid Loss: 18.4437, Valid RMSE: 29.1894, Valid MAPE: 0.5421, Train Time: 17.4171s/epoch, Valid Time: 1.6816s, LR: 1.0000e-03
2025-05-07 23:39:21,208 - Val loss decrease from 18.6436 to 18.4437
2025-05-07 23:39:40,122 - Epoch: 005, Train Loss: 21.2519, Train RMSE: 34.2472, Train MAPE: 0.5327, Valid Loss: 18.2916, Valid RMSE: 29.1407, Valid MAPE: 0.5349, Train Time: 17.1726s/epoch, Valid Time: 1.7419s, LR: 1.0000e-03
2025-05-07 23:39:40,127 - Val loss decrease from 18.4437 to 18.2916
2025-05-07 23:39:58,905 - Epoch: 006, Train Loss: 21.0877, Train RMSE: 34.0152, Train MAPE: 0.5263, Valid Loss: 18.2647, Valid RMSE: 29.2584, Valid MAPE: 0.5225, Train Time: 17.0524s/epoch, Valid Time: 1.7248s, LR: 1.0000e-03
2025-05-07 23:39:58,910 - Val loss decrease from 18.2916 to 18.2647
2025-05-07 23:40:17,704 - Epoch: 007, Train Loss: 20.9922, Train RMSE: 33.8718, Train MAPE: 0.5238, Valid Loss: 18.0991, Valid RMSE: 28.8870, Valid MAPE: 0.5377, Train Time: 17.0704s/epoch, Valid Time: 1.7234s, LR: 1.0000e-03
2025-05-07 23:40:17,714 - Val loss decrease from 18.2647 to 18.0991
2025-05-07 23:40:36,925 - Epoch: 008, Train Loss: 20.8018, Train RMSE: 33.5701, Train MAPE: 0.5176, Valid Loss: 18.1713, Valid RMSE: 29.3502, Valid MAPE: 0.5071, Train Time: 17.3053s/epoch, Valid Time: 1.9051s, LR: 1.0000e-03
2025-05-07 23:40:55,553 - Epoch: 009, Train Loss: 20.7969, Train RMSE: 33.5204, Train MAPE: 0.5183, Valid Loss: 18.1246, Valid RMSE: 29.1749, Valid MAPE: 0.5117, Train Time: 16.9697s/epoch, Valid Time: 1.6581s, LR: 1.0000e-03
2025-05-07 23:41:14,667 - Epoch: 010, Train Loss: 20.6456, Train RMSE: 33.3130, Train MAPE: 0.5118, Valid Loss: 17.9660, Valid RMSE: 28.8546, Valid MAPE: 0.5240, Train Time: 17.2493s/epoch, Valid Time: 1.8652s, LR: 1.0000e-03
2025-05-07 23:41:14,673 - Val loss decrease from 18.0991 to 17.9660
2025-05-07 23:41:33,988 - Epoch: 011, Train Loss: 20.5569, Train RMSE: 33.1717, Train MAPE: 0.5088, Valid Loss: 18.0000, Valid RMSE: 28.6474, Valid MAPE: 0.5517, Train Time: 17.2661s/epoch, Valid Time: 2.0490s, LR: 9.5000e-04
2025-05-07 23:41:52,749 - Epoch: 012, Train Loss: 20.4421, Train RMSE: 32.9994, Train MAPE: 0.5052, Valid Loss: 18.0551, Valid RMSE: 28.9359, Valid MAPE: 0.5262, Train Time: 17.0426s/epoch, Valid Time: 1.7184s, LR: 9.5000e-04
2025-05-07 23:42:11,707 - Epoch: 013, Train Loss: 20.3325, Train RMSE: 32.8518, Train MAPE: 0.5018, Valid Loss: 17.9411, Valid RMSE: 28.7998, Valid MAPE: 0.5351, Train Time: 17.1670s/epoch, Valid Time: 1.7903s, LR: 9.5000e-04
2025-05-07 23:42:11,712 - Val loss decrease from 17.9660 to 17.9411
2025-05-07 23:42:30,463 - Epoch: 014, Train Loss: 20.2815, Train RMSE: 32.7402, Train MAPE: 0.5001, Valid Loss: 17.9563, Valid RMSE: 28.9268, Valid MAPE: 0.5184, Train Time: 17.0249s/epoch, Valid Time: 1.7258s, LR: 9.5000e-04
2025-05-07 23:42:49,707 - Epoch: 015, Train Loss: 20.1887, Train RMSE: 32.5787, Train MAPE: 0.4976, Valid Loss: 18.0905, Valid RMSE: 28.9308, Valid MAPE: 0.5585, Train Time: 17.2792s/epoch, Valid Time: 1.9649s, LR: 9.5000e-04
2025-05-07 23:43:08,652 - Epoch: 016, Train Loss: 20.1185, Train RMSE: 32.4572, Train MAPE: 0.4962, Valid Loss: 17.9552, Valid RMSE: 28.7698, Valid MAPE: 0.5500, Train Time: 17.0085s/epoch, Valid Time: 1.9361s, LR: 9.5000e-04
2025-05-07 23:43:27,962 - Epoch: 017, Train Loss: 20.0700, Train RMSE: 32.3784, Train MAPE: 0.4932, Valid Loss: 18.0373, Valid RMSE: 28.9881, Valid MAPE: 0.5385, Train Time: 17.3536s/epoch, Valid Time: 1.9559s, LR: 9.5000e-04
2025-05-07 23:43:46,553 - Epoch: 018, Train Loss: 19.9927, Train RMSE: 32.2274, Train MAPE: 0.4913, Valid Loss: 17.8602, Valid RMSE: 28.8501, Valid MAPE: 0.5321, Train Time: 16.8038s/epoch, Valid Time: 1.7868s, LR: 9.5000e-04
2025-05-07 23:43:46,558 - Val loss decrease from 17.9411 to 17.8602
2025-05-07 23:44:05,618 - Epoch: 019, Train Loss: 19.9434, Train RMSE: 32.1470, Train MAPE: 0.4902, Valid Loss: 18.3210, Valid RMSE: 28.9295, Valid MAPE: 0.5840, Train Time: 17.0835s/epoch, Valid Time: 1.9764s, LR: 9.5000e-04
2025-05-07 23:44:24,698 - Epoch: 020, Train Loss: 19.8493, Train RMSE: 31.9414, Train MAPE: 0.4871, Valid Loss: 17.8711, Valid RMSE: 28.5213, Valid MAPE: 0.5415, Train Time: 17.1357s/epoch, Valid Time: 1.9440s, LR: 9.5000e-04
2025-05-07 23:44:43,972 - Epoch: 021, Train Loss: 19.7943, Train RMSE: 31.8864, Train MAPE: 0.4855, Valid Loss: 17.8420, Valid RMSE: 29.1059, Valid MAPE: 0.5215, Train Time: 17.3700s/epoch, Valid Time: 1.9038s, LR: 9.0250e-04
2025-05-07 23:44:43,977 - Val loss decrease from 17.8602 to 17.8420
2025-05-07 23:45:03,259 - Epoch: 022, Train Loss: 19.6956, Train RMSE: 31.7503, Train MAPE: 0.4820, Valid Loss: 17.9719, Valid RMSE: 29.1480, Valid MAPE: 0.5290, Train Time: 17.2731s/epoch, Valid Time: 2.0089s, LR: 9.0250e-04
2025-05-07 23:45:21,980 - Epoch: 023, Train Loss: 19.6589, Train RMSE: 31.6920, Train MAPE: 0.4805, Valid Loss: 17.8124, Valid RMSE: 29.2206, Valid MAPE: 0.5069, Train Time: 16.9754s/epoch, Valid Time: 1.7454s, LR: 9.0250e-04
2025-05-07 23:45:21,985 - Val loss decrease from 17.8420 to 17.8124
2025-05-07 23:45:40,704 - Epoch: 024, Train Loss: 19.5579, Train RMSE: 31.4867, Train MAPE: 0.4786, Valid Loss: 17.8261, Valid RMSE: 28.7773, Valid MAPE: 0.5012, Train Time: 16.9161s/epoch, Valid Time: 1.8023s, LR: 9.0250e-04
2025-05-07 23:45:59,738 - Epoch: 025, Train Loss: 19.5288, Train RMSE: 31.4489, Train MAPE: 0.4772, Valid Loss: 17.7985, Valid RMSE: 28.8510, Valid MAPE: 0.5108, Train Time: 17.3090s/epoch, Valid Time: 1.7244s, LR: 9.0250e-04
2025-05-07 23:45:59,743 - Val loss decrease from 17.8124 to 17.7985
2025-05-07 23:46:18,755 - Epoch: 026, Train Loss: 19.4871, Train RMSE: 31.3988, Train MAPE: 0.4758, Valid Loss: 17.8447, Valid RMSE: 28.8310, Valid MAPE: 0.5207, Train Time: 17.0509s/epoch, Valid Time: 1.9611s, LR: 9.0250e-04
2025-05-07 23:46:37,489 - Epoch: 027, Train Loss: 19.4738, Train RMSE: 31.3792, Train MAPE: 0.4745, Valid Loss: 18.2477, Valid RMSE: 29.3292, Valid MAPE: 0.5623, Train Time: 16.9934s/epoch, Valid Time: 1.7399s, LR: 9.0250e-04
2025-05-07 23:46:56,686 - Epoch: 028, Train Loss: 19.4458, Train RMSE: 31.2842, Train MAPE: 0.4748, Valid Loss: 17.7868, Valid RMSE: 29.1783, Valid MAPE: 0.5137, Train Time: 17.2338s/epoch, Valid Time: 1.9636s, LR: 9.0250e-04
2025-05-07 23:46:56,691 - Val loss decrease from 17.7985 to 17.7868
2025-05-07 23:47:15,536 - Epoch: 029, Train Loss: 19.3517, Train RMSE: 31.1831, Train MAPE: 0.4716, Valid Loss: 17.8888, Valid RMSE: 29.3572, Valid MAPE: 0.5168, Train Time: 16.9391s/epoch, Valid Time: 1.9049s, LR: 9.0250e-04
2025-05-07 23:47:34,275 - Epoch: 030, Train Loss: 19.3238, Train RMSE: 31.1149, Train MAPE: 0.4710, Valid Loss: 18.0288, Valid RMSE: 29.5706, Valid MAPE: 0.4860, Train Time: 16.7889s/epoch, Valid Time: 1.9503s, LR: 9.0250e-04
2025-05-07 23:47:53,429 - Epoch: 031, Train Loss: 19.2649, Train RMSE: 31.0292, Train MAPE: 0.4684, Valid Loss: 17.8974, Valid RMSE: 29.0525, Valid MAPE: 0.5281, Train Time: 17.1716s/epoch, Valid Time: 1.9822s, LR: 8.5737e-04
2025-05-07 23:48:12,732 - Epoch: 032, Train Loss: 19.2509, Train RMSE: 30.9944, Train MAPE: 0.4686, Valid Loss: 17.9810, Valid RMSE: 29.2477, Valid MAPE: 0.5326, Train Time: 17.2842s/epoch, Valid Time: 2.0180s, LR: 8.5737e-04
2025-05-07 23:48:31,862 - Epoch: 033, Train Loss: 19.2035, Train RMSE: 30.9184, Train MAPE: 0.4661, Valid Loss: 17.7697, Valid RMSE: 28.9799, Valid MAPE: 0.5189, Train Time: 17.1644s/epoch, Valid Time: 1.9663s, LR: 8.5737e-04
2025-05-07 23:48:31,868 - Val loss decrease from 17.7868 to 17.7697
2025-05-07 23:48:50,511 - Epoch: 034, Train Loss: 19.1783, Train RMSE: 30.8819, Train MAPE: 0.4666, Valid Loss: 18.2384, Valid RMSE: 29.1950, Valid MAPE: 0.5684, Train Time: 16.8950s/epoch, Valid Time: 1.7479s, LR: 8.5737e-04
2025-05-07 23:49:07,423 - Epoch: 035, Train Loss: 19.2024, Train RMSE: 30.8998, Train MAPE: 0.4671, Valid Loss: 17.9784, Valid RMSE: 29.3687, Valid MAPE: 0.4897, Train Time: 15.3146s/epoch, Valid Time: 1.5973s, LR: 8.5737e-04
2025-05-07 23:49:24,544 - Epoch: 036, Train Loss: 19.1249, Train RMSE: 30.7857, Train MAPE: 0.4641, Valid Loss: 17.9061, Valid RMSE: 29.2420, Valid MAPE: 0.5245, Train Time: 15.2945s/epoch, Valid Time: 1.8265s, LR: 8.5737e-04
2025-05-07 23:49:41,551 - Epoch: 037, Train Loss: 19.0622, Train RMSE: 30.7060, Train MAPE: 0.4625, Valid Loss: 17.9225, Valid RMSE: 28.9978, Valid MAPE: 0.5340, Train Time: 15.2017s/epoch, Valid Time: 1.8056s, LR: 8.5737e-04
2025-05-07 23:49:58,183 - Epoch: 038, Train Loss: 19.0040, Train RMSE: 30.6206, Train MAPE: 0.4610, Valid Loss: 18.2850, Valid RMSE: 29.2064, Valid MAPE: 0.5741, Train Time: 15.0707s/epoch, Valid Time: 1.5602s, LR: 8.5737e-04
2025-05-07 23:50:14,945 - Epoch: 039, Train Loss: 19.0095, Train RMSE: 30.6189, Train MAPE: 0.4607, Valid Loss: 18.0638, Valid RMSE: 29.4181, Valid MAPE: 0.5212, Train Time: 15.1306s/epoch, Valid Time: 1.6317s, LR: 8.5737e-04
2025-05-07 23:50:31,219 - Epoch: 040, Train Loss: 18.9776, Train RMSE: 30.5160, Train MAPE: 0.4603, Valid Loss: 17.9414, Valid RMSE: 29.1638, Valid MAPE: 0.5161, Train Time: 14.7147s/epoch, Valid Time: 1.5583s, LR: 8.5737e-04
2025-05-07 23:50:48,140 - Epoch: 041, Train Loss: 18.9487, Train RMSE: 30.5359, Train MAPE: 0.4586, Valid Loss: 17.9531, Valid RMSE: 29.1403, Valid MAPE: 0.5292, Train Time: 15.3219s/epoch, Valid Time: 1.5993s, LR: 8.1451e-04
2025-05-07 23:51:05,188 - Epoch: 042, Train Loss: 18.9157, Train RMSE: 30.4567, Train MAPE: 0.4580, Valid Loss: 18.1634, Valid RMSE: 29.3819, Valid MAPE: 0.5478, Train Time: 15.2656s/epoch, Valid Time: 1.7824s, LR: 8.1451e-04
2025-05-07 23:51:20,036 - Epoch: 043, Train Loss: 18.9166, Train RMSE: 30.4665, Train MAPE: 0.4577, Valid Loss: 18.3429, Valid RMSE: 29.2332, Valid MAPE: 0.5787, Train Time: 13.4803s/epoch, Valid Time: 1.3679s, LR: 8.1451e-04
2025-05-07 23:51:20,037 - Early stop at epoch 43, loss = 17.769670
2025-05-07 23:51:21,474 - --------------------------------------------------Norm Test Time Results:--------------------------------------------------
2025-05-07 23:51:21,478 - Horizon 1, Test MAE: 8.2055, Test RMSE: 13.8322, Test MAPE: 0.2584
2025-05-07 23:51:21,482 - Horizon 2, Test MAE: 10.6365, Test RMSE: 17.3829, Test MAPE: 0.3455
2025-05-07 23:51:21,485 - Horizon 3, Test MAE: 12.0658, Test RMSE: 19.3985, Test MAPE: 0.3984
2025-05-07 23:51:21,489 - Horizon 4, Test MAE: 13.0792, Test RMSE: 20.8430, Test MAPE: 0.4388
2025-05-07 23:51:21,492 - Horizon 5, Test MAE: 13.8178, Test RMSE: 21.9711, Test MAPE: 0.4670
2025-05-07 23:51:21,496 - Horizon 6, Test MAE: 14.4060, Test RMSE: 22.8490, Test MAPE: 0.4950
2025-05-07 23:51:21,499 - Horizon 7, Test MAE: 14.8655, Test RMSE: 23.5339, Test MAPE: 0.5134
2025-05-07 23:51:21,503 - Horizon 8, Test MAE: 15.2597, Test RMSE: 24.0597, Test MAPE: 0.5354
2025-05-07 23:51:21,506 - Horizon 9, Test MAE: 15.8238, Test RMSE: 24.7400, Test MAPE: 0.5645
2025-05-07 23:51:21,509 - Horizon 10, Test MAE: 16.3104, Test RMSE: 25.3283, Test MAPE: 0.5889
2025-05-07 23:51:21,513 - Horizon 11, Test MAE: 16.6435, Test RMSE: 25.7484, Test MAPE: 0.6032
2025-05-07 23:51:21,516 - Horizon 12, Test MAE: 16.9554, Test RMSE: 26.0952, Test MAPE: 0.6220
2025-05-07 23:51:21,516 - Average Test MAE: 14.0058, Test RMSE: 22.1485, Test MAPE: 0.4859
2025-05-07 23:51:21,516 - Norm Test Time: 1.2452s
