2023-11-28 22:03:16,168 - Namespace(device='cuda:2', dataset='PEMS08', fewshot=100, prompt=False, years='2016', seed=2020, bs=64, seq_len=12, horizon=12, input_dim=3, output_dim=1, mode='train', max_epochs=100, patience=10, model_name='stgcn', Kt=3, Ks=3, block_num=2, step_size=10, gamma=0.95, lrate=0.001, wdecay=0.0005, dropout=0.5, clip_grad_value=0)
2023-11-28 22:03:16,168 - Adj path: /home/yuxuan/weichen/llm4stg/LargeST/data/pems08/pems08_rn_adj.npy
2023-11-28 22:03:17,192 - Data shape: (17856, 170, 3)
2023-11-28 22:03:17,419 - Sample num: 10700, Batch num: 167
2023-11-28 22:03:17,649 - Sample num: 3567, Batch num: 55
2023-11-28 22:03:17,878 - Sample num: 3566, Batch num: 55
2023-11-28 22:03:18,334 - The arc of model:
STGCN(
  (st_blocks): Sequential(
    (0): STConvBlock(
      (tmp_conv1): TemporalConvLayer(
        (align): Align(
          (align_conv): Conv2d(3, 64, kernel_size=(1, 1), stride=(1, 1))
        )
        (sigmoid): Sigmoid()
        (causal_conv): CausalConv2d(3, 128, kernel_size=(3, 1), stride=(1, 1))
      )
      (graph_conv): GraphConvLayer(
        (align): Align(
          (align_conv): Conv2d(64, 16, kernel_size=(1, 1), stride=(1, 1))
        )
        (cheb_graph_conv): ChebGraphConv()
      )
      (tmp_conv2): TemporalConvLayer(
        (align): Align(
          (align_conv): Conv2d(16, 64, kernel_size=(1, 1), stride=(1, 1))
        )
        (sigmoid): Sigmoid()
        (causal_conv): CausalConv2d(16, 128, kernel_size=(3, 1), stride=(1, 1))
      )
      (tc2_ln): LayerNorm((170, 64), eps=1e-05, elementwise_affine=True)
      (relu): ReLU()
      (dropout): Dropout(p=0.5, inplace=False)
    )
    (1): STConvBlock(
      (tmp_conv1): TemporalConvLayer(
        (align): Align(
          (align_conv): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1))
        )
        (sigmoid): Sigmoid()
        (causal_conv): CausalConv2d(64, 128, kernel_size=(3, 1), stride=(1, 1))
      )
      (graph_conv): GraphConvLayer(
        (align): Align(
          (align_conv): Conv2d(64, 16, kernel_size=(1, 1), stride=(1, 1))
        )
        (cheb_graph_conv): ChebGraphConv()
      )
      (tmp_conv2): TemporalConvLayer(
        (align): Align(
          (align_conv): Conv2d(16, 64, kernel_size=(1, 1), stride=(1, 1))
        )
        (sigmoid): Sigmoid()
        (causal_conv): CausalConv2d(16, 128, kernel_size=(3, 1), stride=(1, 1))
      )
      (tc2_ln): LayerNorm((170, 64), eps=1e-05, elementwise_affine=True)
      (relu): ReLU()
      (dropout): Dropout(p=0.5, inplace=False)
    )
  )
  (output): OutputBlock(
    (tmp_conv1): TemporalConvLayer(
      (align): Align(
        (align_conv): Conv2d(64, 128, kernel_size=(1, 1), stride=(1, 1))
      )
      (sigmoid): Sigmoid()
      (causal_conv): CausalConv2d(64, 256, kernel_size=(4, 1), stride=(1, 1))
    )
    (fc1): Linear(in_features=128, out_features=128, bias=True)
    (fc2): Linear(in_features=128, out_features=12, bias=True)
    (tc1_ln): LayerNorm((170, 128), eps=1e-05, elementwise_affine=True)
    (relu): ReLU()
  )
)
2023-11-28 22:03:18,335 - The number of parameters: 227980
2023-11-28 22:03:18,335 - Start training!
2023-11-28 22:03:40,753 - Epoch: 001, Train Loss: 32.2407, Train RMSE: 45.9695, Train MAPE: 0.4075, Valid Loss: 24.0728, Valid RMSE: 36.5609, Valid MAPE: 0.2669, Train Time: 20.1606s/epoch, Valid Time: 2.2573s, LR: 1.0000e-03
2023-11-28 22:03:40,758 - Val loss decrease from inf to 24.0728
2023-11-28 22:04:03,980 - Epoch: 002, Train Loss: 22.7071, Train RMSE: 34.6658, Train MAPE: 0.1996, Valid Loss: 22.0474, Valid RMSE: 33.6028, Valid MAPE: 0.2147, Train Time: 20.9144s/epoch, Valid Time: 2.3067s, LR: 1.0000e-03
2023-11-28 22:04:03,986 - Val loss decrease from 24.0728 to 22.0474
2023-11-28 22:04:26,961 - Epoch: 003, Train Loss: 21.1218, Train RMSE: 32.4711, Train MAPE: 0.1799, Valid Loss: 21.9420, Valid RMSE: 32.5872, Valid MAPE: 0.3267, Train Time: 20.8474s/epoch, Valid Time: 2.1278s, LR: 1.0000e-03
2023-11-28 22:04:26,966 - Val loss decrease from 22.0474 to 21.9420
2023-11-28 22:04:48,432 - Epoch: 004, Train Loss: 20.2553, Train RMSE: 31.3228, Train MAPE: 0.1695, Valid Loss: 19.8570, Valid RMSE: 30.6251, Valid MAPE: 0.1863, Train Time: 19.6761s/epoch, Valid Time: 1.7899s, LR: 1.0000e-03
2023-11-28 22:04:48,448 - Val loss decrease from 21.9420 to 19.8570
2023-11-28 22:05:10,003 - Epoch: 005, Train Loss: 19.6269, Train RMSE: 30.5116, Train MAPE: 0.1599, Valid Loss: 19.8440, Valid RMSE: 30.4836, Valid MAPE: 0.2259, Train Time: 19.4879s/epoch, Valid Time: 2.0672s, LR: 1.0000e-03
2023-11-28 22:05:10,008 - Val loss decrease from 19.8570 to 19.8440
2023-11-28 22:05:31,728 - Epoch: 006, Train Loss: 19.2647, Train RMSE: 30.0466, Train MAPE: 0.1542, Valid Loss: 19.9651, Valid RMSE: 30.6336, Valid MAPE: 0.1937, Train Time: 19.6384s/epoch, Valid Time: 2.0816s, LR: 1.0000e-03
2023-11-28 22:05:54,677 - Epoch: 007, Train Loss: 19.0573, Train RMSE: 29.7228, Train MAPE: 0.1522, Valid Loss: 19.2991, Valid RMSE: 29.6979, Valid MAPE: 0.1573, Train Time: 20.7960s/epoch, Valid Time: 2.1521s, LR: 1.0000e-03
2023-11-28 22:05:54,681 - Val loss decrease from 19.8440 to 19.2991
2023-11-28 22:06:15,912 - Epoch: 008, Train Loss: 18.6541, Train RMSE: 29.2563, Train MAPE: 0.1442, Valid Loss: 18.9925, Valid RMSE: 29.2881, Valid MAPE: 0.1890, Train Time: 19.0047s/epoch, Valid Time: 2.2259s, LR: 1.0000e-03
2023-11-28 22:06:15,917 - Val loss decrease from 19.2991 to 18.9925
2023-11-28 22:06:38,443 - Epoch: 009, Train Loss: 18.5107, Train RMSE: 29.0236, Train MAPE: 0.1434, Valid Loss: 18.5499, Valid RMSE: 28.6467, Valid MAPE: 0.2073, Train Time: 20.4303s/epoch, Valid Time: 2.0962s, LR: 1.0000e-03
2023-11-28 22:06:38,448 - Val loss decrease from 18.9925 to 18.5499
2023-11-28 22:07:00,560 - Epoch: 010, Train Loss: 18.2802, Train RMSE: 28.6974, Train MAPE: 0.1428, Valid Loss: 18.2831, Valid RMSE: 28.3452, Valid MAPE: 0.1777, Train Time: 20.0523s/epoch, Valid Time: 2.0595s, LR: 1.0000e-03
2023-11-28 22:07:00,564 - Val loss decrease from 18.5499 to 18.2831
2023-11-28 22:07:22,428 - Epoch: 011, Train Loss: 18.0522, Train RMSE: 28.4497, Train MAPE: 0.1371, Valid Loss: 18.1567, Valid RMSE: 28.2113, Valid MAPE: 0.1923, Train Time: 19.7374s/epoch, Valid Time: 2.1262s, LR: 9.5000e-04
2023-11-28 22:07:22,433 - Val loss decrease from 18.2831 to 18.1567
2023-11-28 22:07:44,644 - Epoch: 012, Train Loss: 17.8429, Train RMSE: 28.1866, Train MAPE: 0.1355, Valid Loss: 17.9701, Valid RMSE: 27.9723, Valid MAPE: 0.1555, Train Time: 20.1124s/epoch, Valid Time: 2.0984s, LR: 9.5000e-04
2023-11-28 22:07:44,648 - Val loss decrease from 18.1567 to 17.9701
2023-11-28 22:08:07,586 - Epoch: 013, Train Loss: 17.7185, Train RMSE: 28.0158, Train MAPE: 0.1327, Valid Loss: 17.7371, Valid RMSE: 27.7597, Valid MAPE: 0.1488, Train Time: 20.7159s/epoch, Valid Time: 2.2212s, LR: 9.5000e-04
2023-11-28 22:08:07,591 - Val loss decrease from 17.9701 to 17.7371
2023-11-28 22:08:29,794 - Epoch: 014, Train Loss: 17.6471, Train RMSE: 27.8835, Train MAPE: 0.1329, Valid Loss: 18.1092, Valid RMSE: 28.0201, Valid MAPE: 0.1712, Train Time: 20.0383s/epoch, Valid Time: 2.1650s, LR: 9.5000e-04
2023-11-28 22:08:50,743 - Epoch: 015, Train Loss: 17.4687, Train RMSE: 27.6690, Train MAPE: 0.1307, Valid Loss: 17.8925, Valid RMSE: 27.8548, Valid MAPE: 0.1704, Train Time: 18.8566s/epoch, Valid Time: 2.0921s, LR: 9.5000e-04
2023-11-28 22:09:12,285 - Epoch: 016, Train Loss: 17.3384, Train RMSE: 27.5113, Train MAPE: 0.1285, Valid Loss: 17.9696, Valid RMSE: 27.7662, Valid MAPE: 0.1542, Train Time: 19.4110s/epoch, Valid Time: 2.1299s, LR: 9.5000e-04
2023-11-28 22:09:35,703 - Epoch: 017, Train Loss: 17.3694, Train RMSE: 27.4917, Train MAPE: 0.1302, Valid Loss: 17.4505, Valid RMSE: 27.3711, Valid MAPE: 0.1505, Train Time: 21.2090s/epoch, Valid Time: 2.2088s, LR: 9.5000e-04
2023-11-28 22:09:35,721 - Val loss decrease from 17.7371 to 17.4505
2023-11-28 22:09:59,122 - Epoch: 018, Train Loss: 17.1435, Train RMSE: 27.2354, Train MAPE: 0.1271, Valid Loss: 17.3334, Valid RMSE: 27.3567, Valid MAPE: 0.1546, Train Time: 21.1627s/epoch, Valid Time: 2.2386s, LR: 9.5000e-04
2023-11-28 22:09:59,127 - Val loss decrease from 17.4505 to 17.3334
2023-11-28 22:10:21,123 - Epoch: 019, Train Loss: 17.0703, Train RMSE: 27.1278, Train MAPE: 0.1260, Valid Loss: 17.1444, Valid RMSE: 27.0959, Valid MAPE: 0.1686, Train Time: 19.9914s/epoch, Valid Time: 2.0040s, LR: 9.5000e-04
2023-11-28 22:10:21,127 - Val loss decrease from 17.3334 to 17.1444
2023-11-28 22:10:42,764 - Epoch: 020, Train Loss: 16.9336, Train RMSE: 26.9855, Train MAPE: 0.1229, Valid Loss: 17.1607, Valid RMSE: 27.1345, Valid MAPE: 0.1611, Train Time: 19.5427s/epoch, Valid Time: 2.0939s, LR: 9.5000e-04
2023-11-28 22:11:04,275 - Epoch: 021, Train Loss: 16.8624, Train RMSE: 26.8784, Train MAPE: 0.1237, Valid Loss: 16.9407, Valid RMSE: 27.0093, Valid MAPE: 0.1451, Train Time: 19.3129s/epoch, Valid Time: 2.1974s, LR: 9.0250e-04
2023-11-28 22:11:04,292 - Val loss decrease from 17.1444 to 16.9407
2023-11-28 22:11:26,566 - Epoch: 022, Train Loss: 16.7841, Train RMSE: 26.7927, Train MAPE: 0.1205, Valid Loss: 16.8086, Valid RMSE: 26.8967, Valid MAPE: 0.1493, Train Time: 20.1902s/epoch, Valid Time: 2.0833s, LR: 9.0250e-04
2023-11-28 22:11:26,571 - Val loss decrease from 16.9407 to 16.8086
2023-11-28 22:11:49,485 - Epoch: 023, Train Loss: 16.6360, Train RMSE: 26.6219, Train MAPE: 0.1182, Valid Loss: 16.8971, Valid RMSE: 27.0608, Valid MAPE: 0.1461, Train Time: 20.6937s/epoch, Valid Time: 2.2204s, LR: 9.0250e-04
2023-11-28 22:12:11,402 - Epoch: 024, Train Loss: 16.6941, Train RMSE: 26.6688, Train MAPE: 0.1201, Valid Loss: 17.0461, Valid RMSE: 27.0440, Valid MAPE: 0.1572, Train Time: 19.9398s/epoch, Valid Time: 1.9759s, LR: 9.0250e-04
2023-11-28 22:12:33,474 - Epoch: 025, Train Loss: 16.5457, Train RMSE: 26.4894, Train MAPE: 0.1178, Valid Loss: 16.7480, Valid RMSE: 26.8909, Valid MAPE: 0.1468, Train Time: 19.9995s/epoch, Valid Time: 2.0724s, LR: 9.0250e-04
2023-11-28 22:12:33,478 - Val loss decrease from 16.8086 to 16.7480
2023-11-28 22:12:54,988 - Epoch: 026, Train Loss: 16.5234, Train RMSE: 26.4455, Train MAPE: 0.1183, Valid Loss: 17.2253, Valid RMSE: 27.2403, Valid MAPE: 0.1525, Train Time: 19.3060s/epoch, Valid Time: 2.2036s, LR: 9.0250e-04
2023-11-28 22:13:18,399 - Epoch: 027, Train Loss: 16.4875, Train RMSE: 26.3885, Train MAPE: 0.1181, Valid Loss: 16.7895, Valid RMSE: 26.9078, Valid MAPE: 0.1505, Train Time: 21.2787s/epoch, Valid Time: 2.1321s, LR: 9.0250e-04
2023-11-28 22:13:41,360 - Epoch: 028, Train Loss: 16.4495, Train RMSE: 26.3428, Train MAPE: 0.1169, Valid Loss: 17.2881, Valid RMSE: 27.4451, Valid MAPE: 0.1595, Train Time: 20.7461s/epoch, Valid Time: 2.2144s, LR: 9.0250e-04
2023-11-28 22:14:02,882 - Epoch: 029, Train Loss: 16.3679, Train RMSE: 26.2469, Train MAPE: 0.1156, Valid Loss: 16.5639, Valid RMSE: 26.7785, Valid MAPE: 0.1457, Train Time: 19.6723s/epoch, Valid Time: 1.8490s, LR: 9.0250e-04
2023-11-28 22:14:02,887 - Val loss decrease from 16.7480 to 16.5639
2023-11-28 22:14:24,403 - Epoch: 030, Train Loss: 16.3242, Train RMSE: 26.1801, Train MAPE: 0.1161, Valid Loss: 16.7742, Valid RMSE: 26.9260, Valid MAPE: 0.1479, Train Time: 19.6166s/epoch, Valid Time: 1.8993s, LR: 9.0250e-04
2023-11-28 22:14:45,999 - Epoch: 031, Train Loss: 16.2414, Train RMSE: 26.0945, Train MAPE: 0.1141, Valid Loss: 16.6438, Valid RMSE: 26.8324, Valid MAPE: 0.1684, Train Time: 19.3760s/epoch, Valid Time: 2.2197s, LR: 8.5737e-04
2023-11-28 22:15:09,105 - Epoch: 032, Train Loss: 16.2855, Train RMSE: 26.1266, Train MAPE: 0.1143, Valid Loss: 16.8283, Valid RMSE: 27.0299, Valid MAPE: 0.1497, Train Time: 20.8268s/epoch, Valid Time: 2.2784s, LR: 8.5737e-04
2023-11-28 22:15:31,780 - Epoch: 033, Train Loss: 16.1501, Train RMSE: 25.9726, Train MAPE: 0.1129, Valid Loss: 16.8661, Valid RMSE: 27.1308, Valid MAPE: 0.1487, Train Time: 20.4446s/epoch, Valid Time: 2.2307s, LR: 8.5737e-04
2023-11-28 22:15:54,915 - Epoch: 034, Train Loss: 16.1552, Train RMSE: 25.9614, Train MAPE: 0.1142, Valid Loss: 16.7510, Valid RMSE: 27.0216, Valid MAPE: 0.1469, Train Time: 20.8853s/epoch, Valid Time: 2.2491s, LR: 8.5737e-04
2023-11-28 22:16:17,129 - Epoch: 035, Train Loss: 16.0890, Train RMSE: 25.8848, Train MAPE: 0.1125, Valid Loss: 16.8342, Valid RMSE: 27.1186, Valid MAPE: 0.1520, Train Time: 20.1900s/epoch, Valid Time: 2.0233s, LR: 8.5737e-04
2023-11-28 22:16:38,133 - Epoch: 036, Train Loss: 16.0223, Train RMSE: 25.8301, Train MAPE: 0.1112, Valid Loss: 16.6650, Valid RMSE: 27.0475, Valid MAPE: 0.1491, Train Time: 19.1109s/epoch, Valid Time: 1.8931s, LR: 8.5737e-04
2023-11-28 22:17:00,792 - Epoch: 037, Train Loss: 16.0197, Train RMSE: 25.8050, Train MAPE: 0.1112, Valid Loss: 17.1871, Valid RMSE: 27.5645, Valid MAPE: 0.1589, Train Time: 20.5043s/epoch, Valid Time: 2.1535s, LR: 8.5737e-04
2023-11-28 22:17:23,705 - Epoch: 038, Train Loss: 15.9885, Train RMSE: 25.7690, Train MAPE: 0.1117, Valid Loss: 16.6154, Valid RMSE: 26.9005, Valid MAPE: 0.1609, Train Time: 20.7870s/epoch, Valid Time: 2.1255s, LR: 8.5737e-04
2023-11-28 22:17:46,028 - Epoch: 039, Train Loss: 15.9814, Train RMSE: 25.7537, Train MAPE: 0.1123, Valid Loss: 16.5915, Valid RMSE: 26.9387, Valid MAPE: 0.1510, Train Time: 20.3385s/epoch, Valid Time: 1.9844s, LR: 8.5737e-04
2023-11-28 22:17:46,028 - Early stop at epoch 39, loss = 16.563902
2023-11-28 22:17:48,120 - Horizon 1, Test MAE: 14.3514, Test RMSE: 21.7568, Test MAPE: 0.1009
2023-11-28 22:17:48,124 - Horizon 2, Test MAE: 14.8691, Test RMSE: 22.7909, Test MAPE: 0.1024
2023-11-28 22:17:48,127 - Horizon 3, Test MAE: 15.3208, Test RMSE: 23.6297, Test MAPE: 0.1046
2023-11-28 22:17:48,130 - Horizon 4, Test MAE: 15.6527, Test RMSE: 24.2524, Test MAPE: 0.1079
2023-11-28 22:17:48,134 - Horizon 5, Test MAE: 15.8972, Test RMSE: 24.7725, Test MAPE: 0.1084
2023-11-28 22:17:48,137 - Horizon 6, Test MAE: 16.1509, Test RMSE: 25.2876, Test MAPE: 0.1113
2023-11-28 22:17:48,140 - Horizon 7, Test MAE: 16.4281, Test RMSE: 25.7215, Test MAPE: 0.1107
2023-11-28 22:17:48,144 - Horizon 8, Test MAE: 16.6323, Test RMSE: 26.1110, Test MAPE: 0.1117
2023-11-28 22:17:48,147 - Horizon 9, Test MAE: 16.8436, Test RMSE: 26.4751, Test MAPE: 0.1137
2023-11-28 22:17:48,150 - Horizon 10, Test MAE: 17.0764, Test RMSE: 26.8659, Test MAPE: 0.1139
2023-11-28 22:17:48,154 - Horizon 11, Test MAE: 17.3644, Test RMSE: 27.3181, Test MAPE: 0.1157
2023-11-28 22:17:48,157 - Horizon 12, Test MAE: 17.7662, Test RMSE: 27.8950, Test MAPE: 0.1220
2023-11-28 22:17:48,157 - Average Test MAE: 16.1961, Test RMSE: 25.2397, Test MAPE: 0.1103
