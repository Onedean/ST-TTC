2025-05-08 17:22:56,829 - Namespace(device='cuda:1', dataset='PEMS08', fewshot=6, eval_method='norm', years='2016', seed=2018, bs=64, seq_len=12, horizon=12, input_dim=3, output_dim=1, mode='train', max_epochs=100, patience=10, model_name='stgcn', Kt=3, Ks=3, block_num=2, step_size=10, gamma=0.95, lrate=0.001, wdecay=0.0005, dropout=0.5, clip_grad_value=0)
2025-05-08 17:22:56,829 - Adj path: /home/weichen/stg_project/LargeST/data/pems08/pems08_rn_adj.npy
2025-05-08 17:22:57,388 - Data shape: (17856, 170, 3)
2025-05-08 17:22:57,519 - Sample num: 1070, Batch num: 16
2025-05-08 17:22:57,652 - Sample num: 3567, Batch num: 55
2025-05-08 17:22:57,784 - Sample num: 3566, Batch num: 55
2025-05-08 17:22:58,643 - The arc of model:
STGCN(
  (st_blocks): Sequential(
    (0): STConvBlock(
      (tmp_conv1): TemporalConvLayer(
        (align): Align(
          (align_conv): Conv2d(3, 64, kernel_size=(1, 1), stride=(1, 1))
        )
        (sigmoid): Sigmoid()
        (causal_conv): CausalConv2d(3, 128, kernel_size=(3, 1), stride=(1, 1))
      )
      (graph_conv): GraphConvLayer(
        (align): Align(
          (align_conv): Conv2d(64, 16, kernel_size=(1, 1), stride=(1, 1))
        )
        (cheb_graph_conv): ChebGraphConv()
      )
      (tmp_conv2): TemporalConvLayer(
        (align): Align(
          (align_conv): Conv2d(16, 64, kernel_size=(1, 1), stride=(1, 1))
        )
        (sigmoid): Sigmoid()
        (causal_conv): CausalConv2d(16, 128, kernel_size=(3, 1), stride=(1, 1))
      )
      (tc2_ln): LayerNorm((170, 64), eps=1e-05, elementwise_affine=True)
      (relu): ReLU()
      (dropout): Dropout(p=0.5, inplace=False)
    )
    (1): STConvBlock(
      (tmp_conv1): TemporalConvLayer(
        (align): Align(
          (align_conv): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1))
        )
        (sigmoid): Sigmoid()
        (causal_conv): CausalConv2d(64, 128, kernel_size=(3, 1), stride=(1, 1))
      )
      (graph_conv): GraphConvLayer(
        (align): Align(
          (align_conv): Conv2d(64, 16, kernel_size=(1, 1), stride=(1, 1))
        )
        (cheb_graph_conv): ChebGraphConv()
      )
      (tmp_conv2): TemporalConvLayer(
        (align): Align(
          (align_conv): Conv2d(16, 64, kernel_size=(1, 1), stride=(1, 1))
        )
        (sigmoid): Sigmoid()
        (causal_conv): CausalConv2d(16, 128, kernel_size=(3, 1), stride=(1, 1))
      )
      (tc2_ln): LayerNorm((170, 64), eps=1e-05, elementwise_affine=True)
      (relu): ReLU()
      (dropout): Dropout(p=0.5, inplace=False)
    )
  )
  (output): OutputBlock(
    (tmp_conv1): TemporalConvLayer(
      (align): Align(
        (align_conv): Conv2d(64, 128, kernel_size=(1, 1), stride=(1, 1))
      )
      (sigmoid): Sigmoid()
      (causal_conv): CausalConv2d(64, 256, kernel_size=(4, 1), stride=(1, 1))
    )
    (fc1): Linear(in_features=128, out_features=128, bias=True)
    (fc2): Linear(in_features=128, out_features=12, bias=True)
    (tc1_ln): LayerNorm((170, 128), eps=1e-05, elementwise_affine=True)
    (relu): ReLU()
  )
)
2025-05-08 17:22:58,643 - Number of total parameters: 227980, tunable parameters: 227980
2025-05-08 17:22:58,643 - The number of parameters: 227980
2025-05-08 17:22:58,644 - Start training!
2025-05-08 17:23:02,785 - Epoch: 001, Train Loss: 67.6231, Train RMSE: 86.7845, Train MAPE: 1.2310, Valid Loss: 38.1474, Valid RMSE: 53.7166, Valid MAPE: 0.5455, Train Time: 2.3772s/epoch, Valid Time: 1.7645s, LR: 1.0000e-03
2025-05-08 17:23:02,791 - Val loss decrease from inf to 38.1474
2025-05-08 17:23:05,942 - Epoch: 002, Train Loss: 35.2377, Train RMSE: 47.5138, Train MAPE: 0.5451, Valid Loss: 32.8493, Valid RMSE: 45.4139, Valid MAPE: 0.4204, Train Time: 1.4267s/epoch, Valid Time: 1.7247s, LR: 1.0000e-03
2025-05-08 17:23:05,948 - Val loss decrease from 38.1474 to 32.8493
2025-05-08 17:23:09,287 - Epoch: 003, Train Loss: 30.3040, Train RMSE: 41.7062, Train MAPE: 0.4156, Valid Loss: 29.7059, Valid RMSE: 43.0017, Valid MAPE: 0.3166, Train Time: 1.4719s/epoch, Valid Time: 1.8674s, LR: 1.0000e-03
2025-05-08 17:23:09,293 - Val loss decrease from 32.8493 to 29.7059
2025-05-08 17:23:12,524 - Epoch: 004, Train Loss: 26.3735, Train RMSE: 37.5417, Train MAPE: 0.3089, Valid Loss: 27.4981, Valid RMSE: 41.2391, Valid MAPE: 0.2452, Train Time: 1.4733s/epoch, Valid Time: 1.7583s, LR: 1.0000e-03
2025-05-08 17:23:12,532 - Val loss decrease from 29.7059 to 27.4981
2025-05-08 17:23:15,782 - Epoch: 005, Train Loss: 25.0938, Train RMSE: 36.3066, Train MAPE: 0.2683, Valid Loss: 27.6512, Valid RMSE: 41.2857, Valid MAPE: 0.2671, Train Time: 1.3539s/epoch, Valid Time: 1.8963s, LR: 1.0000e-03
2025-05-08 17:23:19,301 - Epoch: 006, Train Loss: 23.7566, Train RMSE: 34.7650, Train MAPE: 0.2428, Valid Loss: 27.4309, Valid RMSE: 40.4785, Valid MAPE: 0.3349, Train Time: 1.5479s/epoch, Valid Time: 1.9714s, LR: 1.0000e-03
2025-05-08 17:23:19,307 - Val loss decrease from 27.4981 to 27.4309
2025-05-08 17:23:22,833 - Epoch: 007, Train Loss: 22.9795, Train RMSE: 33.8039, Train MAPE: 0.2323, Valid Loss: 26.7001, Valid RMSE: 39.5290, Valid MAPE: 0.3126, Train Time: 1.5684s/epoch, Valid Time: 1.9583s, LR: 1.0000e-03
2025-05-08 17:23:22,839 - Val loss decrease from 27.4309 to 26.7001
2025-05-08 17:23:26,367 - Epoch: 008, Train Loss: 22.2335, Train RMSE: 32.8784, Train MAPE: 0.2219, Valid Loss: 26.1952, Valid RMSE: 39.1377, Valid MAPE: 0.2770, Train Time: 1.6196s/epoch, Valid Time: 1.9084s, LR: 1.0000e-03
2025-05-08 17:23:26,372 - Val loss decrease from 26.7001 to 26.1952
2025-05-08 17:23:29,695 - Epoch: 009, Train Loss: 21.4784, Train RMSE: 32.1289, Train MAPE: 0.2083, Valid Loss: 25.7546, Valid RMSE: 37.9367, Valid MAPE: 0.3007, Train Time: 1.4754s/epoch, Valid Time: 1.8467s, LR: 1.0000e-03
2025-05-08 17:23:29,700 - Val loss decrease from 26.1952 to 25.7546
2025-05-08 17:23:32,895 - Epoch: 010, Train Loss: 21.0377, Train RMSE: 31.5169, Train MAPE: 0.2014, Valid Loss: 25.3250, Valid RMSE: 37.7571, Valid MAPE: 0.2539, Train Time: 1.4280s/epoch, Valid Time: 1.7669s, LR: 1.0000e-03
2025-05-08 17:23:32,900 - Val loss decrease from 25.7546 to 25.3250
2025-05-08 17:23:36,155 - Epoch: 011, Train Loss: 20.5277, Train RMSE: 30.9680, Train MAPE: 0.1965, Valid Loss: 25.1589, Valid RMSE: 37.5262, Valid MAPE: 0.2863, Train Time: 1.4151s/epoch, Valid Time: 1.8393s, LR: 9.5000e-04
2025-05-08 17:23:36,160 - Val loss decrease from 25.3250 to 25.1589
2025-05-08 17:23:39,399 - Epoch: 012, Train Loss: 20.3442, Train RMSE: 30.7572, Train MAPE: 0.1898, Valid Loss: 25.3909, Valid RMSE: 37.9364, Valid MAPE: 0.2662, Train Time: 1.5083s/epoch, Valid Time: 1.7301s, LR: 9.5000e-04
2025-05-08 17:23:42,543 - Epoch: 013, Train Loss: 20.2322, Train RMSE: 30.4821, Train MAPE: 0.1903, Valid Loss: 24.9336, Valid RMSE: 37.1414, Valid MAPE: 0.2741, Train Time: 1.4242s/epoch, Valid Time: 1.7194s, LR: 9.5000e-04
2025-05-08 17:23:42,570 - Val loss decrease from 25.1589 to 24.9336
2025-05-08 17:23:45,872 - Epoch: 014, Train Loss: 20.1291, Train RMSE: 30.4179, Train MAPE: 0.1930, Valid Loss: 24.7385, Valid RMSE: 37.1271, Valid MAPE: 0.2300, Train Time: 1.3885s/epoch, Valid Time: 1.9130s, LR: 9.5000e-04
2025-05-08 17:23:45,877 - Val loss decrease from 24.9336 to 24.7385
2025-05-08 17:23:49,402 - Epoch: 015, Train Loss: 19.9750, Train RMSE: 30.2764, Train MAPE: 0.1868, Valid Loss: 24.8393, Valid RMSE: 36.8063, Valid MAPE: 0.2944, Train Time: 1.5766s/epoch, Valid Time: 1.9483s, LR: 9.5000e-04
2025-05-08 17:23:52,860 - Epoch: 016, Train Loss: 19.8260, Train RMSE: 30.1148, Train MAPE: 0.1846, Valid Loss: 24.5979, Valid RMSE: 36.8387, Valid MAPE: 0.2554, Train Time: 1.5766s/epoch, Valid Time: 1.8809s, LR: 9.5000e-04
2025-05-08 17:23:52,865 - Val loss decrease from 24.7385 to 24.5979
2025-05-08 17:23:56,310 - Epoch: 017, Train Loss: 19.8428, Train RMSE: 30.0251, Train MAPE: 0.1859, Valid Loss: 24.9393, Valid RMSE: 37.2450, Valid MAPE: 0.2650, Train Time: 1.5189s/epoch, Valid Time: 1.9261s, LR: 9.5000e-04
2025-05-08 17:23:59,543 - Epoch: 018, Train Loss: 19.5787, Train RMSE: 29.7369, Train MAPE: 0.1773, Valid Loss: 24.3497, Valid RMSE: 36.3342, Valid MAPE: 0.2565, Train Time: 1.3812s/epoch, Valid Time: 1.8515s, LR: 9.5000e-04
2025-05-08 17:23:59,548 - Val loss decrease from 24.5979 to 24.3497
2025-05-08 17:24:02,693 - Epoch: 019, Train Loss: 19.2189, Train RMSE: 29.3750, Train MAPE: 0.1768, Valid Loss: 23.9140, Valid RMSE: 35.8207, Valid MAPE: 0.2118, Train Time: 1.3082s/epoch, Valid Time: 1.8368s, LR: 9.5000e-04
2025-05-08 17:24:02,699 - Val loss decrease from 24.3497 to 23.9140
2025-05-08 17:24:05,858 - Epoch: 020, Train Loss: 19.1215, Train RMSE: 29.1443, Train MAPE: 0.1775, Valid Loss: 23.9707, Valid RMSE: 35.7871, Valid MAPE: 0.2340, Train Time: 1.5050s/epoch, Valid Time: 1.6541s, LR: 9.5000e-04
2025-05-08 17:24:08,986 - Epoch: 021, Train Loss: 18.7278, Train RMSE: 28.7874, Train MAPE: 0.1688, Valid Loss: 24.1083, Valid RMSE: 36.3485, Valid MAPE: 0.2307, Train Time: 1.3483s/epoch, Valid Time: 1.7797s, LR: 9.0250e-04
2025-05-08 17:24:12,109 - Epoch: 022, Train Loss: 18.4984, Train RMSE: 28.5243, Train MAPE: 0.1617, Valid Loss: 23.3846, Valid RMSE: 34.9777, Valid MAPE: 0.2289, Train Time: 1.4116s/epoch, Valid Time: 1.7116s, LR: 9.0250e-04
2025-05-08 17:24:12,115 - Val loss decrease from 23.9140 to 23.3846
2025-05-08 17:24:15,262 - Epoch: 023, Train Loss: 18.5428, Train RMSE: 28.4272, Train MAPE: 0.1666, Valid Loss: 24.0278, Valid RMSE: 35.8324, Valid MAPE: 0.2424, Train Time: 1.2317s/epoch, Valid Time: 1.9155s, LR: 9.0250e-04
2025-05-08 17:24:18,729 - Epoch: 024, Train Loss: 18.2122, Train RMSE: 28.1793, Train MAPE: 0.1567, Valid Loss: 23.4127, Valid RMSE: 34.6462, Valid MAPE: 0.2598, Train Time: 1.5541s/epoch, Valid Time: 1.9121s, LR: 9.0250e-04
2025-05-08 17:24:22,338 - Epoch: 025, Train Loss: 18.3748, Train RMSE: 28.1824, Train MAPE: 0.1661, Valid Loss: 22.8301, Valid RMSE: 34.1906, Valid MAPE: 0.1963, Train Time: 1.6325s/epoch, Valid Time: 1.9773s, LR: 9.0250e-04
2025-05-08 17:24:22,344 - Val loss decrease from 23.3846 to 22.8301
2025-05-08 17:24:25,695 - Epoch: 026, Train Loss: 18.3869, Train RMSE: 28.2289, Train MAPE: 0.1637, Valid Loss: 23.4286, Valid RMSE: 35.0042, Valid MAPE: 0.2430, Train Time: 1.4979s/epoch, Valid Time: 1.8527s, LR: 9.0250e-04
2025-05-08 17:24:29,094 - Epoch: 027, Train Loss: 18.2420, Train RMSE: 28.1063, Train MAPE: 0.1610, Valid Loss: 24.0767, Valid RMSE: 35.6454, Valid MAPE: 0.2058, Train Time: 1.4245s/epoch, Valid Time: 1.9742s, LR: 9.0250e-04
2025-05-08 17:24:32,358 - Epoch: 028, Train Loss: 17.9429, Train RMSE: 27.6879, Train MAPE: 0.1610, Valid Loss: 23.1245, Valid RMSE: 34.9118, Valid MAPE: 0.2068, Train Time: 1.4171s/epoch, Valid Time: 1.8470s, LR: 9.0250e-04
2025-05-08 17:24:35,538 - Epoch: 029, Train Loss: 17.7889, Train RMSE: 27.6659, Train MAPE: 0.1531, Valid Loss: 23.1588, Valid RMSE: 34.4446, Valid MAPE: 0.2386, Train Time: 1.3072s/epoch, Valid Time: 1.8728s, LR: 9.0250e-04
2025-05-08 17:24:38,811 - Epoch: 030, Train Loss: 17.7565, Train RMSE: 27.5793, Train MAPE: 0.1497, Valid Loss: 23.5315, Valid RMSE: 35.0668, Valid MAPE: 0.2211, Train Time: 1.4095s/epoch, Valid Time: 1.8634s, LR: 9.0250e-04
2025-05-08 17:24:42,141 - Epoch: 031, Train Loss: 17.7653, Train RMSE: 27.5168, Train MAPE: 0.1556, Valid Loss: 23.1869, Valid RMSE: 34.5312, Valid MAPE: 0.2630, Train Time: 1.5019s/epoch, Valid Time: 1.8271s, LR: 8.5737e-04
2025-05-08 17:24:45,236 - Epoch: 032, Train Loss: 18.1680, Train RMSE: 27.9107, Train MAPE: 0.1607, Valid Loss: 24.7141, Valid RMSE: 37.0350, Valid MAPE: 0.2304, Train Time: 1.2260s/epoch, Valid Time: 1.8689s, LR: 8.5737e-04
2025-05-08 17:24:48,753 - Epoch: 033, Train Loss: 17.6795, Train RMSE: 27.4436, Train MAPE: 0.1554, Valid Loss: 22.9242, Valid RMSE: 34.4684, Valid MAPE: 0.2092, Train Time: 1.6183s/epoch, Valid Time: 1.8992s, LR: 8.5737e-04
2025-05-08 17:24:52,229 - Epoch: 034, Train Loss: 17.4229, Train RMSE: 27.2470, Train MAPE: 0.1453, Valid Loss: 23.3984, Valid RMSE: 35.1101, Valid MAPE: 0.2138, Train Time: 1.5788s/epoch, Valid Time: 1.8967s, LR: 8.5737e-04
2025-05-08 17:24:55,598 - Epoch: 035, Train Loss: 17.4506, Train RMSE: 27.2696, Train MAPE: 0.1463, Valid Loss: 22.8730, Valid RMSE: 34.2746, Valid MAPE: 0.2332, Train Time: 1.6171s/epoch, Valid Time: 1.7514s, LR: 8.5737e-04
2025-05-08 17:24:55,598 - Early stop at epoch 35, loss = 22.830130
2025-05-08 17:24:57,455 - --------------------------------------------------Norm Test Time Results:--------------------------------------------------
2025-05-08 17:24:57,460 - Horizon 1, Test MAE: 17.8774, Test RMSE: 25.9457, Test MAPE: 0.1371
2025-05-08 17:24:57,464 - Horizon 2, Test MAE: 18.5533, Test RMSE: 27.2183, Test MAPE: 0.1391
2025-05-08 17:24:57,468 - Horizon 3, Test MAE: 19.5258, Test RMSE: 28.7517, Test MAPE: 0.1442
2025-05-08 17:24:57,473 - Horizon 4, Test MAE: 20.2212, Test RMSE: 29.9525, Test MAPE: 0.1485
2025-05-08 17:24:57,478 - Horizon 5, Test MAE: 20.9156, Test RMSE: 31.1102, Test MAPE: 0.1498
2025-05-08 17:24:57,483 - Horizon 6, Test MAE: 21.6513, Test RMSE: 32.1665, Test MAPE: 0.1606
2025-05-08 17:24:57,487 - Horizon 7, Test MAE: 22.2423, Test RMSE: 33.1772, Test MAPE: 0.1659
2025-05-08 17:24:57,492 - Horizon 8, Test MAE: 23.1874, Test RMSE: 34.2719, Test MAPE: 0.1954
2025-05-08 17:24:57,496 - Horizon 9, Test MAE: 23.7666, Test RMSE: 35.2462, Test MAPE: 0.1800
2025-05-08 17:24:57,500 - Horizon 10, Test MAE: 24.4620, Test RMSE: 36.1889, Test MAPE: 0.1890
2025-05-08 17:24:57,504 - Horizon 11, Test MAE: 25.2815, Test RMSE: 37.2747, Test MAPE: 0.2044
2025-05-08 17:24:57,508 - Horizon 12, Test MAE: 26.2619, Test RMSE: 38.7050, Test MAPE: 0.2092
2025-05-08 17:24:57,509 - Average Test MAE: 21.9955, Test RMSE: 32.5007, Test MAPE: 0.1686
2025-05-08 17:24:57,509 - Norm Test Time: 1.6863s
