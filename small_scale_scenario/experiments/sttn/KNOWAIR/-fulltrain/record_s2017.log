2025-05-07 23:38:02,997 - Namespace(device='cuda:2', dataset='KNOWAIR', fewshot=100, eval_method='norm', years='2015', seed=2017, bs=64, seq_len=12, horizon=12, input_dim=3, output_dim=1, mode='train', max_epochs=100, patience=10, model_name='sttn', adj_type='doubletransition', blocks=2, mlp_expand=2, hid_dim=32, end_dim=512, lrate=0.001, wdecay=0.0001, dropout=0.1, clip_grad_value=5)
2025-05-07 23:38:02,998 - Adj path: /home/weichen/stg_project/LargeST/data/knowair/knowair_rn_adj.npy
2025-05-07 23:38:03,617 - Data shape: (11688, 184, 3)
2025-05-07 23:38:03,706 - Sample num: 6999, Batch num: 109
2025-05-07 23:38:03,795 - Sample num: 2333, Batch num: 36
2025-05-07 23:38:03,884 - Sample num: 2333, Batch num: 36
2025-05-07 23:38:04,712 - The arc of model:
STTN(
  (t_modules): ModuleList(
    (0-1): 2 x TemporalTransformer(
      (layers): ModuleList(
        (0): ModuleList(
          (0): TemporalAttention(
            (qkv): Linear(in_features=32, out_features=96, bias=False)
            (attn_drop): Dropout(p=0.1, inplace=False)
            (proj): Linear(in_features=32, out_features=32, bias=True)
            (proj_drop): Dropout(p=0.1, inplace=False)
          )
          (1): PreNorm(
            (norm): LayerNorm((32,), eps=1e-05, elementwise_affine=True)
            (fn): FeedForward(
              (net): Sequential(
                (0): Linear(in_features=32, out_features=64, bias=True)
                (1): GELU(approximate='none')
                (2): Dropout(p=0.1, inplace=False)
                (3): Linear(in_features=64, out_features=32, bias=True)
                (4): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
      )
    )
  )
  (s_modules): ModuleList(
    (0-1): 2 x SpatialTransformer(
      (layers): ModuleList(
        (0): ModuleList(
          (0): SpatialAttention(
            (qkv): Linear(in_features=32, out_features=96, bias=False)
            (attn_drop): Dropout(p=0.1, inplace=False)
            (proj): Linear(in_features=32, out_features=32, bias=True)
            (proj_drop): Dropout(p=0.1, inplace=False)
          )
          (1): PreNorm(
            (norm): LayerNorm((32,), eps=1e-05, elementwise_affine=True)
            (fn): FeedForward(
              (net): Sequential(
                (0): Linear(in_features=32, out_features=64, bias=True)
                (1): GELU(approximate='none')
                (2): Dropout(p=0.1, inplace=False)
                (3): Linear(in_features=64, out_features=32, bias=True)
                (4): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (2): GCN(
            (nconv): nconv()
            (mlp): linear(
              (mlp): Conv2d(160, 32, kernel_size=(1, 1), stride=(1, 1))
            )
          )
        )
      )
    )
  )
  (bn): ModuleList(
    (0-1): 2 x BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (start_conv): Conv2d(3, 32, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_1): Conv2d(32, 512, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_2): Conv2d(512, 12, kernel_size=(1, 1), stride=(1, 1))
)
2025-05-07 23:38:04,712 - Number of total parameters: 79692, tunable parameters: 79692
2025-05-07 23:38:04,713 - The number of parameters: 79692
2025-05-07 23:38:04,713 - Start training!
2025-05-07 23:39:03,527 - Epoch: 001, Train Loss: 23.9913, Train RMSE: 37.7780, Train MAPE: 0.6248, Valid Loss: 19.7704, Valid RMSE: 30.9896, Valid MAPE: 0.6033, Train Time: 53.3126s/epoch, Valid Time: 5.5013s, LR: 1.0000e-03
2025-05-07 23:39:03,532 - Val loss decrease from inf to 19.7704
2025-05-07 23:40:01,195 - Epoch: 002, Train Loss: 22.4515, Train RMSE: 35.7175, Train MAPE: 0.5793, Valid Loss: 19.4969, Valid RMSE: 30.8660, Valid MAPE: 0.5629, Train Time: 52.1815s/epoch, Valid Time: 5.4808s, LR: 1.0000e-03
2025-05-07 23:40:01,200 - Val loss decrease from 19.7704 to 19.4969
2025-05-07 23:40:58,860 - Epoch: 003, Train Loss: 21.9911, Train RMSE: 35.1793, Train MAPE: 0.5536, Valid Loss: 19.1741, Valid RMSE: 30.2384, Valid MAPE: 0.5970, Train Time: 52.2009s/epoch, Valid Time: 5.4590s, LR: 1.0000e-03
2025-05-07 23:40:58,865 - Val loss decrease from 19.4969 to 19.1741
2025-05-07 23:41:56,679 - Epoch: 004, Train Loss: 21.6280, Train RMSE: 34.6322, Train MAPE: 0.5440, Valid Loss: 18.8868, Valid RMSE: 30.2037, Valid MAPE: 0.5709, Train Time: 52.2420s/epoch, Valid Time: 5.5715s, LR: 1.0000e-03
2025-05-07 23:41:56,685 - Val loss decrease from 19.1741 to 18.8868
2025-05-07 23:42:54,519 - Epoch: 005, Train Loss: 21.3726, Train RMSE: 34.2448, Train MAPE: 0.5385, Valid Loss: 19.0077, Valid RMSE: 30.1674, Valid MAPE: 0.6047, Train Time: 52.2831s/epoch, Valid Time: 5.5506s, LR: 1.0000e-03
2025-05-07 23:43:52,755 - Epoch: 006, Train Loss: 21.2189, Train RMSE: 33.9877, Train MAPE: 0.5326, Valid Loss: 18.5916, Valid RMSE: 29.2886, Valid MAPE: 0.5668, Train Time: 52.5804s/epoch, Valid Time: 5.6562s, LR: 1.0000e-03
2025-05-07 23:43:52,761 - Val loss decrease from 18.8868 to 18.5916
2025-05-07 23:44:50,952 - Epoch: 007, Train Loss: 20.9709, Train RMSE: 33.6613, Train MAPE: 0.5259, Valid Loss: 18.3531, Valid RMSE: 29.0653, Valid MAPE: 0.5669, Train Time: 52.4858s/epoch, Valid Time: 5.7052s, LR: 1.0000e-03
2025-05-07 23:44:50,958 - Val loss decrease from 18.5916 to 18.3531
2025-05-07 23:45:48,899 - Epoch: 008, Train Loss: 20.8728, Train RMSE: 33.4814, Train MAPE: 0.5210, Valid Loss: 18.3345, Valid RMSE: 29.1516, Valid MAPE: 0.5618, Train Time: 52.4275s/epoch, Valid Time: 5.5132s, LR: 1.0000e-03
2025-05-07 23:45:48,904 - Val loss decrease from 18.3531 to 18.3345
2025-05-07 23:46:47,236 - Epoch: 009, Train Loss: 20.7673, Train RMSE: 33.3374, Train MAPE: 0.5181, Valid Loss: 18.3375, Valid RMSE: 29.0421, Valid MAPE: 0.5792, Train Time: 52.7230s/epoch, Valid Time: 5.6084s, LR: 1.0000e-03
2025-05-07 23:47:43,097 - Epoch: 010, Train Loss: 20.6651, Train RMSE: 33.2143, Train MAPE: 0.5125, Valid Loss: 18.4433, Valid RMSE: 28.9936, Valid MAPE: 0.5826, Train Time: 51.1037s/epoch, Valid Time: 4.7575s, LR: 1.0000e-03
2025-05-07 23:48:32,499 - Epoch: 011, Train Loss: 20.5141, Train RMSE: 32.9079, Train MAPE: 0.5117, Valid Loss: 18.2766, Valid RMSE: 29.6731, Valid MAPE: 0.4946, Train Time: 44.5696s/epoch, Valid Time: 4.8324s, LR: 1.0000e-03
2025-05-07 23:48:32,505 - Val loss decrease from 18.3345 to 18.2766
2025-05-07 23:49:21,822 - Epoch: 012, Train Loss: 20.3322, Train RMSE: 32.6809, Train MAPE: 0.5040, Valid Loss: 18.0114, Valid RMSE: 29.3466, Valid MAPE: 0.5119, Train Time: 44.5485s/epoch, Valid Time: 4.7689s, LR: 1.0000e-03
2025-05-07 23:49:21,828 - Val loss decrease from 18.2766 to 18.0114
2025-05-07 23:50:05,019 - Epoch: 013, Train Loss: 20.2550, Train RMSE: 32.5538, Train MAPE: 0.5014, Valid Loss: 18.1890, Valid RMSE: 29.0659, Valid MAPE: 0.5427, Train Time: 39.7887s/epoch, Valid Time: 3.4024s, LR: 1.0000e-03
2025-05-07 23:50:36,262 - Epoch: 014, Train Loss: 20.1529, Train RMSE: 32.4057, Train MAPE: 0.4975, Valid Loss: 18.0314, Valid RMSE: 28.8485, Valid MAPE: 0.5441, Train Time: 28.1908s/epoch, Valid Time: 3.0511s, LR: 1.0000e-03
2025-05-07 23:51:07,618 - Epoch: 015, Train Loss: 20.1136, Train RMSE: 32.2795, Train MAPE: 0.4989, Valid Loss: 18.0635, Valid RMSE: 29.0376, Valid MAPE: 0.5023, Train Time: 28.2283s/epoch, Valid Time: 3.1279s, LR: 1.0000e-03
2025-05-07 23:51:38,925 - Epoch: 016, Train Loss: 19.9724, Train RMSE: 32.0813, Train MAPE: 0.4922, Valid Loss: 18.1308, Valid RMSE: 28.7758, Valid MAPE: 0.5789, Train Time: 28.2704s/epoch, Valid Time: 3.0368s, LR: 1.0000e-03
2025-05-07 23:52:10,202 - Epoch: 017, Train Loss: 19.8712, Train RMSE: 31.8793, Train MAPE: 0.4905, Valid Loss: 18.0185, Valid RMSE: 29.0467, Valid MAPE: 0.5193, Train Time: 28.2438s/epoch, Valid Time: 3.0329s, LR: 1.0000e-03
2025-05-07 23:52:41,514 - Epoch: 018, Train Loss: 19.8693, Train RMSE: 31.9631, Train MAPE: 0.4881, Valid Loss: 18.1296, Valid RMSE: 28.9518, Valid MAPE: 0.5734, Train Time: 28.2560s/epoch, Valid Time: 3.0556s, LR: 1.0000e-03
2025-05-07 23:53:12,790 - Epoch: 019, Train Loss: 19.7224, Train RMSE: 31.6724, Train MAPE: 0.4860, Valid Loss: 17.9511, Valid RMSE: 29.2151, Valid MAPE: 0.5335, Train Time: 28.2548s/epoch, Valid Time: 3.0211s, LR: 1.0000e-03
2025-05-07 23:53:12,796 - Val loss decrease from 18.0114 to 17.9511
2025-05-07 23:53:44,074 - Epoch: 020, Train Loss: 19.6460, Train RMSE: 31.5126, Train MAPE: 0.4829, Valid Loss: 18.3494, Valid RMSE: 29.0487, Valid MAPE: 0.5987, Train Time: 28.2372s/epoch, Valid Time: 3.0405s, LR: 1.0000e-03
2025-05-07 23:54:15,399 - Epoch: 021, Train Loss: 19.5432, Train RMSE: 31.3688, Train MAPE: 0.4798, Valid Loss: 17.9197, Valid RMSE: 29.1555, Valid MAPE: 0.5274, Train Time: 28.2364s/epoch, Valid Time: 3.0888s, LR: 1.0000e-03
2025-05-07 23:54:15,405 - Val loss decrease from 17.9511 to 17.9197
2025-05-07 23:54:46,641 - Epoch: 022, Train Loss: 19.4790, Train RMSE: 31.2765, Train MAPE: 0.4773, Valid Loss: 18.2747, Valid RMSE: 29.2166, Valid MAPE: 0.5816, Train Time: 28.2151s/epoch, Valid Time: 3.0205s, LR: 1.0000e-03
2025-05-07 23:55:17,884 - Epoch: 023, Train Loss: 19.4700, Train RMSE: 31.2838, Train MAPE: 0.4769, Valid Loss: 18.0833, Valid RMSE: 29.2448, Valid MAPE: 0.5522, Train Time: 28.2267s/epoch, Valid Time: 3.0168s, LR: 1.0000e-03
2025-05-07 23:55:49,214 - Epoch: 024, Train Loss: 19.3695, Train RMSE: 31.0988, Train MAPE: 0.4739, Valid Loss: 17.8878, Valid RMSE: 29.1016, Valid MAPE: 0.5400, Train Time: 28.2619s/epoch, Valid Time: 3.0672s, LR: 1.0000e-03
2025-05-07 23:55:49,219 - Val loss decrease from 17.9197 to 17.8878
2025-05-07 23:56:20,565 - Epoch: 025, Train Loss: 19.3072, Train RMSE: 30.9579, Train MAPE: 0.4723, Valid Loss: 18.0089, Valid RMSE: 29.4643, Valid MAPE: 0.5215, Train Time: 28.2475s/epoch, Valid Time: 3.0987s, LR: 1.0000e-03
2025-05-07 23:56:51,893 - Epoch: 026, Train Loss: 19.2911, Train RMSE: 30.9453, Train MAPE: 0.4723, Valid Loss: 18.6396, Valid RMSE: 29.2230, Valid MAPE: 0.6245, Train Time: 28.2366s/epoch, Valid Time: 3.0910s, LR: 1.0000e-03
2025-05-07 23:57:23,186 - Epoch: 027, Train Loss: 19.1753, Train RMSE: 30.7394, Train MAPE: 0.4681, Valid Loss: 17.9802, Valid RMSE: 29.6222, Valid MAPE: 0.5200, Train Time: 28.2594s/epoch, Valid Time: 3.0332s, LR: 1.0000e-03
2025-05-07 23:57:44,931 - Epoch: 028, Train Loss: 19.1291, Train RMSE: 30.6645, Train MAPE: 0.4659, Valid Loss: 18.4773, Valid RMSE: 29.3196, Valid MAPE: 0.6026, Train Time: 19.6465s/epoch, Valid Time: 2.0985s, LR: 1.0000e-03
2025-05-07 23:58:05,629 - Epoch: 029, Train Loss: 19.1062, Train RMSE: 30.6828, Train MAPE: 0.4651, Valid Loss: 18.1241, Valid RMSE: 29.7487, Valid MAPE: 0.5406, Train Time: 18.6350s/epoch, Valid Time: 2.0626s, LR: 1.0000e-03
2025-05-07 23:58:27,085 - Epoch: 030, Train Loss: 19.0499, Train RMSE: 30.5561, Train MAPE: 0.4639, Valid Loss: 18.1798, Valid RMSE: 29.2836, Valid MAPE: 0.5714, Train Time: 19.4057s/epoch, Valid Time: 2.0503s, LR: 1.0000e-03
2025-05-07 23:58:47,830 - Epoch: 031, Train Loss: 18.9871, Train RMSE: 30.4428, Train MAPE: 0.4623, Valid Loss: 18.0053, Valid RMSE: 29.2975, Valid MAPE: 0.5241, Train Time: 18.6059s/epoch, Valid Time: 2.1391s, LR: 1.0000e-03
2025-05-07 23:58:58,792 - Epoch: 032, Train Loss: 18.9471, Train RMSE: 30.4235, Train MAPE: 0.4600, Valid Loss: 18.0197, Valid RMSE: 29.8311, Valid MAPE: 0.5133, Train Time: 9.6908s/epoch, Valid Time: 1.2708s, LR: 1.0000e-03
2025-05-07 23:59:09,442 - Epoch: 033, Train Loss: 18.9148, Train RMSE: 30.3579, Train MAPE: 0.4593, Valid Loss: 18.2602, Valid RMSE: 29.3235, Valid MAPE: 0.5823, Train Time: 9.3742s/epoch, Valid Time: 1.2754s, LR: 1.0000e-03
2025-05-07 23:59:20,085 - Epoch: 034, Train Loss: 18.8724, Train RMSE: 30.2661, Train MAPE: 0.4582, Valid Loss: 18.1280, Valid RMSE: 29.0798, Valid MAPE: 0.5642, Train Time: 9.3790s/epoch, Valid Time: 1.2639s, LR: 1.0000e-03
2025-05-07 23:59:20,085 - Early stop at epoch 34, loss = 17.887823
2025-05-07 23:59:21,269 - --------------------------------------------------Norm Test Time Results:--------------------------------------------------
2025-05-07 23:59:21,273 - Horizon 1, Test MAE: 8.3198, Test RMSE: 13.7643, Test MAPE: 0.2953
2025-05-07 23:59:21,277 - Horizon 2, Test MAE: 11.0706, Test RMSE: 17.7683, Test MAPE: 0.3912
2025-05-07 23:59:21,280 - Horizon 3, Test MAE: 12.5132, Test RMSE: 19.7797, Test MAPE: 0.4446
2025-05-07 23:59:21,283 - Horizon 4, Test MAE: 13.3983, Test RMSE: 21.0696, Test MAPE: 0.4769
2025-05-07 23:59:21,286 - Horizon 5, Test MAE: 14.0131, Test RMSE: 22.0249, Test MAPE: 0.4959
2025-05-07 23:59:21,289 - Horizon 6, Test MAE: 14.5365, Test RMSE: 22.7158, Test MAPE: 0.5215
2025-05-07 23:59:21,292 - Horizon 7, Test MAE: 14.9238, Test RMSE: 23.1906, Test MAPE: 0.5424
2025-05-07 23:59:21,295 - Horizon 8, Test MAE: 15.1409, Test RMSE: 23.6450, Test MAPE: 0.5432
2025-05-07 23:59:21,298 - Horizon 9, Test MAE: 15.7253, Test RMSE: 24.4084, Test MAPE: 0.5689
2025-05-07 23:59:21,301 - Horizon 10, Test MAE: 16.2948, Test RMSE: 25.0525, Test MAPE: 0.6041
2025-05-07 23:59:21,304 - Horizon 11, Test MAE: 16.6433, Test RMSE: 25.5820, Test MAPE: 0.6165
2025-05-07 23:59:21,307 - Horizon 12, Test MAE: 16.9350, Test RMSE: 26.0024, Test MAPE: 0.6268
2025-05-07 23:59:21,307 - Average Test MAE: 14.1262, Test RMSE: 22.0836, Test MAPE: 0.5106
2025-05-07 23:59:21,307 - Norm Test Time: 1.1603s
