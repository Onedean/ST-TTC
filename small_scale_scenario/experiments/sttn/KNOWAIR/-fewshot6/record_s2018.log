2025-05-08 02:01:35,450 - Namespace(device='cuda:2', dataset='KNOWAIR', fewshot=6, eval_method='norm', years='2015', seed=2018, bs=64, seq_len=12, horizon=12, input_dim=3, output_dim=1, mode='train', max_epochs=100, patience=10, model_name='sttn', adj_type='doubletransition', blocks=2, mlp_expand=2, hid_dim=32, end_dim=512, lrate=0.001, wdecay=0.0001, dropout=0.1, clip_grad_value=5)
2025-05-08 02:01:35,451 - Adj path: /home/weichen/stg_project/LargeST/data/knowair/knowair_rn_adj.npy
2025-05-08 02:01:36,024 - Data shape: (11688, 184, 3)
2025-05-08 02:01:36,114 - Sample num: 700, Batch num: 10
2025-05-08 02:01:36,204 - Sample num: 2333, Batch num: 36
2025-05-08 02:01:36,294 - Sample num: 2333, Batch num: 36
2025-05-08 02:01:37,098 - The arc of model:
STTN(
  (t_modules): ModuleList(
    (0-1): 2 x TemporalTransformer(
      (layers): ModuleList(
        (0): ModuleList(
          (0): TemporalAttention(
            (qkv): Linear(in_features=32, out_features=96, bias=False)
            (attn_drop): Dropout(p=0.1, inplace=False)
            (proj): Linear(in_features=32, out_features=32, bias=True)
            (proj_drop): Dropout(p=0.1, inplace=False)
          )
          (1): PreNorm(
            (norm): LayerNorm((32,), eps=1e-05, elementwise_affine=True)
            (fn): FeedForward(
              (net): Sequential(
                (0): Linear(in_features=32, out_features=64, bias=True)
                (1): GELU(approximate='none')
                (2): Dropout(p=0.1, inplace=False)
                (3): Linear(in_features=64, out_features=32, bias=True)
                (4): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
      )
    )
  )
  (s_modules): ModuleList(
    (0-1): 2 x SpatialTransformer(
      (layers): ModuleList(
        (0): ModuleList(
          (0): SpatialAttention(
            (qkv): Linear(in_features=32, out_features=96, bias=False)
            (attn_drop): Dropout(p=0.1, inplace=False)
            (proj): Linear(in_features=32, out_features=32, bias=True)
            (proj_drop): Dropout(p=0.1, inplace=False)
          )
          (1): PreNorm(
            (norm): LayerNorm((32,), eps=1e-05, elementwise_affine=True)
            (fn): FeedForward(
              (net): Sequential(
                (0): Linear(in_features=32, out_features=64, bias=True)
                (1): GELU(approximate='none')
                (2): Dropout(p=0.1, inplace=False)
                (3): Linear(in_features=64, out_features=32, bias=True)
                (4): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (2): GCN(
            (nconv): nconv()
            (mlp): linear(
              (mlp): Conv2d(160, 32, kernel_size=(1, 1), stride=(1, 1))
            )
          )
        )
      )
    )
  )
  (bn): ModuleList(
    (0-1): 2 x BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (start_conv): Conv2d(3, 32, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_1): Conv2d(32, 512, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_2): Conv2d(512, 12, kernel_size=(1, 1), stride=(1, 1))
)
2025-05-08 02:01:37,098 - Number of total parameters: 79692, tunable parameters: 79692
2025-05-08 02:01:37,099 - The number of parameters: 79692
2025-05-08 02:01:37,099 - Start training!
2025-05-08 02:01:48,806 - Epoch: 001, Train Loss: 37.1128, Train RMSE: 52.0551, Train MAPE: 0.7857, Valid Loss: 25.3596, Valid RMSE: 36.1169, Valid MAPE: 0.8073, Train Time: 5.9859s/epoch, Valid Time: 5.7214s, LR: 1.0000e-03
2025-05-08 02:01:48,812 - Val loss decrease from inf to 25.3596
2025-05-08 02:01:59,345 - Epoch: 002, Train Loss: 32.2739, Train RMSE: 46.7521, Train MAPE: 0.6588, Valid Loss: 22.1666, Valid RMSE: 32.7882, Valid MAPE: 0.7324, Train Time: 4.8450s/epoch, Valid Time: 5.6872s, LR: 1.0000e-03
2025-05-08 02:01:59,351 - Val loss decrease from 25.3596 to 22.1666
2025-05-08 02:02:09,969 - Epoch: 003, Train Loss: 31.2375, Train RMSE: 45.5954, Train MAPE: 0.6435, Valid Loss: 21.7756, Valid RMSE: 32.0211, Valid MAPE: 0.7714, Train Time: 4.9252s/epoch, Valid Time: 5.6934s, LR: 1.0000e-03
2025-05-08 02:02:09,975 - Val loss decrease from 22.1666 to 21.7756
2025-05-08 02:02:20,531 - Epoch: 004, Train Loss: 30.6629, Train RMSE: 44.8077, Train MAPE: 0.6302, Valid Loss: 21.6543, Valid RMSE: 31.9142, Valid MAPE: 0.7719, Train Time: 4.8664s/epoch, Valid Time: 5.6895s, LR: 1.0000e-03
2025-05-08 02:02:20,536 - Val loss decrease from 21.7756 to 21.6543
2025-05-08 02:02:31,130 - Epoch: 005, Train Loss: 29.9626, Train RMSE: 43.9905, Train MAPE: 0.6112, Valid Loss: 21.5735, Valid RMSE: 32.1952, Valid MAPE: 0.7322, Train Time: 4.9331s/epoch, Valid Time: 5.6602s, LR: 1.0000e-03
2025-05-08 02:02:31,136 - Val loss decrease from 21.6543 to 21.5735
2025-05-08 02:02:41,711 - Epoch: 006, Train Loss: 29.8291, Train RMSE: 43.8458, Train MAPE: 0.6093, Valid Loss: 22.3361, Valid RMSE: 32.2947, Valid MAPE: 0.8230, Train Time: 4.9461s/epoch, Valid Time: 5.6287s, LR: 1.0000e-03
2025-05-08 02:02:52,209 - Epoch: 007, Train Loss: 29.5608, Train RMSE: 43.6128, Train MAPE: 0.5995, Valid Loss: 22.2678, Valid RMSE: 32.2667, Valid MAPE: 0.8212, Train Time: 4.9697s/epoch, Valid Time: 5.5285s, LR: 1.0000e-03
2025-05-08 02:03:02,754 - Epoch: 008, Train Loss: 29.2862, Train RMSE: 42.9456, Train MAPE: 0.5912, Valid Loss: 21.3524, Valid RMSE: 31.8409, Valid MAPE: 0.7387, Train Time: 4.9492s/epoch, Valid Time: 5.5953s, LR: 1.0000e-03
2025-05-08 02:03:02,760 - Val loss decrease from 21.5735 to 21.3524
2025-05-08 02:03:13,282 - Epoch: 009, Train Loss: 28.8287, Train RMSE: 42.3046, Train MAPE: 0.5738, Valid Loss: 21.4294, Valid RMSE: 31.6425, Valid MAPE: 0.7518, Train Time: 4.9122s/epoch, Valid Time: 5.6096s, LR: 1.0000e-03
2025-05-08 02:03:23,624 - Epoch: 010, Train Loss: 29.0436, Train RMSE: 43.0755, Train MAPE: 0.5661, Valid Loss: 21.7602, Valid RMSE: 31.6165, Valid MAPE: 0.8025, Train Time: 4.9263s/epoch, Valid Time: 5.4160s, LR: 1.0000e-03
2025-05-08 02:03:31,312 - Epoch: 011, Train Loss: 29.0848, Train RMSE: 42.6103, Train MAPE: 0.5890, Valid Loss: 23.1507, Valid RMSE: 32.9659, Valid MAPE: 0.8898, Train Time: 3.8702s/epoch, Valid Time: 3.8174s, LR: 1.0000e-03
2025-05-08 02:03:37,053 - Epoch: 012, Train Loss: 28.5265, Train RMSE: 41.7715, Train MAPE: 0.5707, Valid Loss: 22.2599, Valid RMSE: 32.4304, Valid MAPE: 0.8318, Train Time: 2.6051s/epoch, Valid Time: 3.1352s, LR: 1.0000e-03
2025-05-08 02:03:42,795 - Epoch: 013, Train Loss: 28.5056, Train RMSE: 42.1689, Train MAPE: 0.5595, Valid Loss: 21.2713, Valid RMSE: 31.7605, Valid MAPE: 0.7468, Train Time: 2.5936s/epoch, Valid Time: 3.1485s, LR: 1.0000e-03
2025-05-08 02:03:42,800 - Val loss decrease from 21.3524 to 21.2713
2025-05-08 02:03:48,475 - Epoch: 014, Train Loss: 28.1237, Train RMSE: 41.4646, Train MAPE: 0.5614, Valid Loss: 21.6901, Valid RMSE: 32.1224, Valid MAPE: 0.7833, Train Time: 2.5810s/epoch, Valid Time: 3.0933s, LR: 1.0000e-03
2025-05-08 02:03:54,143 - Epoch: 015, Train Loss: 28.1797, Train RMSE: 41.3270, Train MAPE: 0.5642, Valid Loss: 21.0513, Valid RMSE: 31.5667, Valid MAPE: 0.7278, Train Time: 2.5991s/epoch, Valid Time: 3.0687s, LR: 1.0000e-03
2025-05-08 02:03:54,148 - Val loss decrease from 21.2713 to 21.0513
2025-05-08 02:03:59,787 - Epoch: 016, Train Loss: 27.9804, Train RMSE: 41.2832, Train MAPE: 0.5539, Valid Loss: 20.9292, Valid RMSE: 31.3310, Valid MAPE: 0.7081, Train Time: 2.6044s/epoch, Valid Time: 3.0345s, LR: 1.0000e-03
2025-05-08 02:03:59,793 - Val loss decrease from 21.0513 to 20.9292
2025-05-08 02:04:05,413 - Epoch: 017, Train Loss: 27.6875, Train RMSE: 40.6425, Train MAPE: 0.5534, Valid Loss: 20.6912, Valid RMSE: 31.7882, Valid MAPE: 0.6419, Train Time: 2.5966s/epoch, Valid Time: 3.0236s, LR: 1.0000e-03
2025-05-08 02:04:05,418 - Val loss decrease from 20.9292 to 20.6912
2025-05-08 02:04:11,036 - Epoch: 018, Train Loss: 27.5800, Train RMSE: 40.4552, Train MAPE: 0.5625, Valid Loss: 20.8342, Valid RMSE: 31.7750, Valid MAPE: 0.6848, Train Time: 2.5765s/epoch, Valid Time: 3.0410s, LR: 1.0000e-03
2025-05-08 02:04:16,624 - Epoch: 019, Train Loss: 27.5212, Train RMSE: 40.3222, Train MAPE: 0.5415, Valid Loss: 20.6619, Valid RMSE: 31.5860, Valid MAPE: 0.6886, Train Time: 2.5776s/epoch, Valid Time: 3.0102s, LR: 1.0000e-03
2025-05-08 02:04:16,630 - Val loss decrease from 20.6912 to 20.6619
2025-05-08 02:04:22,243 - Epoch: 020, Train Loss: 27.2958, Train RMSE: 40.1902, Train MAPE: 0.5452, Valid Loss: 20.7133, Valid RMSE: 33.0957, Valid MAPE: 0.5812, Train Time: 2.5853s/epoch, Valid Time: 3.0278s, LR: 1.0000e-03
2025-05-08 02:04:27,106 - Epoch: 021, Train Loss: 27.3084, Train RMSE: 40.3306, Train MAPE: 0.5379, Valid Loss: 20.7606, Valid RMSE: 32.3299, Valid MAPE: 0.6645, Train Time: 2.6383s/epoch, Valid Time: 2.2247s, LR: 1.0000e-03
2025-05-08 02:04:30,870 - Epoch: 022, Train Loss: 27.0017, Train RMSE: 39.6990, Train MAPE: 0.5316, Valid Loss: 21.5017, Valid RMSE: 31.8860, Valid MAPE: 0.7859, Train Time: 1.7138s/epoch, Valid Time: 2.0501s, LR: 1.0000e-03
2025-05-08 02:04:34,653 - Epoch: 023, Train Loss: 26.8140, Train RMSE: 39.6009, Train MAPE: 0.5294, Valid Loss: 20.7782, Valid RMSE: 31.6313, Valid MAPE: 0.7061, Train Time: 1.7115s/epoch, Valid Time: 2.0710s, LR: 1.0000e-03
2025-05-08 02:04:38,364 - Epoch: 024, Train Loss: 26.4972, Train RMSE: 39.2957, Train MAPE: 0.5221, Valid Loss: 20.4721, Valid RMSE: 31.5550, Valid MAPE: 0.6738, Train Time: 1.6853s/epoch, Valid Time: 2.0253s, LR: 1.0000e-03
2025-05-08 02:04:38,369 - Val loss decrease from 20.6619 to 20.4721
2025-05-08 02:04:42,176 - Epoch: 025, Train Loss: 26.5392, Train RMSE: 39.2690, Train MAPE: 0.5232, Valid Loss: 21.2032, Valid RMSE: 31.7821, Valid MAPE: 0.7548, Train Time: 1.7032s/epoch, Valid Time: 2.1038s, LR: 1.0000e-03
2025-05-08 02:04:45,935 - Epoch: 026, Train Loss: 26.5872, Train RMSE: 39.1730, Train MAPE: 0.5296, Valid Loss: 20.9376, Valid RMSE: 32.6376, Valid MAPE: 0.6983, Train Time: 1.7256s/epoch, Valid Time: 2.0335s, LR: 1.0000e-03
2025-05-08 02:04:49,691 - Epoch: 027, Train Loss: 26.5898, Train RMSE: 39.2733, Train MAPE: 0.5278, Valid Loss: 20.4724, Valid RMSE: 32.4030, Valid MAPE: 0.6377, Train Time: 1.7307s/epoch, Valid Time: 2.0249s, LR: 1.0000e-03
2025-05-08 02:04:53,438 - Epoch: 028, Train Loss: 26.2633, Train RMSE: 38.9257, Train MAPE: 0.5157, Valid Loss: 20.5362, Valid RMSE: 32.0418, Valid MAPE: 0.6663, Train Time: 1.7220s/epoch, Valid Time: 2.0249s, LR: 1.0000e-03
2025-05-08 02:04:57,231 - Epoch: 029, Train Loss: 26.1310, Train RMSE: 38.7973, Train MAPE: 0.5068, Valid Loss: 20.4298, Valid RMSE: 32.1050, Valid MAPE: 0.6419, Train Time: 1.7395s/epoch, Valid Time: 2.0528s, LR: 1.0000e-03
2025-05-08 02:04:57,236 - Val loss decrease from 20.4721 to 20.4298
2025-05-08 02:05:01,108 - Epoch: 030, Train Loss: 26.2603, Train RMSE: 38.8164, Train MAPE: 0.5205, Valid Loss: 20.3092, Valid RMSE: 31.7003, Valid MAPE: 0.6515, Train Time: 1.7035s/epoch, Valid Time: 2.1682s, LR: 1.0000e-03
2025-05-08 02:05:01,113 - Val loss decrease from 20.4298 to 20.3092
2025-05-08 02:05:04,848 - Epoch: 031, Train Loss: 26.1522, Train RMSE: 38.6909, Train MAPE: 0.5027, Valid Loss: 20.3491, Valid RMSE: 32.1673, Valid MAPE: 0.6126, Train Time: 1.6701s/epoch, Valid Time: 2.0643s, LR: 1.0000e-03
2025-05-08 02:05:08,699 - Epoch: 032, Train Loss: 26.0838, Train RMSE: 38.4772, Train MAPE: 0.5167, Valid Loss: 20.6472, Valid RMSE: 32.2598, Valid MAPE: 0.6637, Train Time: 1.7206s/epoch, Valid Time: 2.1296s, LR: 1.0000e-03
2025-05-08 02:05:12,495 - Epoch: 033, Train Loss: 25.9919, Train RMSE: 38.5067, Train MAPE: 0.5025, Valid Loss: 20.5861, Valid RMSE: 32.4890, Valid MAPE: 0.6375, Train Time: 1.6734s/epoch, Valid Time: 2.1225s, LR: 1.0000e-03
2025-05-08 02:05:16,341 - Epoch: 034, Train Loss: 25.6223, Train RMSE: 37.9338, Train MAPE: 0.5003, Valid Loss: 20.3489, Valid RMSE: 31.9748, Valid MAPE: 0.6404, Train Time: 1.7317s/epoch, Valid Time: 2.1139s, LR: 1.0000e-03
2025-05-08 02:05:20,107 - Epoch: 035, Train Loss: 25.4697, Train RMSE: 37.8511, Train MAPE: 0.4922, Valid Loss: 20.3723, Valid RMSE: 31.8309, Valid MAPE: 0.6455, Train Time: 1.7191s/epoch, Valid Time: 2.0470s, LR: 1.0000e-03
2025-05-08 02:05:23,869 - Epoch: 036, Train Loss: 25.5033, Train RMSE: 37.8284, Train MAPE: 0.4952, Valid Loss: 20.6266, Valid RMSE: 32.1029, Valid MAPE: 0.6710, Train Time: 1.7102s/epoch, Valid Time: 2.0517s, LR: 1.0000e-03
2025-05-08 02:05:27,618 - Epoch: 037, Train Loss: 25.5870, Train RMSE: 38.0706, Train MAPE: 0.4827, Valid Loss: 22.0634, Valid RMSE: 32.7767, Valid MAPE: 0.8109, Train Time: 1.6813s/epoch, Valid Time: 2.0674s, LR: 1.0000e-03
2025-05-08 02:05:31,367 - Epoch: 038, Train Loss: 25.5349, Train RMSE: 38.0265, Train MAPE: 0.4941, Valid Loss: 20.6260, Valid RMSE: 32.8076, Valid MAPE: 0.6266, Train Time: 1.6818s/epoch, Valid Time: 2.0667s, LR: 1.0000e-03
2025-05-08 02:05:35,130 - Epoch: 039, Train Loss: 25.2509, Train RMSE: 37.4823, Train MAPE: 0.4919, Valid Loss: 21.6553, Valid RMSE: 32.9120, Valid MAPE: 0.7559, Train Time: 1.6784s/epoch, Valid Time: 2.0847s, LR: 1.0000e-03
2025-05-08 02:05:38,862 - Epoch: 040, Train Loss: 25.4151, Train RMSE: 37.7472, Train MAPE: 0.4912, Valid Loss: 21.0394, Valid RMSE: 32.9259, Valid MAPE: 0.6829, Train Time: 1.6996s/epoch, Valid Time: 2.0318s, LR: 1.0000e-03
2025-05-08 02:05:38,862 - Early stop at epoch 40, loss = 20.309208
2025-05-08 02:05:40,501 - --------------------------------------------------Norm Test Time Results:--------------------------------------------------
2025-05-08 02:05:40,506 - Horizon 1, Test MAE: 9.4952, Test RMSE: 14.8681, Test MAPE: 0.3445
2025-05-08 02:05:40,509 - Horizon 2, Test MAE: 12.5514, Test RMSE: 19.2244, Test MAPE: 0.4584
2025-05-08 02:05:40,513 - Horizon 3, Test MAE: 14.0809, Test RMSE: 21.4728, Test MAPE: 0.5118
2025-05-08 02:05:40,517 - Horizon 4, Test MAE: 15.2326, Test RMSE: 22.8441, Test MAPE: 0.5732
2025-05-08 02:05:40,520 - Horizon 5, Test MAE: 15.8897, Test RMSE: 24.0217, Test MAPE: 0.5801
2025-05-08 02:05:40,524 - Horizon 6, Test MAE: 16.7128, Test RMSE: 24.8704, Test MAPE: 0.6387
2025-05-08 02:05:40,527 - Horizon 7, Test MAE: 17.2529, Test RMSE: 25.2615, Test MAPE: 0.6889
2025-05-08 02:05:40,531 - Horizon 8, Test MAE: 17.6262, Test RMSE: 25.6304, Test MAPE: 0.7176
2025-05-08 02:05:40,534 - Horizon 9, Test MAE: 18.3739, Test RMSE: 26.7377, Test MAPE: 0.7370
2025-05-08 02:05:40,537 - Horizon 10, Test MAE: 19.4569, Test RMSE: 27.9349, Test MAPE: 0.7966
2025-05-08 02:05:40,541 - Horizon 11, Test MAE: 20.1665, Test RMSE: 28.5307, Test MAPE: 0.8544
2025-05-08 02:05:40,544 - Horizon 12, Test MAE: 20.6624, Test RMSE: 29.0130, Test MAPE: 0.8840
2025-05-08 02:05:40,545 - Average Test MAE: 16.4585, Test RMSE: 24.2008, Test MAPE: 0.6488
2025-05-08 02:05:40,545 - Norm Test Time: 1.5917s
