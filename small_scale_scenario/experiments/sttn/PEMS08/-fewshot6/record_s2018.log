2025-05-08 17:22:56,853 - Namespace(device='cuda:2', dataset='PEMS08', fewshot=6, eval_method='norm', years='2016', seed=2018, bs=64, seq_len=12, horizon=12, input_dim=3, output_dim=1, mode='train', max_epochs=100, patience=10, model_name='sttn', adj_type='doubletransition', blocks=2, mlp_expand=2, hid_dim=32, end_dim=512, lrate=0.001, wdecay=0.0001, dropout=0.1, clip_grad_value=5)
2025-05-08 17:22:56,853 - Adj path: /home/weichen/stg_project/LargeST/data/pems08/pems08_rn_adj.npy
2025-05-08 17:22:57,472 - Data shape: (17856, 170, 3)
2025-05-08 17:22:57,602 - Sample num: 1070, Batch num: 16
2025-05-08 17:22:57,738 - Sample num: 3567, Batch num: 55
2025-05-08 17:22:57,867 - Sample num: 3566, Batch num: 55
2025-05-08 17:22:58,873 - The arc of model:
STTN(
  (t_modules): ModuleList(
    (0-1): 2 x TemporalTransformer(
      (layers): ModuleList(
        (0): ModuleList(
          (0): TemporalAttention(
            (qkv): Linear(in_features=32, out_features=96, bias=False)
            (attn_drop): Dropout(p=0.1, inplace=False)
            (proj): Linear(in_features=32, out_features=32, bias=True)
            (proj_drop): Dropout(p=0.1, inplace=False)
          )
          (1): PreNorm(
            (norm): LayerNorm((32,), eps=1e-05, elementwise_affine=True)
            (fn): FeedForward(
              (net): Sequential(
                (0): Linear(in_features=32, out_features=64, bias=True)
                (1): GELU(approximate='none')
                (2): Dropout(p=0.1, inplace=False)
                (3): Linear(in_features=64, out_features=32, bias=True)
                (4): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
      )
    )
  )
  (s_modules): ModuleList(
    (0-1): 2 x SpatialTransformer(
      (layers): ModuleList(
        (0): ModuleList(
          (0): SpatialAttention(
            (qkv): Linear(in_features=32, out_features=96, bias=False)
            (attn_drop): Dropout(p=0.1, inplace=False)
            (proj): Linear(in_features=32, out_features=32, bias=True)
            (proj_drop): Dropout(p=0.1, inplace=False)
          )
          (1): PreNorm(
            (norm): LayerNorm((32,), eps=1e-05, elementwise_affine=True)
            (fn): FeedForward(
              (net): Sequential(
                (0): Linear(in_features=32, out_features=64, bias=True)
                (1): GELU(approximate='none')
                (2): Dropout(p=0.1, inplace=False)
                (3): Linear(in_features=64, out_features=32, bias=True)
                (4): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (2): GCN(
            (nconv): nconv()
            (mlp): linear(
              (mlp): Conv2d(160, 32, kernel_size=(1, 1), stride=(1, 1))
            )
          )
        )
      )
    )
  )
  (bn): ModuleList(
    (0-1): 2 x BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (start_conv): Conv2d(3, 32, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_1): Conv2d(32, 512, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_2): Conv2d(512, 12, kernel_size=(1, 1), stride=(1, 1))
)
2025-05-08 17:22:58,874 - Number of total parameters: 78796, tunable parameters: 78796
2025-05-08 17:22:58,874 - The number of parameters: 78796
2025-05-08 17:22:58,874 - Start training!
2025-05-08 17:23:14,455 - Epoch: 001, Train Loss: 57.2360, Train RMSE: 73.2657, Train MAPE: 0.8859, Valid Loss: 37.6058, Valid RMSE: 51.1097, Valid MAPE: 0.4190, Train Time: 8.1467s/epoch, Valid Time: 7.4345s, LR: 1.0000e-03
2025-05-08 17:23:14,479 - Val loss decrease from inf to 37.6058
2025-05-08 17:23:28,432 - Epoch: 002, Train Loss: 32.5380, Train RMSE: 43.8941, Train MAPE: 0.3760, Valid Loss: 29.8324, Valid RMSE: 42.6328, Valid MAPE: 0.3088, Train Time: 6.5003s/epoch, Valid Time: 7.4527s, LR: 1.0000e-03
2025-05-08 17:23:28,437 - Val loss decrease from 37.6058 to 29.8324
2025-05-08 17:23:42,790 - Epoch: 003, Train Loss: 27.4945, Train RMSE: 38.3007, Train MAPE: 0.2927, Valid Loss: 27.5794, Valid RMSE: 40.0893, Valid MAPE: 0.2511, Train Time: 6.7775s/epoch, Valid Time: 7.5747s, LR: 1.0000e-03
2025-05-08 17:23:42,801 - Val loss decrease from 29.8324 to 27.5794
2025-05-08 17:23:56,759 - Epoch: 004, Train Loss: 26.1176, Train RMSE: 36.8426, Train MAPE: 0.2663, Valid Loss: 26.1115, Valid RMSE: 38.8774, Valid MAPE: 0.2711, Train Time: 6.4540s/epoch, Valid Time: 7.5031s, LR: 1.0000e-03
2025-05-08 17:23:56,764 - Val loss decrease from 27.5794 to 26.1115
2025-05-08 17:24:10,686 - Epoch: 005, Train Loss: 24.2946, Train RMSE: 35.0175, Train MAPE: 0.2454, Valid Loss: 25.7869, Valid RMSE: 37.7476, Valid MAPE: 0.2366, Train Time: 6.6780s/epoch, Valid Time: 7.2436s, LR: 1.0000e-03
2025-05-08 17:24:10,715 - Val loss decrease from 26.1115 to 25.7869
2025-05-08 17:24:24,876 - Epoch: 006, Train Loss: 24.3666, Train RMSE: 34.7598, Train MAPE: 0.2574, Valid Loss: 26.0939, Valid RMSE: 37.3822, Valid MAPE: 0.2782, Train Time: 6.6071s/epoch, Valid Time: 7.5538s, LR: 1.0000e-03
2025-05-08 17:24:39,053 - Epoch: 007, Train Loss: 25.4516, Train RMSE: 35.3049, Train MAPE: 0.2889, Valid Loss: 25.4242, Valid RMSE: 37.7695, Valid MAPE: 0.2862, Train Time: 6.6600s/epoch, Valid Time: 7.5164s, LR: 1.0000e-03
2025-05-08 17:24:39,059 - Val loss decrease from 25.7869 to 25.4242
2025-05-08 17:24:53,194 - Epoch: 008, Train Loss: 23.3329, Train RMSE: 33.7510, Train MAPE: 0.2421, Valid Loss: 25.6203, Valid RMSE: 37.5748, Valid MAPE: 0.2343, Train Time: 6.6666s/epoch, Valid Time: 7.4682s, LR: 1.0000e-03
2025-05-08 17:25:07,108 - Epoch: 009, Train Loss: 25.2503, Train RMSE: 35.0653, Train MAPE: 0.2841, Valid Loss: 24.8866, Valid RMSE: 37.0599, Valid MAPE: 0.2399, Train Time: 6.6501s/epoch, Valid Time: 7.2639s, LR: 1.0000e-03
2025-05-08 17:25:07,120 - Val loss decrease from 25.4242 to 24.8866
2025-05-08 17:25:21,382 - Epoch: 010, Train Loss: 25.0718, Train RMSE: 35.0024, Train MAPE: 0.2850, Valid Loss: 24.2237, Valid RMSE: 36.4461, Valid MAPE: 0.2182, Train Time: 6.7184s/epoch, Valid Time: 7.5427s, LR: 1.0000e-03
2025-05-08 17:25:21,394 - Val loss decrease from 24.8866 to 24.2237
2025-05-08 17:25:35,185 - Epoch: 011, Train Loss: 23.7282, Train RMSE: 33.7585, Train MAPE: 0.2561, Valid Loss: 25.7216, Valid RMSE: 37.5689, Valid MAPE: 0.2851, Train Time: 6.6146s/epoch, Valid Time: 7.1764s, LR: 1.0000e-03
2025-05-08 17:25:48,600 - Epoch: 012, Train Loss: 23.4871, Train RMSE: 33.5053, Train MAPE: 0.2554, Valid Loss: 23.6345, Valid RMSE: 35.5904, Valid MAPE: 0.2206, Train Time: 6.8771s/epoch, Valid Time: 6.5373s, LR: 1.0000e-03
2025-05-08 17:25:48,613 - Val loss decrease from 24.2237 to 23.6345
2025-05-08 17:25:59,857 - Epoch: 013, Train Loss: 22.8579, Train RMSE: 32.7289, Train MAPE: 0.2380, Valid Loss: 24.3851, Valid RMSE: 36.4047, Valid MAPE: 0.2099, Train Time: 5.1734s/epoch, Valid Time: 6.0711s, LR: 1.0000e-03
2025-05-08 17:26:11,037 - Epoch: 014, Train Loss: 21.6837, Train RMSE: 31.7158, Train MAPE: 0.2165, Valid Loss: 22.9680, Valid RMSE: 35.1137, Valid MAPE: 0.2037, Train Time: 5.3692s/epoch, Valid Time: 5.8106s, LR: 1.0000e-03
2025-05-08 17:26:11,043 - Val loss decrease from 23.6345 to 22.9680
2025-05-08 17:26:22,376 - Epoch: 015, Train Loss: 22.9628, Train RMSE: 32.8585, Train MAPE: 0.2428, Valid Loss: 24.6286, Valid RMSE: 36.3604, Valid MAPE: 0.2521, Train Time: 5.3238s/epoch, Valid Time: 6.0091s, LR: 1.0000e-03
2025-05-08 17:26:33,601 - Epoch: 016, Train Loss: 22.7092, Train RMSE: 32.4624, Train MAPE: 0.2481, Valid Loss: 26.6362, Valid RMSE: 37.9803, Valid MAPE: 0.2935, Train Time: 5.3763s/epoch, Valid Time: 5.8481s, LR: 1.0000e-03
2025-05-08 17:26:44,891 - Epoch: 017, Train Loss: 21.3993, Train RMSE: 31.2454, Train MAPE: 0.2155, Valid Loss: 23.0300, Valid RMSE: 34.8776, Valid MAPE: 0.2093, Train Time: 5.3010s/epoch, Valid Time: 5.9895s, LR: 1.0000e-03
2025-05-08 17:26:56,095 - Epoch: 018, Train Loss: 21.4153, Train RMSE: 31.1591, Train MAPE: 0.2282, Valid Loss: 27.3627, Valid RMSE: 36.9950, Valid MAPE: 0.4197, Train Time: 5.3658s/epoch, Valid Time: 5.8380s, LR: 1.0000e-03
2025-05-08 17:27:07,517 - Epoch: 019, Train Loss: 22.4431, Train RMSE: 31.7787, Train MAPE: 0.2704, Valid Loss: 24.0623, Valid RMSE: 35.9172, Valid MAPE: 0.2350, Train Time: 5.3321s/epoch, Valid Time: 6.0898s, LR: 1.0000e-03
2025-05-08 17:27:18,696 - Epoch: 020, Train Loss: 21.0216, Train RMSE: 30.8549, Train MAPE: 0.2213, Valid Loss: 24.4338, Valid RMSE: 35.9819, Valid MAPE: 0.2995, Train Time: 5.3658s/epoch, Valid Time: 5.8132s, LR: 1.0000e-03
2025-05-08 17:27:30,108 - Epoch: 021, Train Loss: 21.3830, Train RMSE: 31.2017, Train MAPE: 0.2205, Valid Loss: 26.6755, Valid RMSE: 38.2050, Valid MAPE: 0.2681, Train Time: 5.3506s/epoch, Valid Time: 6.0611s, LR: 1.0000e-03
2025-05-08 17:27:41,199 - Epoch: 022, Train Loss: 21.1087, Train RMSE: 30.8280, Train MAPE: 0.2117, Valid Loss: 23.1512, Valid RMSE: 34.9069, Valid MAPE: 0.2253, Train Time: 5.2268s/epoch, Valid Time: 5.8634s, LR: 1.0000e-03
2025-05-08 17:27:52,501 - Epoch: 023, Train Loss: 20.7399, Train RMSE: 30.3980, Train MAPE: 0.2033, Valid Loss: 23.6979, Valid RMSE: 35.0831, Valid MAPE: 0.2711, Train Time: 5.3713s/epoch, Valid Time: 5.9306s, LR: 1.0000e-03
2025-05-08 17:28:03,526 - Epoch: 024, Train Loss: 20.6152, Train RMSE: 30.3050, Train MAPE: 0.2097, Valid Loss: 22.2868, Valid RMSE: 34.1276, Valid MAPE: 0.1992, Train Time: 5.1922s/epoch, Valid Time: 5.8325s, LR: 1.0000e-03
2025-05-08 17:28:03,531 - Val loss decrease from 22.9680 to 22.2868
2025-05-08 17:28:14,899 - Epoch: 025, Train Loss: 21.0304, Train RMSE: 30.6026, Train MAPE: 0.2189, Valid Loss: 23.8424, Valid RMSE: 34.8802, Valid MAPE: 0.2410, Train Time: 5.3707s/epoch, Valid Time: 5.9970s, LR: 1.0000e-03
2025-05-08 17:28:26,011 - Epoch: 026, Train Loss: 20.8332, Train RMSE: 30.4258, Train MAPE: 0.2182, Valid Loss: 23.6985, Valid RMSE: 35.0417, Valid MAPE: 0.2436, Train Time: 5.1974s/epoch, Valid Time: 5.9140s, LR: 1.0000e-03
2025-05-08 17:28:37,351 - Epoch: 027, Train Loss: 21.8444, Train RMSE: 31.2971, Train MAPE: 0.2597, Valid Loss: 22.5917, Valid RMSE: 33.7146, Valid MAPE: 0.2445, Train Time: 5.3721s/epoch, Valid Time: 5.9676s, LR: 1.0000e-03
2025-05-08 17:28:48,582 - Epoch: 028, Train Loss: 20.0311, Train RMSE: 29.5779, Train MAPE: 0.2012, Valid Loss: 21.8247, Valid RMSE: 33.3241, Valid MAPE: 0.1916, Train Time: 5.2197s/epoch, Valid Time: 6.0113s, LR: 1.0000e-03
2025-05-08 17:28:48,595 - Val loss decrease from 22.2868 to 21.8247
2025-05-08 17:28:59,776 - Epoch: 029, Train Loss: 20.2927, Train RMSE: 29.8462, Train MAPE: 0.2119, Valid Loss: 22.1116, Valid RMSE: 33.8408, Valid MAPE: 0.1762, Train Time: 5.3555s/epoch, Valid Time: 5.8249s, LR: 1.0000e-03
2025-05-08 17:29:11,045 - Epoch: 030, Train Loss: 20.4560, Train RMSE: 29.9013, Train MAPE: 0.2008, Valid Loss: 24.2368, Valid RMSE: 35.1190, Valid MAPE: 0.2757, Train Time: 5.3021s/epoch, Valid Time: 5.9666s, LR: 1.0000e-03
2025-05-08 17:29:22,217 - Epoch: 031, Train Loss: 20.4000, Train RMSE: 29.9252, Train MAPE: 0.2205, Valid Loss: 22.4153, Valid RMSE: 34.0923, Valid MAPE: 0.1851, Train Time: 5.3714s/epoch, Valid Time: 5.8006s, LR: 1.0000e-03
2025-05-08 17:29:33,476 - Epoch: 032, Train Loss: 19.5318, Train RMSE: 29.1931, Train MAPE: 0.1912, Valid Loss: 21.2722, Valid RMSE: 32.7247, Valid MAPE: 0.1742, Train Time: 5.3256s/epoch, Valid Time: 5.9332s, LR: 1.0000e-03
2025-05-08 17:29:33,500 - Val loss decrease from 21.8247 to 21.2722
2025-05-08 17:29:44,732 - Epoch: 033, Train Loss: 19.8983, Train RMSE: 29.7686, Train MAPE: 0.1756, Valid Loss: 23.5890, Valid RMSE: 35.4900, Valid MAPE: 0.1880, Train Time: 5.3468s/epoch, Valid Time: 5.8849s, LR: 1.0000e-03
2025-05-08 17:29:56,048 - Epoch: 034, Train Loss: 19.7412, Train RMSE: 29.4383, Train MAPE: 0.1836, Valid Loss: 23.1514, Valid RMSE: 34.1656, Valid MAPE: 0.2456, Train Time: 5.3386s/epoch, Valid Time: 5.9774s, LR: 1.0000e-03
2025-05-08 17:30:07,127 - Epoch: 035, Train Loss: 19.4699, Train RMSE: 29.1127, Train MAPE: 0.1914, Valid Loss: 23.5088, Valid RMSE: 35.2673, Valid MAPE: 0.1805, Train Time: 5.3332s/epoch, Valid Time: 5.7453s, LR: 1.0000e-03
2025-05-08 17:30:18,368 - Epoch: 036, Train Loss: 19.3679, Train RMSE: 28.9671, Train MAPE: 0.1798, Valid Loss: 21.8638, Valid RMSE: 33.5308, Valid MAPE: 0.1746, Train Time: 5.3064s/epoch, Valid Time: 5.9351s, LR: 1.0000e-03
2025-05-08 17:30:29,416 - Epoch: 037, Train Loss: 19.8448, Train RMSE: 29.3108, Train MAPE: 0.1965, Valid Loss: 21.9824, Valid RMSE: 33.1364, Valid MAPE: 0.1871, Train Time: 5.2413s/epoch, Valid Time: 5.8061s, LR: 1.0000e-03
2025-05-08 17:30:40,678 - Epoch: 038, Train Loss: 20.9251, Train RMSE: 30.4078, Train MAPE: 0.2110, Valid Loss: 21.5980, Valid RMSE: 33.3158, Valid MAPE: 0.1682, Train Time: 5.3428s/epoch, Valid Time: 5.9192s, LR: 1.0000e-03
2025-05-08 17:30:51,813 - Epoch: 039, Train Loss: 20.4743, Train RMSE: 30.0754, Train MAPE: 0.1893, Valid Loss: 23.3378, Valid RMSE: 34.8727, Valid MAPE: 0.2197, Train Time: 5.1927s/epoch, Valid Time: 5.9420s, LR: 1.0000e-03
2025-05-08 17:31:03,092 - Epoch: 040, Train Loss: 19.4495, Train RMSE: 29.0400, Train MAPE: 0.1852, Valid Loss: 24.2100, Valid RMSE: 35.4096, Valid MAPE: 0.2257, Train Time: 5.3615s/epoch, Valid Time: 5.9170s, LR: 1.0000e-03
2025-05-08 17:31:14,195 - Epoch: 041, Train Loss: 20.2735, Train RMSE: 29.7125, Train MAPE: 0.2111, Valid Loss: 26.1575, Valid RMSE: 36.4065, Valid MAPE: 0.3230, Train Time: 5.2227s/epoch, Valid Time: 5.8803s, LR: 1.0000e-03
2025-05-08 17:31:25,467 - Epoch: 042, Train Loss: 20.3003, Train RMSE: 29.6406, Train MAPE: 0.2164, Valid Loss: 24.3497, Valid RMSE: 35.6685, Valid MAPE: 0.2412, Train Time: 5.3588s/epoch, Valid Time: 5.9125s, LR: 1.0000e-03
2025-05-08 17:31:25,467 - Early stop at epoch 42, loss = 21.272228
2025-05-08 17:31:31,546 - --------------------------------------------------Norm Test Time Results:--------------------------------------------------
2025-05-08 17:31:31,550 - Horizon 1, Test MAE: 15.3266, Test RMSE: 22.4180, Test MAPE: 0.1225
2025-05-08 17:31:31,554 - Horizon 2, Test MAE: 16.7711, Test RMSE: 24.7247, Test MAPE: 0.1321
2025-05-08 17:31:31,558 - Horizon 3, Test MAE: 18.1765, Test RMSE: 26.9060, Test MAPE: 0.1385
2025-05-08 17:31:31,562 - Horizon 4, Test MAE: 18.7790, Test RMSE: 28.1563, Test MAPE: 0.1390
2025-05-08 17:31:31,566 - Horizon 5, Test MAE: 19.5398, Test RMSE: 29.5505, Test MAPE: 0.1442
2025-05-08 17:31:31,570 - Horizon 6, Test MAE: 20.1203, Test RMSE: 30.6672, Test MAPE: 0.1472
2025-05-08 17:31:31,575 - Horizon 7, Test MAE: 21.0051, Test RMSE: 32.0947, Test MAPE: 0.1544
2025-05-08 17:31:31,579 - Horizon 8, Test MAE: 21.9892, Test RMSE: 33.4504, Test MAPE: 0.1671
2025-05-08 17:31:31,583 - Horizon 9, Test MAE: 22.7498, Test RMSE: 34.6274, Test MAPE: 0.1680
2025-05-08 17:31:31,587 - Horizon 10, Test MAE: 23.2104, Test RMSE: 35.2838, Test MAPE: 0.1836
2025-05-08 17:31:31,591 - Horizon 11, Test MAE: 24.1084, Test RMSE: 36.4813, Test MAPE: 0.1870
2025-05-08 17:31:31,595 - Horizon 12, Test MAE: 24.8578, Test RMSE: 37.6855, Test MAPE: 0.1884
2025-05-08 17:31:31,596 - Average Test MAE: 20.5528, Test RMSE: 31.0038, Test MAPE: 0.1560
2025-05-08 17:31:31,596 - Norm Test Time: 5.6608s
