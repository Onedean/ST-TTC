2025-05-08 17:53:45,218 - Namespace(device='cuda:0', dataset='PEMS07', fewshot=6, eval_method='norm', use_long=False, years='2017', seed=2018, bs=32, seq_len=12, horizon=12, input_dim=3, output_dim=1, mode='train', max_epochs=100, patience=10, model_name='sttn', adj_type='doubletransition', blocks=2, mlp_expand=2, hid_dim=32, end_dim=512, lrate=0.001, wdecay=0.0001, dropout=0.1, clip_grad_value=5)
2025-05-08 17:53:45,219 - Adj path: /home/weichen/stg_project/LargeST/data/pems07/pems07_rn_adj.npy
2025-05-08 17:53:46,546 - Data shape: (28224, 883, 3)
2025-05-08 17:53:47,670 - Sample num: 1692, Batch num: 52
2025-05-08 17:53:48,800 - Sample num: 5640, Batch num: 176
2025-05-08 17:53:49,973 - Sample num: 5640, Batch num: 176
2025-05-08 17:53:50,888 - The arc of model:
STTN(
  (t_modules): ModuleList(
    (0-1): 2 x TemporalTransformer(
      (layers): ModuleList(
        (0): ModuleList(
          (0): TemporalAttention(
            (qkv): Linear(in_features=32, out_features=96, bias=False)
            (attn_drop): Dropout(p=0.1, inplace=False)
            (proj): Linear(in_features=32, out_features=32, bias=True)
            (proj_drop): Dropout(p=0.1, inplace=False)
          )
          (1): PreNorm(
            (norm): LayerNorm((32,), eps=1e-05, elementwise_affine=True)
            (fn): FeedForward(
              (net): Sequential(
                (0): Linear(in_features=32, out_features=64, bias=True)
                (1): GELU(approximate='none')
                (2): Dropout(p=0.1, inplace=False)
                (3): Linear(in_features=64, out_features=32, bias=True)
                (4): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
      )
    )
  )
  (s_modules): ModuleList(
    (0-1): 2 x SpatialTransformer(
      (layers): ModuleList(
        (0): ModuleList(
          (0): SpatialAttention(
            (qkv): Linear(in_features=32, out_features=96, bias=False)
            (attn_drop): Dropout(p=0.1, inplace=False)
            (proj): Linear(in_features=32, out_features=32, bias=True)
            (proj_drop): Dropout(p=0.1, inplace=False)
          )
          (1): PreNorm(
            (norm): LayerNorm((32,), eps=1e-05, elementwise_affine=True)
            (fn): FeedForward(
              (net): Sequential(
                (0): Linear(in_features=32, out_features=64, bias=True)
                (1): GELU(approximate='none')
                (2): Dropout(p=0.1, inplace=False)
                (3): Linear(in_features=64, out_features=32, bias=True)
                (4): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (2): GCN(
            (nconv): nconv()
            (mlp): linear(
              (mlp): Conv2d(160, 32, kernel_size=(1, 1), stride=(1, 1))
            )
          )
        )
      )
    )
  )
  (bn): ModuleList(
    (0-1): 2 x BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (start_conv): Conv2d(3, 32, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_1): Conv2d(32, 512, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_2): Conv2d(512, 12, kernel_size=(1, 1), stride=(1, 1))
)
2025-05-08 17:53:50,889 - Number of total parameters: 124428, tunable parameters: 124428
2025-05-08 17:53:50,889 - The number of parameters: 124428
2025-05-08 17:53:50,889 - Start training!
2025-05-08 17:55:05,916 - Epoch: 001, Train Loss: 63.4919, Train RMSE: 82.9668, Train MAPE: 0.5633, Valid Loss: 42.7943, Valid RMSE: 59.3363, Valid MAPE: 0.3094, Train Time: 34.0702s/epoch, Valid Time: 40.9566s, LR: 1.0000e-03
2025-05-08 17:55:05,922 - Val loss decrease from inf to 42.7943
2025-05-08 17:56:08,013 - Epoch: 002, Train Loss: 44.9202, Train RMSE: 61.8989, Train MAPE: 0.3266, Valid Loss: 37.5090, Valid RMSE: 53.8612, Valid MAPE: 0.2364, Train Time: 28.5056s/epoch, Valid Time: 33.5845s, LR: 1.0000e-03
2025-05-08 17:56:08,019 - Val loss decrease from 42.7943 to 37.5090
2025-05-08 17:57:10,756 - Epoch: 003, Train Loss: 41.9690, Train RMSE: 58.4744, Train MAPE: 0.2988, Valid Loss: 35.9302, Valid RMSE: 50.3496, Valid MAPE: 0.2904, Train Time: 28.1259s/epoch, Valid Time: 34.6114s, LR: 1.0000e-03
2025-05-08 17:57:10,762 - Val loss decrease from 37.5090 to 35.9302
2025-05-08 17:58:24,691 - Epoch: 004, Train Loss: 38.2445, Train RMSE: 54.1845, Train MAPE: 0.2683, Valid Loss: 32.6341, Valid RMSE: 48.0271, Valid MAPE: 0.2192, Train Time: 33.1026s/epoch, Valid Time: 40.8260s, LR: 1.0000e-03
2025-05-08 17:58:24,696 - Val loss decrease from 35.9302 to 32.6341
2025-05-08 17:59:38,988 - Epoch: 005, Train Loss: 37.1393, Train RMSE: 52.7283, Train MAPE: 0.2677, Valid Loss: 34.5652, Valid RMSE: 48.8732, Valid MAPE: 0.2875, Train Time: 33.2162s/epoch, Valid Time: 41.0759s, LR: 1.0000e-03
2025-05-08 18:00:52,941 - Epoch: 006, Train Loss: 35.6969, Train RMSE: 51.2658, Train MAPE: 0.2338, Valid Loss: 32.3445, Valid RMSE: 47.2848, Valid MAPE: 0.2291, Train Time: 33.1136s/epoch, Valid Time: 40.8389s, LR: 1.0000e-03
2025-05-08 18:00:52,947 - Val loss decrease from 32.6341 to 32.3445
2025-05-08 18:02:07,272 - Epoch: 007, Train Loss: 33.8288, Train RMSE: 49.3064, Train MAPE: 0.2130, Valid Loss: 30.1381, Valid RMSE: 44.6870, Valid MAPE: 0.1988, Train Time: 33.2077s/epoch, Valid Time: 41.1170s, LR: 1.0000e-03
2025-05-08 18:02:07,277 - Val loss decrease from 32.3445 to 30.1381
2025-05-08 18:03:08,937 - Epoch: 008, Train Loss: 33.3840, Train RMSE: 48.5737, Train MAPE: 0.2134, Valid Loss: 29.9858, Valid RMSE: 44.0250, Valid MAPE: 0.1903, Train Time: 27.8222s/epoch, Valid Time: 33.8377s, LR: 1.0000e-03
2025-05-08 18:03:08,944 - Val loss decrease from 30.1381 to 29.9858
2025-05-08 18:04:12,684 - Epoch: 009, Train Loss: 33.1170, Train RMSE: 48.2320, Train MAPE: 0.1986, Valid Loss: 28.8918, Valid RMSE: 43.2183, Valid MAPE: 0.1642, Train Time: 28.1506s/epoch, Valid Time: 35.5892s, LR: 1.0000e-03
2025-05-08 18:04:12,689 - Val loss decrease from 29.9858 to 28.8918
2025-05-08 18:05:27,084 - Epoch: 010, Train Loss: 32.5320, Train RMSE: 47.5219, Train MAPE: 0.1947, Valid Loss: 29.8588, Valid RMSE: 43.1792, Valid MAPE: 0.1973, Train Time: 33.2689s/epoch, Valid Time: 41.1263s, LR: 1.0000e-03
2025-05-08 18:06:41,562 - Epoch: 011, Train Loss: 31.3701, Train RMSE: 46.3754, Train MAPE: 0.1760, Valid Loss: 28.3293, Valid RMSE: 42.1050, Valid MAPE: 0.1540, Train Time: 33.1340s/epoch, Valid Time: 41.3436s, LR: 1.0000e-03
2025-05-08 18:06:41,568 - Val loss decrease from 28.8918 to 28.3293
2025-05-08 18:07:56,093 - Epoch: 012, Train Loss: 30.5209, Train RMSE: 45.4416, Train MAPE: 0.1664, Valid Loss: 27.6366, Valid RMSE: 41.4670, Valid MAPE: 0.1544, Train Time: 33.3303s/epoch, Valid Time: 41.1951s, LR: 1.0000e-03
2025-05-08 18:07:56,098 - Val loss decrease from 28.3293 to 27.6366
2025-05-08 18:09:08,380 - Epoch: 013, Train Loss: 30.0180, Train RMSE: 44.7710, Train MAPE: 0.1657, Valid Loss: 27.3940, Valid RMSE: 41.0663, Valid MAPE: 0.1446, Train Time: 33.3319s/epoch, Valid Time: 38.9497s, LR: 1.0000e-03
2025-05-08 18:09:08,386 - Val loss decrease from 27.6366 to 27.3940
2025-05-08 18:10:10,193 - Epoch: 014, Train Loss: 29.7830, Train RMSE: 44.3993, Train MAPE: 0.1647, Valid Loss: 32.2049, Valid RMSE: 44.5628, Valid MAPE: 0.2459, Train Time: 27.6553s/epoch, Valid Time: 34.1517s, LR: 1.0000e-03
2025-05-08 18:11:16,441 - Epoch: 015, Train Loss: 29.8840, Train RMSE: 44.2959, Train MAPE: 0.1705, Valid Loss: 27.3944, Valid RMSE: 40.9255, Valid MAPE: 0.1582, Train Time: 28.2027s/epoch, Valid Time: 38.0451s, LR: 1.0000e-03
2025-05-08 18:12:31,185 - Epoch: 016, Train Loss: 29.4053, Train RMSE: 43.8989, Train MAPE: 0.1593, Valid Loss: 27.5583, Valid RMSE: 41.2963, Valid MAPE: 0.1426, Train Time: 33.2556s/epoch, Valid Time: 41.4881s, LR: 1.0000e-03
2025-05-08 18:13:45,463 - Epoch: 017, Train Loss: 28.8625, Train RMSE: 43.3769, Train MAPE: 0.1509, Valid Loss: 27.4461, Valid RMSE: 40.4643, Valid MAPE: 0.1504, Train Time: 33.0972s/epoch, Valid Time: 41.1807s, LR: 1.0000e-03
2025-05-08 18:14:59,860 - Epoch: 018, Train Loss: 29.1112, Train RMSE: 43.3744, Train MAPE: 0.1595, Valid Loss: 27.9674, Valid RMSE: 40.7459, Valid MAPE: 0.1594, Train Time: 33.2547s/epoch, Valid Time: 41.1425s, LR: 1.0000e-03
2025-05-08 18:16:09,321 - Epoch: 019, Train Loss: 29.0241, Train RMSE: 43.3364, Train MAPE: 0.1537, Valid Loss: 26.9348, Valid RMSE: 40.3989, Valid MAPE: 0.1401, Train Time: 33.1032s/epoch, Valid Time: 36.3572s, LR: 1.0000e-03
2025-05-08 18:16:09,326 - Val loss decrease from 27.3940 to 26.9348
2025-05-08 18:17:11,728 - Epoch: 020, Train Loss: 28.3357, Train RMSE: 42.5705, Train MAPE: 0.1509, Valid Loss: 26.2192, Valid RMSE: 39.5959, Valid MAPE: 0.1312, Train Time: 27.3953s/epoch, Valid Time: 35.0058s, LR: 1.0000e-03
2025-05-08 18:17:11,733 - Val loss decrease from 26.9348 to 26.2192
2025-05-08 18:18:12,539 - Epoch: 021, Train Loss: 28.1943, Train RMSE: 42.2504, Train MAPE: 0.1540, Valid Loss: 27.1519, Valid RMSE: 40.2203, Valid MAPE: 0.1628, Train Time: 26.6063s/epoch, Valid Time: 34.1996s, LR: 1.0000e-03
2025-05-08 18:19:06,892 - Epoch: 022, Train Loss: 27.8260, Train RMSE: 41.9586, Train MAPE: 0.1474, Valid Loss: 26.6987, Valid RMSE: 39.8641, Valid MAPE: 0.1436, Train Time: 27.0499s/epoch, Valid Time: 27.3021s, LR: 1.0000e-03
2025-05-08 18:20:20,120 - Epoch: 023, Train Loss: 27.9685, Train RMSE: 42.0363, Train MAPE: 0.1480, Valid Loss: 26.0086, Valid RMSE: 39.2281, Valid MAPE: 0.1322, Train Time: 32.0232s/epoch, Valid Time: 41.2052s, LR: 1.0000e-03
2025-05-08 18:20:20,126 - Val loss decrease from 26.2192 to 26.0086
2025-05-08 18:21:34,525 - Epoch: 024, Train Loss: 27.6201, Train RMSE: 41.6642, Train MAPE: 0.1443, Valid Loss: 26.6632, Valid RMSE: 39.8811, Valid MAPE: 0.1472, Train Time: 33.5798s/epoch, Valid Time: 40.8197s, LR: 1.0000e-03
2025-05-08 18:22:49,103 - Epoch: 025, Train Loss: 27.3937, Train RMSE: 41.3756, Train MAPE: 0.1408, Valid Loss: 26.3476, Valid RMSE: 39.6553, Valid MAPE: 0.1316, Train Time: 33.5758s/epoch, Valid Time: 41.0014s, LR: 1.0000e-03
2025-05-08 18:24:03,723 - Epoch: 026, Train Loss: 27.2020, Train RMSE: 41.2099, Train MAPE: 0.1376, Valid Loss: 26.2263, Valid RMSE: 39.2886, Valid MAPE: 0.1340, Train Time: 33.5862s/epoch, Valid Time: 41.0336s, LR: 1.0000e-03
2025-05-08 18:25:08,133 - Epoch: 027, Train Loss: 26.8092, Train RMSE: 40.7428, Train MAPE: 0.1356, Valid Loss: 25.7662, Valid RMSE: 38.9864, Valid MAPE: 0.1260, Train Time: 30.4049s/epoch, Valid Time: 34.0053s, LR: 1.0000e-03
2025-05-08 18:25:08,139 - Val loss decrease from 26.0086 to 25.7662
2025-05-08 18:26:11,156 - Epoch: 028, Train Loss: 27.0280, Train RMSE: 40.9263, Train MAPE: 0.1398, Valid Loss: 25.4797, Valid RMSE: 38.7097, Valid MAPE: 0.1213, Train Time: 28.3196s/epoch, Valid Time: 34.6977s, LR: 1.0000e-03
2025-05-08 18:26:11,162 - Val loss decrease from 25.7662 to 25.4797
2025-05-08 18:27:25,765 - Epoch: 029, Train Loss: 27.0745, Train RMSE: 40.7439, Train MAPE: 0.1470, Valid Loss: 26.1840, Valid RMSE: 39.1197, Valid MAPE: 0.1439, Train Time: 33.4911s/epoch, Valid Time: 41.1121s, LR: 1.0000e-03
2025-05-08 18:28:40,393 - Epoch: 030, Train Loss: 26.8381, Train RMSE: 40.6463, Train MAPE: 0.1391, Valid Loss: 26.6443, Valid RMSE: 39.5054, Valid MAPE: 0.1446, Train Time: 33.4750s/epoch, Valid Time: 41.1529s, LR: 1.0000e-03
2025-05-08 18:29:55,208 - Epoch: 031, Train Loss: 26.9681, Train RMSE: 40.6315, Train MAPE: 0.1451, Valid Loss: 26.0097, Valid RMSE: 38.9888, Valid MAPE: 0.1386, Train Time: 33.5715s/epoch, Valid Time: 41.2437s, LR: 1.0000e-03
2025-05-08 18:31:08,796 - Epoch: 032, Train Loss: 26.3347, Train RMSE: 40.0215, Train MAPE: 0.1332, Valid Loss: 25.6099, Valid RMSE: 38.6786, Valid MAPE: 0.1279, Train Time: 33.3710s/epoch, Valid Time: 40.2165s, LR: 1.0000e-03
2025-05-08 18:32:09,381 - Epoch: 033, Train Loss: 26.1809, Train RMSE: 39.8256, Train MAPE: 0.1337, Valid Loss: 26.1466, Valid RMSE: 38.9857, Valid MAPE: 0.1632, Train Time: 27.5657s/epoch, Valid Time: 33.0190s, LR: 1.0000e-03
2025-05-08 18:33:13,350 - Epoch: 034, Train Loss: 25.9776, Train RMSE: 39.5187, Train MAPE: 0.1343, Valid Loss: 25.6042, Valid RMSE: 38.6179, Valid MAPE: 0.1339, Train Time: 28.1406s/epoch, Valid Time: 35.8280s, LR: 1.0000e-03
2025-05-08 18:34:27,849 - Epoch: 035, Train Loss: 26.4197, Train RMSE: 39.7495, Train MAPE: 0.1451, Valid Loss: 26.2631, Valid RMSE: 39.0661, Valid MAPE: 0.1428, Train Time: 33.4117s/epoch, Valid Time: 41.0871s, LR: 1.0000e-03
2025-05-08 18:35:42,409 - Epoch: 036, Train Loss: 25.9243, Train RMSE: 39.5134, Train MAPE: 0.1313, Valid Loss: 25.8759, Valid RMSE: 38.9397, Valid MAPE: 0.1324, Train Time: 33.5188s/epoch, Valid Time: 41.0409s, LR: 1.0000e-03
2025-05-08 18:36:57,001 - Epoch: 037, Train Loss: 25.6389, Train RMSE: 39.1784, Train MAPE: 0.1293, Valid Loss: 26.0359, Valid RMSE: 39.0585, Valid MAPE: 0.1344, Train Time: 33.3286s/epoch, Valid Time: 41.2631s, LR: 1.0000e-03
2025-05-08 18:38:08,081 - Epoch: 038, Train Loss: 25.4699, Train RMSE: 38.9403, Train MAPE: 0.1282, Valid Loss: 26.1492, Valid RMSE: 39.5152, Valid MAPE: 0.1265, Train Time: 33.3885s/epoch, Valid Time: 37.6913s, LR: 1.0000e-03
2025-05-08 18:38:08,081 - Early stop at epoch 38, loss = 25.479675
2025-05-08 18:38:38,703 - --------------------------------------------------Norm Test Time Results:--------------------------------------------------
2025-05-08 18:38:38,825 - Horizon 1, Test MAE: 19.9852, Test RMSE: 30.0955, Test MAPE: 0.0933
2025-05-08 18:38:38,939 - Horizon 2, Test MAE: 22.1394, Test RMSE: 33.4644, Test MAPE: 0.1009
2025-05-08 18:38:39,045 - Horizon 3, Test MAE: 23.6237, Test RMSE: 35.6134, Test MAPE: 0.1068
2025-05-08 18:38:39,158 - Horizon 4, Test MAE: 24.8620, Test RMSE: 37.3928, Test MAPE: 0.1116
2025-05-08 18:38:39,270 - Horizon 5, Test MAE: 25.7771, Test RMSE: 38.6919, Test MAPE: 0.1149
2025-05-08 18:38:39,376 - Horizon 6, Test MAE: 26.8864, Test RMSE: 40.1922, Test MAPE: 0.1193
2025-05-08 18:38:39,483 - Horizon 7, Test MAE: 27.8700, Test RMSE: 41.5241, Test MAPE: 0.1236
2025-05-08 18:38:39,596 - Horizon 8, Test MAE: 28.8321, Test RMSE: 42.7944, Test MAPE: 0.1279
2025-05-08 18:38:39,702 - Horizon 9, Test MAE: 29.8682, Test RMSE: 44.1818, Test MAPE: 0.1319
2025-05-08 18:38:39,810 - Horizon 10, Test MAE: 30.7110, Test RMSE: 45.3465, Test MAPE: 0.1348
2025-05-08 18:38:39,914 - Horizon 11, Test MAE: 31.6220, Test RMSE: 46.5737, Test MAPE: 0.1397
2025-05-08 18:38:40,024 - Horizon 12, Test MAE: 32.8627, Test RMSE: 48.1239, Test MAPE: 0.1455
2025-05-08 18:38:40,024 - Average Test MAE: 27.0866, Test RMSE: 40.3329, Test MAPE: 0.1208
2025-05-08 18:38:40,024 - Norm Test Time: 30.4272s
